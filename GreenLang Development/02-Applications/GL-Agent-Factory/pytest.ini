# GreenLang Agent Factory - Pytest Configuration
# Documentation: https://docs.pytest.org/en/stable/reference/customize.html

[pytest]
# =============================================================================
# Test Discovery
# =============================================================================
testpaths = tests
# Note: pythonpath removed to avoid namespace collision with backend/queue
python_files = test_*.py *_test.py
python_classes = Test* *Tests
python_functions = test_*

# =============================================================================
# Markers
# =============================================================================
markers =
    slow: marks tests as slow (deselect with '-m "not slow"')
    integration: marks tests as integration tests
    e2e: marks tests as end-to-end tests
    golden: marks tests as golden tests (determinism verification)
    unit: marks tests as unit tests
    smoke: marks tests as smoke tests
    security: marks tests as security tests
    performance: marks tests as performance tests
    compliance: marks tests for regulatory compliance validation
    certification: marks tests for agent certification
    # Agent-specific markers
    gl001: GL-001 Carbon Emissions Calculator tests
    gl002: GL-002 CBAM Compliance tests
    gl010: GL-010 SBTi Validation tests
    gl020: GL-020 Economizer Performance (ECONOPULSE) tests
    gl021: GL-021 Burner Maintenance Predictor (BURNERSENTRY) tests
    # Calculation-specific markers
    burner_maintenance: Burner maintenance predictor tests
    weibull: Weibull reliability analysis tests
    flame_quality: Flame quality assessment tests
    health_score: Health scoring tests
    maintenance: Maintenance scheduling tests
    combustion: Combustion chemistry tests
    acid_dew_point: Acid dew point (Verhoff-Banchero) tests
    ntu_epsilon: NTU-epsilon heat exchanger effectiveness tests
    emissions: Emission calculation tests
    cbam: CBAM embedded emissions tests
    sbti: SBTi target validation tests
    dimension1: certification dimension 1 - specification completeness
    dimension2: certification dimension 2 - code implementation
    dimension3: certification dimension 3 - test coverage
    dimension4: certification dimension 4 - deterministic AI guarantees
    dimension5: certification dimension 5 - documentation completeness
    dimension6: certification dimension 6 - compliance and security
    dimension7: certification dimension 7 - deployment readiness
    dimension8: certification dimension 8 - exit bar criteria
    dimension9: certification dimension 9 - integration and coordination
    dimension10: certification dimension 10 - business impact and metrics
    dimension11: certification dimension 11 - operational excellence
    dimension12: certification dimension 12 - continuous improvement

# =============================================================================
# Output
# =============================================================================
# Verbose output with short traceback
addopts =
    -v
    --tb=short
    --strict-markers
    --strict-config
    -ra
    --color=yes
    --code-highlight=yes

# =============================================================================
# Logging
# =============================================================================
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

log_file = logs/pytest.log
log_file_level = DEBUG
log_file_format = %(asctime)s [%(levelname)8s] %(name)s (%(filename)s:%(lineno)d): %(message)s
log_file_date_format = %Y-%m-%d %H:%M:%S

# =============================================================================
# Warnings
# =============================================================================
filterwarnings =
    error
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::pytest.PytestUnraisableExceptionWarning

# =============================================================================
# Test Collection
# =============================================================================
norecursedirs =
    .git
    .tox
    .venv
    venv
    env
    dist
    build
    __pycache__
    *.egg-info
    .eggs
    node_modules
    migrations
    .terraform

# =============================================================================
# Coverage Integration
# =============================================================================
# Note: Coverage settings are in .coveragerc for more flexibility

# =============================================================================
# Async Support
# =============================================================================
asyncio_mode = auto

# =============================================================================
# Timeout
# =============================================================================
timeout = 300
timeout_method = thread

# =============================================================================
# Fixtures
# =============================================================================
usefixtures =

# =============================================================================
# Minimum Version
# =============================================================================
minversion = 7.0

# =============================================================================
# Required Plugins
# =============================================================================
# Note: Commenting out required_plugins to avoid plugin loading issues
# required_plugins =
#     pytest-cov>=4.0.0
#     pytest-asyncio>=0.21.0
#     pytest-xdist>=3.0.0
#     pytest-timeout>=2.0.0
