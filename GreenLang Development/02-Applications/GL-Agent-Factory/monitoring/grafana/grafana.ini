# GreenLang Grafana Configuration
# Production-grade settings for observability

#################################### General ####################################
[default]
app_mode = production

#################################### Paths ####################################
[paths]
data = /var/lib/grafana
logs = /var/log/grafana
plugins = /var/lib/grafana/plugins
provisioning = /etc/grafana/provisioning

#################################### Server ####################################
[server]
protocol = http
http_addr = 0.0.0.0
http_port = 3000
domain = grafana.greenlang.io
root_url = %(protocol)s://%(domain)s:%(http_port)s/
serve_from_sub_path = false
router_logging = false
static_root_path = public
enable_gzip = true

#################################### Database ####################################
[database]
type = sqlite3
path = grafana.db
cache_mode = shared

#################################### Security ####################################
[security]
admin_user = admin
admin_password = ${GF_SECURITY_ADMIN_PASSWORD}
secret_key = ${GF_SECURITY_SECRET_KEY}
disable_gravatar = true
cookie_secure = true
cookie_samesite = strict
allow_embedding = false
strict_transport_security = true
strict_transport_security_max_age_seconds = 86400
strict_transport_security_preload = true
strict_transport_security_subdomains = true
x_content_type_options = true
x_xss_protection = true
content_security_policy = true
content_security_policy_template = """script-src 'self' 'unsafe-eval' 'unsafe-inline' 'strict-dynamic' $NONCE;object-src 'none';font-src 'self';style-src 'self' 'unsafe-inline' blob:;img-src * data:;base-uri 'self';connect-src 'self' grafana.com ws://$ROOT_PATH wss://$ROOT_PATH;manifest-src 'self';media-src 'none';form-action 'self';"""

#################################### Users ####################################
[users]
allow_sign_up = false
allow_org_create = false
auto_assign_org = true
auto_assign_org_role = Viewer
default_theme = dark

#################################### Anonymous Auth ####################################
[auth.anonymous]
enabled = false

#################################### Auth Proxy ####################################
[auth.proxy]
enabled = false

#################################### Basic Auth ####################################
[auth.basic]
enabled = true

#################################### Logging ####################################
[log]
mode = console file
level = info
filters =

[log.console]
level = info
format = console

[log.file]
level = info
format = text
log_rotate = true
max_lines = 1000000
max_size_shift = 28
daily_rotate = true
max_days = 7

#################################### Alerting ####################################
[alerting]
enabled = true
execute_alerts = true
error_or_timeout = alerting
nodata_or_nullvalues = no_data
evaluation_timeout_seconds = 30
notification_timeout_seconds = 30
max_attempts = 3

#################################### Unified Alerting ####################################
[unified_alerting]
enabled = true
execute_alerts = true
evaluation_timeout = 30s
max_attempts = 3
min_interval = 10s

#################################### SMTP / Emailing ####################################
[smtp]
enabled = true
host = ${GF_SMTP_HOST}
user = ${GF_SMTP_USER}
password = ${GF_SMTP_PASSWORD}
from_address = grafana@greenlang.io
from_name = GreenLang Grafana
startTLS_policy = MandatoryStartTLS

#################################### Metrics ####################################
[metrics]
enabled = true
interval_seconds = 10
disable_total_stats = false

[metrics.graphite]
address =
prefix = prod.grafana.%(instance_name)s.

#################################### Analytics ####################################
[analytics]
reporting_enabled = false
check_for_updates = false

#################################### Dashboards ####################################
[dashboards]
versions_to_keep = 20
min_refresh_interval = 5s
default_home_dashboard_path = /var/lib/grafana/dashboards/greenlang/agent-overview.json

#################################### Feature Toggles ####################################
[feature_toggles]
enable = publicDashboards correlations traceToMetrics newTraceViewHeader traceqlSearch metricsSummary lokiQuerySplitting

#################################### Date Formats ####################################
[date_formats]
full_date = YYYY-MM-DD HH:mm:ss
interval_second = HH:mm:ss
interval_minute = HH:mm
interval_hour = MM/DD HH:mm
interval_day = MM/DD
interval_month = YYYY-MM
interval_year = YYYY

#################################### Annotations ####################################
[annotations]
cleanupjob_batchsize = 100
dashboard = {"cleanup_frequency": "10m", "max_age": "0", "max_annotations_to_keep": "0"}
api = {"cleanup_frequency": "10m", "max_age": "0", "max_annotations_to_keep": "0"}

#################################### Explore ####################################
[explore]
enabled = true

#################################### Plugins ####################################
[plugins]
enable_alpha = false
plugin_admin_enabled = true
plugin_admin_external_manage_enabled = false

#################################### Live ####################################
[live]
max_connections = 100
allowed_origins = *
