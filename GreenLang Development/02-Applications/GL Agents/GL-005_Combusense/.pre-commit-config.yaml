# GL-005 CombustionControlAgent - Pre-commit Configuration
# Automated code quality checks before every commit
# Installation: pip install pre-commit && pre-commit install

repos:
  # ========================================================================
  # CODE FORMATTING
  # ========================================================================
  - repo: https://github.com/psf/black
    rev: 24.1.1
    hooks:
      - id: black
        name: Black Code Formatter
        language_version: python3.11
        args: ['--line-length=120']

  - repo: https://github.com/PyCQA/isort
    rev: 5.13.2
    hooks:
      - id: isort
        name: isort Import Sorter
        args: ['--profile', 'black', '--line-length=120']

  # ========================================================================
  # LINTING & CODE QUALITY
  # ========================================================================
  - repo: https://github.com/PyCQA/flake8
    rev: 7.0.0
    hooks:
      - id: flake8
        name: Flake8 Linter
        args: ['--max-line-length=120', '--extend-ignore=E203,W503']
        additional_dependencies:
          - flake8-docstrings
          - flake8-bugbear
          - flake8-comprehensions
          - flake8-simplify

  - repo: https://github.com/charliermarsh/ruff-pre-commit
    rev: v0.2.1
    hooks:
      - id: ruff
        name: Ruff Fast Linter
        args: ['--fix', '--exit-non-zero-on-fix']

  - repo: https://github.com/PyCQA/pylint
    rev: v3.0.3
    hooks:
      - id: pylint
        name: Pylint Static Analyzer
        args: ['--max-line-length=120', '--disable=C0111,R0903']

  # ========================================================================
  # TYPE CHECKING
  # ========================================================================
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.8.0
    hooks:
      - id: mypy
        name: MyPy Type Checker
        args:
          - '--ignore-missing-imports'
          - '--no-implicit-optional'
          - '--warn-unused-ignores'
          - '--warn-redundant-casts'
          - '--strict-equality'
        additional_dependencies:
          - types-all
          - types-PyYAML
          - types-requests
          - types-redis

  # ========================================================================
  # SECURITY SCANNING
  # ========================================================================
  - repo: https://github.com/PyCQA/bandit
    rev: 1.7.6
    hooks:
      - id: bandit
        name: Bandit Security Scanner
        args: ['-ll', '-i', '-r', '.']
        exclude: tests/

  - repo: https://github.com/Lucas-C/pre-commit-hooks-safety
    rev: v1.3.3
    hooks:
      - id: python-safety-dependencies-check
        name: Safety Dependency Vulnerability Check
        files: requirements.*\.txt$

  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.4.0
    hooks:
      - id: detect-secrets
        name: Detect Secrets Scanner
        args: ['--baseline', '.secrets.baseline']
        exclude: package.lock.json

  # ========================================================================
  # GENERAL FILE CHECKS
  # ========================================================================
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
        name: Trim Trailing Whitespace
      - id: end-of-file-fixer
        name: Fix End of Files
      - id: check-yaml
        name: Check YAML Syntax
        args: ['--unsafe']
      - id: check-json
        name: Check JSON Syntax
      - id: check-toml
        name: Check TOML Syntax
      - id: check-added-large-files
        name: Check for Large Files
        args: ['--maxkb=1000']
      - id: check-merge-conflict
        name: Check for Merge Conflicts
      - id: check-case-conflict
        name: Check for Case Conflicts
      - id: check-docstring-first
        name: Check Docstring First
      - id: debug-statements
        name: Check for Debug Statements
      - id: mixed-line-ending
        name: Check Mixed Line Endings
        args: ['--fix=lf']
      - id: check-executables-have-shebangs
        name: Check Executables Have Shebangs
      - id: check-shebang-scripts-are-executable
        name: Check Shebang Scripts Are Executable
      - id: fix-byte-order-marker
        name: Fix Byte Order Marker
      - id: check-ast
        name: Check Python AST

  # ========================================================================
  # YAML LINTING
  # ========================================================================
  - repo: https://github.com/adrienverge/yamllint
    rev: v1.33.0
    hooks:
      - id: yamllint
        name: YAML Linter
        args: ['-d', '{extends: default, rules: {line-length: {max: 120}, document-start: disable}}']

  # ========================================================================
  # DOCKERFILE LINTING
  # ========================================================================
  - repo: https://github.com/hadolint/hadolint
    rev: v2.12.0
    hooks:
      - id: hadolint-docker
        name: Hadolint Dockerfile Linter
        args: ['--ignore', 'DL3008', '--ignore', 'DL3013', '--ignore', 'DL3018']

  # ========================================================================
  # SHELL SCRIPT LINTING
  # ========================================================================
  - repo: https://github.com/shellcheck-py/shellcheck-py
    rev: v0.9.0.6
    hooks:
      - id: shellcheck
        name: ShellCheck Script Validator
        args: ['--severity=warning']

  # ========================================================================
  # DOCUMENTATION
  # ========================================================================
  - repo: https://github.com/pycqa/pydocstyle
    rev: 6.3.0
    hooks:
      - id: pydocstyle
        name: Pydocstyle Docstring Checker
        args: ['--convention=google']

  # ========================================================================
  # KUBERNETES MANIFEST VALIDATION
  # ========================================================================
  - repo: https://github.com/Lucas-C/pre-commit-hooks
    rev: v1.5.4
    hooks:
      - id: forbid-tabs
        name: Forbid Tabs
        exclude: Makefile
      - id: remove-tabs
        name: Remove Tabs
        exclude: Makefile

# ============================================================================
# GLOBAL SETTINGS
# ============================================================================
default_stages: [commit]
fail_fast: false
minimum_pre_commit_version: '2.20.0'

# Local hooks for custom validation
repos:
  - repo: local
    hooks:
      - id: pytest-check
        name: Run Pytest Unit Tests
        entry: pytest
        language: system
        pass_filenames: false
        always_run: true
        args: ['-xvs', 'tests/', '--tb=short']
        stages: [push]
