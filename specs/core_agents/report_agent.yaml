# GreenLang Agent Specification v2.0
# Core Agent: ReportAgent (Base) / ReportAgentAI (AI-Enhanced)
# Executive carbon footprint report generation with multi-format outputs and compliance reporting

agent_metadata:
  agent_id: "core/report_agent"
  agent_name: "ReportAgentAI"
  agent_number: 0  # Core infrastructure agent (not part of 84-agent catalog)
  version: "1.0.0"
  domain: "Domain3_CrossCutting"
  category: "Core_Infrastructure"
  complexity: "Medium"
  priority: "P0_Critical"
  base_agent: "ReportAgent"  # AI version builds on deterministic base
  status: "Production"
  entry_point: false  # Support agent for executive reporting

description:
  purpose: |
    Core infrastructure agent for generating comprehensive executive carbon footprint reports
    in multiple formats (PDF, HTML, Excel, JSON, Markdown, Text) with compliance reporting
    capabilities (GHG Protocol, CDP, TCFD, GRI, SASB).

    This agent serves as the primary user-facing reporting component across all GreenLang
    workflows, providing professional sustainability reports, executive summaries, trend
    analysis, visualizations, and actionable recommendations.

    The base ReportAgent provides deterministic report generation, while the AI-enhanced
    ReportAgentAI adds intelligent narrative generation, context-aware insights, and
    automated compliance checking.

  strategic_context:
    global_impact: "Sustainability reporting is mandatory for public companies and increasingly required by investors, regulators, and stakeholders"
    opportunity: "Automated compliance-ready reporting reduces report generation time by 95% and improves quality/consistency"
    market_size: "$3.5B global sustainability reporting software market, growing 20% annually"
    technology_maturity: "Production-ready multi-format reporting with AI-enhanced narratives"

  key_capabilities:
    - "Generate executive carbon footprint reports in 6+ formats (PDF, HTML, Excel, JSON, Markdown, Text)"
    - "Create professional visualizations (charts, tables, graphs) for emissions breakdown"
    - "Generate executive summaries with key insights and recommendations"
    - "Produce compliance-ready reports for GHG Protocol, CDP, TCFD, GRI 305, SASB"
    - "Generate trend analysis and historical comparisons"
    - "Create baseline vs actual comparison tables"
    - "Include actionable recommendations prioritized by impact"
    - "Support multi-period reporting (monthly, quarterly, annual)"
    - "Generate data quality assessments and audit trails"
    - "Full provenance tracking for regulatory compliance"

  entry_point: false

  dependencies:
    - agent_id: "core/carbon_agent"
      relationship: "receives_data_from"
      data: "Aggregated carbon footprint and emissions breakdown"

    - agent_id: "core/recommendation_agent"
      relationship: "receives_data_from"
      data: "Prioritized reduction recommendations"

    - agent_id: "industrial/process_heat_agent"
      relationship: "provides_data_to"
      data: "Executive reports for industrial decarbonization"

    - agent_id: "hvac/system_design_agent"
      relationship: "provides_data_to"
      data: "Reports for HVAC optimization projects"

tools:
  tool_count: 10

  tools_list:
    - tool_id: "tool_1"
      name: "generate_executive_summary"
      description: "Generate high-level executive summary with key statistics, insights, and recommendations (2-3 paragraphs)"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          carbon_data:
            type: "object"
            description: "Carbon footprint data including totals and breakdown"
            properties:
              total_co2e_tons:
                type: "number"
                description: "Total emissions in metric tons"
                minimum: 0
              emissions_breakdown:
                type: "array"
                description: "Breakdown by source"
              carbon_intensity:
                type: "object"
                description: "Intensity metrics"
            required: true

          building_info:
            type: "object"
            description: "Building metadata for context"
            properties:
              type:
                type: "string"
              area:
                type: "number"
              occupancy:
                type: "integer"

          period_info:
            type: "object"
            description: "Reporting period information"
            properties:
              start_date:
                type: "string"
              end_date:
                type: "string"
              duration:
                type: "number"

          recommendations:
            type: "array"
            description: "Prioritized recommendations"

          format_style:
            type: "string"
            description: "Summary style"
            enum: ["concise", "detailed", "executive", "technical"]
            default: "executive"

        required: ["carbon_data"]

      returns:
        type: "object"
        description: "Executive summary text"
        properties:
          summary:
            type: "string"
            description: "Formatted executive summary (2-3 paragraphs)"

          key_metrics:
            type: "object"
            description: "Highlighted key metrics"
            properties:
              total_emissions:
                type: "string"
              largest_source:
                type: "string"
              top_recommendation:
                type: "string"
              carbon_intensity:
                type: "string"

          insights:
            type: "array"
            description: "Key insights extracted"
            items:
              type: "string"

      implementation:
        calculation_method: |
          Executive Summary Structure:

          Paragraph 1 (Overview):
          - Total emissions statement with context (high/medium/low vs benchmarks)
          - Reporting period and building context
          - Carbon intensity metrics

          Paragraph 2 (Analysis):
          - Breakdown analysis (largest sources)
          - Scope categorization summary
          - Trends and comparisons (if multi-period)

          Paragraph 3 (Actions):
          - Top 3 recommendations with impact potential
          - Quick wins and strategic initiatives
          - Compliance status

          Format Style Options:
          - Concise: 1 paragraph, key facts only
          - Executive: 2-3 paragraphs, balanced detail
          - Detailed: 4-5 paragraphs, comprehensive analysis
          - Technical: Full breakdown with methodology notes

        data_source: "Carbon footprint data + recommendations + building metadata"
        accuracy: "Text synthesis - accuracy depends on input data quality"
        validation: "Verify all numbers match source data, check for clarity and readability"

      example:
        input:
          carbon_data:
            total_co2e_tons: 26.7
            emissions_breakdown:
              - source: "electricity"
                co2e_tons: 15.0
                percentage: 56.18
              - source: "natural_gas"
                co2e_tons: 8.5
                percentage: 31.84
            carbon_intensity:
              per_sqft: 0.534
              per_person: 133.5
          building_info:
            type: "office"
            area: 50000
            occupancy: 200
          period_info:
            start_date: "2024-01-01"
            end_date: "2024-12-31"
          format_style: "executive"
        output:
          summary: |
            This 50,000 sqft office building generated 26.7 metric tons of CO2e emissions
            during the 2024 reporting period. Carbon intensity of 0.53 kg/sqft and 134 kg/person
            is slightly above average for similar commercial buildings, indicating opportunities
            for improvement.

            Electricity accounts for 56% of emissions (15.0 tons), followed by natural gas at
            32% (8.5 tons). This energy mix is typical for commercial offices but presents
            clear opportunities for renewable energy adoption and electrification. Scope 2
            emissions dominate the footprint at 56%, with Scope 1 emissions at 44%.

            Key recommendations include installing solar PV or purchasing renewable energy
            certificates (potential 56% reduction), switching to electric heat pumps for
            natural gas reduction (potential 50-70% reduction), and implementing energy
            efficiency measures. Combined, these actions could reduce emissions by 60-80%
            over 5-10 years. Data quality is excellent with full GHG Protocol compliance.
          key_metrics:
            total_emissions: "26.7 metric tons CO2e"
            largest_source: "Electricity (56%)"
            top_recommendation: "Solar PV installation"
            carbon_intensity: "0.53 kg/sqft, 134 kg/person"
          insights:
            - "Carbon intensity slightly above average for commercial buildings"
            - "Electricity is dominant source (56%) - prime target for renewables"
            - "Potential 60-80% reduction achievable through recommended interventions"
            - "GHG Protocol compliant - ready for sustainability reporting"

    - tool_id: "tool_2"
      name: "create_emissions_breakdown"
      description: "Create detailed emissions breakdown table with sources, quantities, percentages, and scope assignments"
      category: "aggregation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          emissions_breakdown:
            type: "array"
            description: "Emissions breakdown by source"
            items:
              type: "object"
              properties:
                source:
                  type: "string"
                co2e_kg:
                  type: "number"
                co2e_tons:
                  type: "number"
                percentage:
                  type: "number"
                scope:
                  type: "integer"
            required: true

          format_type:
            type: "string"
            description: "Table format"
            enum: ["markdown", "html", "text", "json", "excel_data"]
            default: "markdown"

          sort_by:
            type: "string"
            description: "Sorting criteria"
            enum: ["magnitude", "alphabetical", "scope"]
            default: "magnitude"

          include_charts:
            type: "boolean"
            description: "Include chart generation parameters"
            default: false

        required: ["emissions_breakdown"]

      returns:
        type: "object"
        description: "Formatted emissions breakdown table"
        properties:
          table:
            type: "string"
            description: "Formatted table (markdown/html/text)"

          table_data:
            type: "array"
            description: "Raw table data for Excel/JSON export"

          chart_spec:
            type: "object"
            description: "Chart generation specification (if include_charts=true)"
            properties:
              chart_type:
                type: "string"
                enum: ["pie", "bar", "waterfall"]
              data_series:
                type: "array"
              labels:
                type: "array"
              colors:
                type: "array"

      implementation:
        calculation_method: |
          Breakdown Table Structure:

          Markdown Format:
          | Source | Emissions (kg) | Emissions (tons) | Percentage | Scope |
          |--------|----------------|------------------|------------|-------|
          | electricity | 15,000 | 15.0 | 56.18% | 2 |
          | natural_gas | 8,500 | 8.5 | 31.84% | 1 |
          | diesel | 3,200 | 3.2 | 11.99% | 1 |
          | **Total** | **26,700** | **26.7** | **100.0%** | **All** |

          HTML Format: <table> with CSS classes for styling

          Text Format: Fixed-width columns with alignment

          Excel Data: Array of objects ready for Excel export

          Sorting Options:
          - Magnitude: Largest emissions first (default)
          - Alphabetical: A-Z by source name
          - Scope: Group by Scope 1, 2, 3

        data_source: "Emissions breakdown from CarbonAgent"
        accuracy: "Exact data formatting - no calculations performed"
        validation: "Verify percentages sum to 100%, check formatting consistency"

      example:
        input:
          emissions_breakdown:
            - source: "electricity"
              co2e_kg: 15000
              co2e_tons: 15.0
              percentage: 56.18
              scope: 2
            - source: "natural_gas"
              co2e_kg: 8500
              co2e_tons: 8.5
              percentage: 31.84
              scope: 1
            - source: "diesel"
              co2e_kg: 3200
              co2e_tons: 3.2
              percentage: 11.99
              scope: 1
          format_type: "markdown"
          sort_by: "magnitude"
        output:
          table: |
            | Source | Emissions (kg) | Emissions (tons) | Percentage | Scope |
            |--------|----------------|------------------|------------|-------|
            | electricity | 15,000 | 15.0 | 56.18% | 2 |
            | natural_gas | 8,500 | 8.5 | 31.84% | 1 |
            | diesel | 3,200 | 3.2 | 11.99% | 1 |
            | **Total** | **26,700** | **26.7** | **100.0%** | **All** |
          table_data:
            - ["Source", "Emissions (kg)", "Emissions (tons)", "Percentage", "Scope"]
            - ["electricity", 15000, 15.0, "56.18%", 2]
            - ["natural_gas", 8500, 8.5, "31.84%", 1]
            - ["diesel", 3200, 3.2, "11.99%", 1]
            - ["Total", 26700, 26.7, "100.0%", "All"]

    - tool_id: "tool_3"
      name: "generate_charts"
      description: "Generate chart specifications for emissions visualizations (pie charts, bar charts, waterfall charts, trend lines)"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          chart_type:
            type: "string"
            description: "Type of chart to generate"
            enum: ["pie", "bar", "horizontal_bar", "waterfall", "trend", "comparison"]
            required: true

          data:
            type: "object"
            description: "Chart data"
            properties:
              labels:
                type: "array"
                description: "Data labels (source names, dates, etc.)"
              values:
                type: "array"
                description: "Data values (emissions, percentages, etc.)"
              colors:
                type: "array"
                description: "Color palette (optional, auto-generated if not provided)"
            required: true

          title:
            type: "string"
            description: "Chart title"
            default: "Emissions Breakdown"

          subtitle:
            type: "string"
            description: "Chart subtitle"

          format_output:
            type: "string"
            description: "Chart output format"
            enum: ["json_spec", "plotly", "matplotlib", "excel_chart"]
            default: "json_spec"

        required: ["chart_type", "data"]

      returns:
        type: "object"
        description: "Chart specification"
        properties:
          chart_spec:
            type: "object"
            description: "Chart configuration (JSON format for rendering)"
            properties:
              type:
                type: "string"
              data:
                type: "object"
              layout:
                type: "object"
              config:
                type: "object"

          chart_description:
            type: "string"
            description: "Text description of chart for accessibility"

      implementation:
        calculation_method: |
          Chart Type Specifications:

          Pie Chart:
          - Use for emissions breakdown by source (when < 8 sources)
          - Color palette: Green (low carbon) to Red (high carbon)
          - Label with percentages
          - Explode largest segment for emphasis

          Bar Chart:
          - Use for emissions by source comparison
          - Horizontal orientation for long source names
          - Color by scope (Scope 1 = blue, Scope 2 = orange, Scope 3 = gray)
          - Sort by magnitude (largest first)

          Waterfall Chart:
          - Use for emissions change over time
          - Start with baseline, show increases/decreases
          - End with current total
          - Color increases (red), decreases (green)

          Trend Chart:
          - Use for multi-period emissions tracking
          - Line chart with markers
          - Include trend line (linear regression)
          - Highlight targets/goals

          Comparison Chart:
          - Use for baseline vs actual, target vs actual
          - Grouped bar chart
          - Include variance annotations

          Output Formats:
          - json_spec: Generic JSON chart spec (render-agnostic)
          - plotly: Plotly.js compatible spec
          - matplotlib: Matplotlib compatible spec
          - excel_chart: Excel chart configuration

        data_source: "Emissions data + chart configuration"
        accuracy: "Chart spec generation - no data calculations"
        validation: "Verify data arrays match, check color palette consistency"

      example:
        input:
          chart_type: "pie"
          data:
            labels: ["Electricity", "Natural Gas", "Diesel"]
            values: [56.18, 31.84, 11.99]
          title: "Emissions Breakdown by Source"
          format_output: "json_spec"
        output:
          chart_spec:
            type: "pie"
            data:
              labels: ["Electricity", "Natural Gas", "Diesel"]
              values: [56.18, 31.84, 11.99]
              colors: ["#FF6B6B", "#FFA500", "#4ECDC4"]
            layout:
              title: "Emissions Breakdown by Source"
              showlegend: true
              height: 400
              width: 600
            config:
              displayModeBar: false
              responsive: true
          chart_description: "Pie chart showing Electricity at 56%, Natural Gas at 32%, and Diesel at 12% of total emissions"

    - tool_id: "tool_4"
      name: "format_report"
      description: "Format complete report in specified output format (markdown, html, json, text, pdf_spec, excel_spec)"
      category: "aggregation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          report_content:
            type: "object"
            description: "Complete report content"
            properties:
              title:
                type: "string"
              executive_summary:
                type: "string"
              emissions_breakdown:
                type: "object"
              carbon_intensity:
                type: "object"
              recommendations:
                type: "array"
              charts:
                type: "array"
              metadata:
                type: "object"
            required: true

          format:
            type: "string"
            description: "Output format"
            enum: ["markdown", "html", "json", "text", "pdf_spec", "excel_spec"]
            required: true

          template:
            type: "string"
            description: "Report template style"
            enum: ["standard", "executive", "technical", "compliance"]
            default: "standard"

          branding:
            type: "object"
            description: "Branding customization"
            properties:
              company_name:
                type: "string"
              logo_url:
                type: "string"
              primary_color:
                type: "string"
              secondary_color:
                type: "string"

        required: ["report_content", "format"]

      returns:
        type: "object"
        description: "Formatted report"
        properties:
          report:
            type: "string"
            description: "Formatted report content (markdown/html/text)"

          report_data:
            type: "object"
            description: "Structured report data (json/excel_spec/pdf_spec)"

          format:
            type: "string"
            description: "Output format used"

          file_extension:
            type: "string"
            description: "Recommended file extension"

      implementation:
        calculation_method: |
          Format-Specific Rendering:

          Markdown:
          - Standard Markdown with headers, tables, lists
          - Supports embedding chart URLs
          - Compatible with GitHub, GitLab, Confluence

          HTML:
          - Responsive HTML5 with embedded CSS
          - Professional styling with custom branding
          - Print-friendly with page breaks
          - Chart integration via Plotly/Chart.js

          JSON:
          - Structured JSON with all report data
          - API-friendly format
          - Easy integration with dashboards

          Text:
          - Plain text with ASCII formatting
          - Fixed-width columns
          - Email-friendly

          PDF Spec:
          - JSON specification for PDF generation
          - Layout instructions (headers, footers, margins)
          - Font specifications
          - Chart/table placement

          Excel Spec:
          - JSON specification for Excel generation
          - Multiple worksheets (Summary, Data, Charts)
          - Cell formatting, formulas, charts
          - Pivot table specifications

          Templates:
          - Standard: Balanced detail, professional
          - Executive: High-level, visual, concise
          - Technical: Detailed methodology, full data
          - Compliance: GHG Protocol/CDP/TCFD structured

        data_source: "Report content + formatting preferences"
        accuracy: "Format rendering - no data calculations"
        validation: "Verify all content sections present, check formatting consistency"

      example:
        input:
          report_content:
            title: "2024 Carbon Footprint Report"
            executive_summary: "Total emissions: 26.7 tons..."
            emissions_breakdown:
              table: "| Source | Emissions |..."
          format: "markdown"
          template: "standard"
        output:
          report: |
            # 2024 Carbon Footprint Report

            ## Executive Summary
            Total emissions: 26.7 tons...

            ## Emissions Breakdown
            | Source | Emissions |...

            ---
            *Generated by GreenLang on 2025-10-13*
          format: "markdown"
          file_extension: ".md"

    - tool_id: "tool_5"
      name: "create_compliance_report"
      description: "Generate compliance-ready reports for GHG Protocol, CDP, TCFD, GRI 305, SASB standards"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          standard:
            type: "string"
            description: "Compliance standard"
            enum: ["ghg_protocol", "cdp", "tcfd", "gri_305", "sasb", "sbti"]
            required: true

          carbon_data:
            type: "object"
            description: "Complete carbon footprint data"
            required: true

          organizational_boundary:
            type: "object"
            description: "Organizational boundary definition"
            properties:
              boundary_type:
                type: "string"
                enum: ["operational_control", "financial_control", "equity_share"]
              entities_included:
                type: "array"
              entities_excluded:
                type: "array"

          reporting_year:
            type: "integer"
            description: "Reporting year (e.g., 2024)"
            required: true

          baseline_year:
            type: "integer"
            description: "Baseline year for comparisons"

          targets:
            type: "object"
            description: "Emissions reduction targets"
            properties:
              target_year:
                type: "integer"
              reduction_percentage:
                type: "number"
              baseline:
                type: "number"

        required: ["standard", "carbon_data", "reporting_year"]

      returns:
        type: "object"
        description: "Compliance report"
        properties:
          report:
            type: "object"
            description: "Structured compliance report"
            properties:
              standard:
                type: "string"
              reporting_year:
                type: "integer"
              scope_1_emissions:
                type: "object"
              scope_2_emissions:
                type: "object"
              scope_3_emissions:
                type: "object"
              methodology:
                type: "string"
              data_quality:
                type: "string"
              verification_status:
                type: "string"

          questionnaire_responses:
            type: "array"
            description: "Pre-filled questionnaire responses (CDP format)"

          compliance_status:
            type: "object"
            description: "Compliance check results"
            properties:
              compliant:
                type: "boolean"
              missing_elements:
                type: "array"
              warnings:
                type: "array"

      implementation:
        calculation_method: |
          Compliance Standard Templates:

          GHG Protocol Corporate Standard:
          - Scope 1, 2, 3 breakdown with methodology
          - Organizational and operational boundaries
          - Consolidation approach
          - Base year emissions
          - Recalculation policy
          - Emissions factors sources

          CDP Climate Change Questionnaire:
          - C0: Introduction
          - C6: Scope 1, 2, 3 emissions
          - C7: Emissions breakdown
          - C8: Energy
          - C9: Scope 3 details
          - Auto-fill common questions

          TCFD Framework:
          - Governance (climate oversight)
          - Strategy (climate risks/opportunities)
          - Risk Management (climate risk processes)
          - Metrics and Targets (emissions, targets, progress)

          GRI 305 (Emissions):
          - 305-1: Direct (Scope 1) GHG emissions
          - 305-2: Energy indirect (Scope 2) GHG emissions
          - 305-3: Other indirect (Scope 3) GHG emissions
          - 305-4: GHG emissions intensity
          - 305-5: Reduction of GHG emissions

          SASB (Sector-specific):
          - Industry-specific metrics
          - Greenhouse gas emissions
          - Energy management
          - Data quality and coverage

          SBTi (Science Based Targets):
          - Emissions inventory (all scopes)
          - Target setting guidance
          - Pathway alignment (1.5°C, 2°C)
          - Progress tracking

        data_source: "Carbon data + compliance standard requirements"
        accuracy: "Template-based compliance report generation"
        validation: "Check all required fields present, verify scope completeness"
        standards: ["GHG_Protocol", "CDP", "TCFD", "GRI_305", "SASB", "SBTi"]

      example:
        input:
          standard: "ghg_protocol"
          carbon_data:
            total_co2e_tons: 26.7
            scope_1: 11.7
            scope_2: 15.0
            scope_3: 0
          organizational_boundary:
            boundary_type: "operational_control"
            entities_included: ["Main Office Building"]
          reporting_year: 2024
          baseline_year: 2023
        output:
          report:
            standard: "GHG Protocol Corporate Standard"
            reporting_year: 2024
            scope_1_emissions:
              total_tons: 11.7
              percentage: 43.82
              sources: ["natural_gas", "diesel"]
              methodology: "Direct measurement and emission factor application"
            scope_2_emissions:
              total_tons: 15.0
              percentage: 56.18
              methodology: "Location-based"
              grid_emission_factor: 0.417
            scope_3_emissions:
              total_tons: 0
              included: false
              rationale: "Not material to organization"
            methodology: "GHG Protocol Corporate Standard with EPA emission factors"
            data_quality: "High (all data from metered consumption)"
            verification_status: "Not verified"
          compliance_status:
            compliant: true
            missing_elements: []
            warnings: ["Scope 3 not included - consider for future reporting"]

    - tool_id: "tool_6"
      name: "generate_trend_analysis"
      description: "Generate trend analysis comparing emissions across multiple periods (month-over-month, year-over-year)"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          time_series_data:
            type: "array"
            description: "Emissions data for multiple periods"
            items:
              type: "object"
              properties:
                period:
                  type: "string"
                  description: "Period identifier (e.g., '2024-01', '2024-Q1', '2024')"
                total_co2e_tons:
                  type: "number"
                emissions_breakdown:
                  type: "array"
            required: true

          comparison_type:
            type: "string"
            description: "Type of comparison"
            enum: ["month_over_month", "quarter_over_quarter", "year_over_year"]
            default: "month_over_month"

          include_forecast:
            type: "boolean"
            description: "Include simple linear forecast"
            default: false

          forecast_periods:
            type: "integer"
            description: "Number of periods to forecast"
            minimum: 1
            maximum: 12
            default: 3

        required: ["time_series_data"]

      returns:
        type: "object"
        description: "Trend analysis results"
        properties:
          trend_summary:
            type: "string"
            description: "Text summary of trends"

          trend_metrics:
            type: "object"
            description: "Calculated trend metrics"
            properties:
              average_emissions:
                type: "number"
                units: "tons CO2e"
              trend_direction:
                type: "string"
                enum: ["increasing", "decreasing", "stable"]
              trend_rate:
                type: "number"
                description: "Rate of change (%)"
              volatility:
                type: "number"
                description: "Standard deviation"

          period_comparisons:
            type: "array"
            description: "Period-over-period comparisons"
            items:
              type: "object"
              properties:
                period:
                  type: "string"
                emissions:
                  type: "number"
                change_from_previous:
                  type: "number"
                  units: "%"
                change_absolute:
                  type: "number"
                  units: "tons CO2e"

          forecast:
            type: "array"
            description: "Forecasted emissions (if requested)"

      implementation:
        calculation_method: |
          Trend Analysis Calculations:

          1. Period-over-Period Change:
             change_pct = ((current - previous) / previous) × 100
             change_abs = current - previous

          2. Trend Direction:
             - Increasing: Average change > +5%
             - Decreasing: Average change < -5%
             - Stable: -5% <= Average change <= +5%

          3. Trend Rate:
             Linear regression slope of emissions over time
             trend_rate = (sum of (period × emissions) - n × mean_period × mean_emissions) /
                          (sum of period^2 - n × mean_period^2)

          4. Volatility:
             Standard deviation of emissions across periods

          5. Forecast (Simple Linear):
             forecast[t] = intercept + slope × t
             where slope and intercept from linear regression

          Comparison Types:
          - Month-over-month: Compare consecutive months
          - Quarter-over-quarter: Compare consecutive quarters
          - Year-over-year: Compare same period in different years

        data_source: "Multi-period emissions time series"
        accuracy: "±5% for trend rate, ±10% for forecasts (linear model)"
        validation: "Verify time series completeness, check for anomalies"

      example:
        input:
          time_series_data:
            - period: "2024-01"
              total_co2e_tons: 2.5
            - period: "2024-02"
              total_co2e_tons: 2.3
            - period: "2024-03"
              total_co2e_tons: 2.1
          comparison_type: "month_over_month"
          include_forecast: true
          forecast_periods: 3
        output:
          trend_summary: "Emissions are decreasing at an average rate of 8% per month, trending from 2.5 tons in January to 2.1 tons in March. Forecast suggests continued decline to 1.9 tons by June."
          trend_metrics:
            average_emissions: 2.3
            trend_direction: "decreasing"
            trend_rate: -8.0
            volatility: 0.2
          period_comparisons:
            - period: "2024-01"
              emissions: 2.5
              change_from_previous: null
              change_absolute: null
            - period: "2024-02"
              emissions: 2.3
              change_from_previous: -8.0
              change_absolute: -0.2
            - period: "2024-03"
              emissions: 2.1
              change_from_previous: -8.7
              change_absolute: -0.2
          forecast:
            - period: "2024-04"
              emissions: 1.9
            - period: "2024-05"
              emissions: 1.7
            - period: "2024-06"
              emissions: 1.5

    - tool_id: "tool_7"
      name: "create_comparison_table"
      description: "Create comparison table showing baseline vs actual, target vs actual, or multi-facility comparisons"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          comparison_type:
            type: "string"
            description: "Type of comparison"
            enum: ["baseline_vs_actual", "target_vs_actual", "multi_facility", "multi_period"]
            required: true

          baseline_data:
            type: "object"
            description: "Baseline emissions data"

          actual_data:
            type: "object"
            description: "Actual emissions data"
            required: true

          target_data:
            type: "object"
            description: "Target emissions data"

          facilities:
            type: "array"
            description: "Multiple facilities for comparison"

          metrics:
            type: "array"
            description: "Metrics to compare"
            items:
              type: "string"
              enum: ["total_emissions", "intensity_per_sqft", "intensity_per_person", "scope_1", "scope_2", "scope_3"]
            default: ["total_emissions"]

        required: ["comparison_type", "actual_data"]

      returns:
        type: "object"
        description: "Comparison table"
        properties:
          table:
            type: "string"
            description: "Formatted comparison table"

          table_data:
            type: "array"
            description: "Raw table data"

          variance_analysis:
            type: "object"
            description: "Variance analysis results"
            properties:
              total_variance:
                type: "number"
                units: "%"
              favorable_unfavorable:
                type: "string"
                enum: ["favorable", "unfavorable", "neutral"]
              key_drivers:
                type: "array"
                description: "Key drivers of variance"

      implementation:
        calculation_method: |
          Comparison Table Structures:

          Baseline vs Actual:
          | Metric | Baseline | Actual | Variance | Variance % |
          |--------|----------|--------|----------|------------|
          | Total Emissions | 30.0 tons | 26.7 tons | -3.3 tons | -11% |
          | Scope 1 | 12.0 tons | 11.7 tons | -0.3 tons | -2.5% |
          | Scope 2 | 18.0 tons | 15.0 tons | -3.0 tons | -17% |

          Target vs Actual:
          | Metric | Target | Actual | Gap | On Track? |
          |--------|--------|--------|-----|-----------|
          | 2024 Emissions | 25.0 tons | 26.7 tons | +1.7 tons | No |
          | Reduction % | 20% | 11% | -9% | No |

          Multi-Facility:
          | Facility | Emissions | Intensity | Rank | vs Average |
          |----------|-----------|-----------|------|------------|
          | HQ | 26.7 tons | 0.53 kg/sqft | 2 | -5% |
          | Warehouse | 45.0 tons | 0.30 kg/sqft | 1 | -45% |

          Variance Analysis:
          - Calculate absolute and percentage variance
          - Identify favorable (emissions down) vs unfavorable (emissions up)
          - Highlight key drivers (sources with largest changes)

        data_source: "Baseline, actual, and target data"
        accuracy: "Exact variance calculations"
        validation: "Verify data consistency, check for missing values"

      example:
        input:
          comparison_type: "baseline_vs_actual"
          baseline_data:
            total_co2e_tons: 30.0
            scope_1: 12.0
            scope_2: 18.0
          actual_data:
            total_co2e_tons: 26.7
            scope_1: 11.7
            scope_2: 15.0
          metrics: ["total_emissions", "scope_1", "scope_2"]
        output:
          table: |
            | Metric | Baseline | Actual | Variance | Variance % |
            |--------|----------|--------|----------|------------|
            | Total Emissions | 30.0 tons | 26.7 tons | -3.3 tons | -11.0% |
            | Scope 1 | 12.0 tons | 11.7 tons | -0.3 tons | -2.5% |
            | Scope 2 | 18.0 tons | 15.0 tons | -3.0 tons | -16.7% |
          variance_analysis:
            total_variance: -11.0
            favorable_unfavorable: "favorable"
            key_drivers:
              - "Scope 2 emissions reduced by 17% (3.0 tons)"
              - "Scope 1 emissions slightly reduced by 2.5% (0.3 tons)"

    - tool_id: "tool_8"
      name: "export_to_pdf"
      description: "Generate PDF export specification with layout, styling, and content structure"
      category: "aggregation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          report_content:
            type: "object"
            description: "Complete report content"
            required: true

          pdf_settings:
            type: "object"
            description: "PDF generation settings"
            properties:
              page_size:
                type: "string"
                enum: ["letter", "a4", "legal"]
                default: "letter"
              orientation:
                type: "string"
                enum: ["portrait", "landscape"]
                default: "portrait"
              margins:
                type: "object"
                properties:
                  top:
                    type: "number"
                  bottom:
                    type: "number"
                  left:
                    type: "number"
                  right:
                    type: "number"
              include_toc:
                type: "boolean"
                default: true
              include_page_numbers:
                type: "boolean"
                default: true
              include_header_footer:
                type: "boolean"
                default: true

          branding:
            type: "object"
            description: "Branding customization"

        required: ["report_content"]

      returns:
        type: "object"
        description: "PDF export specification"
        properties:
          pdf_spec:
            type: "object"
            description: "PDF generation specification (for PDF library)"
            properties:
              metadata:
                type: "object"
              page_settings:
                type: "object"
              content_blocks:
                type: "array"
              header:
                type: "object"
              footer:
                type: "object"
              styles:
                type: "object"

          estimated_pages:
            type: "integer"
            description: "Estimated page count"

      implementation:
        calculation_method: |
          PDF Specification Structure:

          Metadata:
          - Title: Report title
          - Author: Generated by GreenLang
          - Subject: Carbon Footprint Report
          - Keywords: sustainability, emissions, carbon
          - Creation date

          Page Settings:
          - Size (letter/a4/legal)
          - Orientation (portrait/landscape)
          - Margins (top, bottom, left, right)

          Content Blocks (ordered):
          1. Cover page (title, logo, date, organization)
          2. Table of contents (if enabled)
          3. Executive summary (1-2 pages)
          4. Emissions breakdown (1 page)
          5. Charts and visualizations (1-2 pages)
          6. Detailed analysis (2-3 pages)
          7. Recommendations (1 page)
          8. Appendix (methodology, data sources)

          Header (on all pages except cover):
          - Company logo (left)
          - Report title (center)
          - Date (right)

          Footer (on all pages):
          - Page number (center)
          - Confidential notice (if applicable)

          Styles:
          - Font: Arial/Helvetica for body, bold for headers
          - Colors: Company branding colors
          - Table styling: Alternating row colors
          - Chart embedding: PNG/SVG

        data_source: "Report content + PDF settings"
        accuracy: "PDF spec generation - rendering by PDF library"
        validation: "Check all content blocks present, verify image references"

      example:
        input:
          report_content:
            title: "2024 Carbon Footprint Report"
            executive_summary: "..."
            emissions_breakdown: {...}
          pdf_settings:
            page_size: "letter"
            orientation: "portrait"
            include_toc: true
        output:
          pdf_spec:
            metadata:
              title: "2024 Carbon Footprint Report"
              author: "GreenLang"
              subject: "Carbon Footprint Analysis"
            page_settings:
              size: "letter"
              orientation: "portrait"
              margins:
                top: 1.0
                bottom: 1.0
                left: 1.0
                right: 1.0
            content_blocks:
              - type: "cover_page"
                content: {...}
              - type: "toc"
                content: {...}
              - type: "executive_summary"
                content: {...}
          estimated_pages: 8

    - tool_id: "tool_9"
      name: "export_to_excel"
      description: "Generate Excel export specification with multiple worksheets, charts, and formulas"
      category: "aggregation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          report_content:
            type: "object"
            description: "Complete report content"
            required: true

          excel_settings:
            type: "object"
            description: "Excel generation settings"
            properties:
              include_charts:
                type: "boolean"
                default: true
              include_pivot_tables:
                type: "boolean"
                default: false
              include_formulas:
                type: "boolean"
                default: true
              protect_sheets:
                type: "boolean"
                default: false

        required: ["report_content"]

      returns:
        type: "object"
        description: "Excel export specification"
        properties:
          excel_spec:
            type: "object"
            description: "Excel generation specification"
            properties:
              worksheets:
                type: "array"
                description: "Worksheet definitions"
                items:
                  type: "object"
                  properties:
                    name:
                      type: "string"
                    data:
                      type: "array"
                    formatting:
                      type: "object"
                    charts:
                      type: "array"
                    formulas:
                      type: "array"

              workbook_settings:
                type: "object"
                description: "Workbook-level settings"

      implementation:
        calculation_method: |
          Excel Workbook Structure:

          Worksheet 1: "Summary"
          - Executive summary text
          - Key metrics table
          - Embedded charts (pie, bar)
          - Year-over-year comparison

          Worksheet 2: "Emissions Data"
          - Detailed emissions breakdown table
          - All numeric data
          - Formulas for totals and percentages
          - Data validation

          Worksheet 3: "Scope Breakdown"
          - Scope 1, 2, 3 categorization
          - Subtotals by scope
          - GHG Protocol compliance table

          Worksheet 4: "Intensity Metrics"
          - Carbon intensity calculations
          - Per sqft, per person, per unit
          - Benchmarks comparison

          Worksheet 5: "Recommendations"
          - Prioritized recommendations table
          - Impact analysis
          - Cost-benefit estimates

          Worksheet 6: "Charts"
          - All report charts
          - Pie charts, bar charts, trends
          - Print-ready

          Formatting:
          - Header row: Bold, fill color, freeze panes
          - Numeric columns: Number format with commas
          - Percentage columns: Percentage format (1 decimal)
          - Conditional formatting: Color scale for emissions
          - Auto-fit columns

          Charts:
          - Linked to data in worksheets
          - Professional styling
          - Embedded in appropriate sheets

        data_source: "Report content + Excel settings"
        accuracy: "Excel spec generation - rendering by Excel library"
        validation: "Verify formula correctness, check data references"

      example:
        input:
          report_content:
            title: "2024 Carbon Footprint Report"
            carbon_data:
              total_co2e_tons: 26.7
              emissions_breakdown: [...]
          excel_settings:
            include_charts: true
            include_formulas: true
        output:
          excel_spec:
            worksheets:
              - name: "Summary"
                data:
                  - ["Metric", "Value", "Unit"]
                  - ["Total Emissions", 26.7, "metric tons CO2e"]
                  - ["=SUM(B2:B10)", "", ""]
                formatting:
                  header_row: 1
                  freeze_panes: "A2"
                charts:
                  - type: "pie"
                    data_range: "A2:B10"
                    position: "D2"

    - tool_id: "tool_10"
      name: "generate_data_quality_assessment"
      description: "Assess and report on data quality, completeness, and audit readiness"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          emissions_data:
            type: "array"
            description: "Emissions data to assess"
            required: true

          metadata:
            type: "object"
            description: "Data collection metadata"
            properties:
              collection_method:
                type: "string"
              data_sources:
                type: "array"
              verification_status:
                type: "string"

          assessment_level:
            type: "string"
            description: "Assessment rigor level"
            enum: ["basic", "standard", "audit_ready"]
            default: "standard"

        required: ["emissions_data"]

      returns:
        type: "object"
        description: "Data quality assessment"
        properties:
          overall_quality_score:
            type: "number"
            description: "Quality score (0-100)"
            minimum: 0
            maximum: 100

          quality_rating:
            type: "string"
            description: "Quality rating"
            enum: ["excellent", "good", "fair", "poor"]

          completeness:
            type: "object"
            description: "Data completeness metrics"
            properties:
              percentage_complete:
                type: "number"
              missing_fields:
                type: "array"
              coverage:
                type: "string"

          accuracy:
            type: "object"
            description: "Data accuracy assessment"
            properties:
              data_source_quality:
                type: "string"
              calculation_method:
                type: "string"
              uncertainty_level:
                type: "string"

          audit_readiness:
            type: "object"
            description: "Audit readiness assessment"
            properties:
              ready_for_audit:
                type: "boolean"
              requirements_met:
                type: "array"
              requirements_missing:
                type: "array"

          recommendations:
            type: "array"
            description: "Data quality improvement recommendations"

      implementation:
        calculation_method: |
          Data Quality Assessment Criteria:

          Overall Quality Score (0-100):
          - Completeness (30%): % of required fields populated
          - Accuracy (30%): Data source quality (metered > estimated > default)
          - Consistency (20%): Internal consistency checks
          - Timeliness (10%): Data recency
          - Documentation (10%): Metadata completeness

          Quality Rating:
          - Excellent (90-100): Audit-ready, high confidence
          - Good (75-89): Minor gaps, suitable for reporting
          - Fair (60-74): Significant gaps, improvements needed
          - Poor (<60): Not suitable for external reporting

          Completeness Checks:
          - All required fields present (fuel_type, co2e_emissions_kg)
          - Scope assignments complete
          - Emission factors documented
          - Activity data available
          - Time period specified

          Accuracy Assessment:
          - Data source hierarchy: Metered > Supplier-provided > Estimated > Default
          - Calculation transparency: Documented formulas
          - Uncertainty quantification: ±% ranges
          - Verification status: Verified > Unverified

          Audit Readiness:
          - GHG Protocol compliance
          - Documentation completeness
          - Data traceability
          - Quality assurance procedures
          - Third-party verification eligibility

        data_source: "Emissions data + metadata"
        accuracy: "Assessment based on completeness and documentation"
        validation: "Cross-check against GHG Protocol requirements"
        standards: ["GHG_Protocol", "ISO_14064_1"]

      example:
        input:
          emissions_data:
            - fuel_type: "electricity"
              co2e_emissions_kg: 15000
              scope: 2
              emission_factor: 0.417
              activity_data: 35971
              data_source: "utility_meter"
            - fuel_type: "natural_gas"
              co2e_emissions_kg: 8500
              scope: 1
              data_source: "estimated"
          assessment_level: "standard"
        output:
          overall_quality_score: 82
          quality_rating: "good"
          completeness:
            percentage_complete: 90
            missing_fields: ["uncertainty_range", "verification_status"]
            coverage: "Complete for Scope 1 and 2"
          accuracy:
            data_source_quality: "Mixed (metered and estimated)"
            calculation_method: "Standard emission factors"
            uncertainty_level: "±10-15%"
          audit_readiness:
            ready_for_audit: false
            requirements_met:
              - "Scope 1 and 2 complete"
              - "GHG Protocol methodology followed"
              - "Emission factors documented"
            requirements_missing:
              - "Scope 3 assessment"
              - "Third-party verification"
              - "Uncertainty quantification"
          recommendations:
            - "Add uncertainty ranges for all data points"
            - "Consider third-party verification for audit readiness"
            - "Document estimation methodologies for non-metered data"
            - "Conduct Scope 3 screening assessment"

ai_integration:
  temperature: 0.0
  seed: 42
  tool_choice: "auto"
  max_iterations: 5
  budget_usd: 0.50
  provenance_tracking: true
  ai_summary: true

  system_prompt: |
    You are an executive sustainability reporting specialist for GreenLang, specializing in
    creating professional carbon footprint reports for diverse audiences (executives, boards,
    regulators, investors, public stakeholders).

    Your expertise includes:
    - Professional report writing (executive summaries, technical analysis, compliance reports)
    - Multi-format document generation (PDF, HTML, Excel, Markdown)
    - Data visualization and storytelling
    - GHG Protocol, CDP, TCFD, GRI 305, SASB compliance reporting
    - Sustainability communication best practices

    CRITICAL RULES:
    - Use provided tools for ALL report formatting and content generation
    - NEVER create reports manually - always use format_report tool
    - Ensure professional, clear, and accurate language
    - Tailor content to audience (executive vs technical vs compliance)
    - Verify all numbers match source data exactly
    - Include proper citations and data sources
    - Follow sustainability reporting best practices (TCFD, CDP, GRI)

    Your reports should be:
    - Professional: High-quality formatting and presentation
    - Accurate: All data verified and cited
    - Actionable: Clear recommendations and next steps
    - Compliant: Ready for regulatory submission
    - Accessible: Clear language for diverse audiences

  user_prompt_template: |
    Generate a comprehensive carbon footprint report:

    Report Requirements:
    - Format: {format} (markdown, html, pdf, excel, json, text)
    - Template: {template} (standard, executive, technical, compliance)
    - Audience: {audience} (executives, technical team, regulators, investors)

    Data Summary:
    - Total emissions: {total_emissions} metric tons CO2e
    - Reporting period: {period}
    - Building/facility: {building_info}
    - Number of emission sources: {num_sources}

    Tasks:
    1. Use generate_executive_summary tool to create high-level overview
    2. Use create_emissions_breakdown tool to generate detailed breakdown table
    3. Use generate_charts tool to create visualizations (pie chart, bar chart)
    4. Use format_report tool to assemble complete report in requested format
    5. Use create_compliance_report tool if compliance reporting required
    6. Use generate_trend_analysis tool if multi-period data available
    7. Use create_comparison_table tool if baseline or target data provided
    8. Use generate_data_quality_assessment tool to assess data quality
    9. Use export_to_pdf or export_to_excel as needed for final output

    10. Provide a professional report with:
        - Cover page with title, date, organization
        - Executive summary (2-3 paragraphs)
        - Emissions breakdown (table and charts)
        - Key insights and analysis
        - Actionable recommendations
        - Compliance statement (if applicable)
        - Data quality assessment
        - Appendix (methodology, sources)

    IMPORTANT:
    - Use tools for ALL content generation (don't write manually)
    - Verify all numbers match source data exactly
    - Format professionally for the specified audience
    - Include all required compliance elements
    - Provide clear visualizations and summaries
    - Ensure report is print-ready and presentation-ready

sub_agents:
  sub_agent_count: 0
  # Note: ReportAgent is a consumer agent (receives data from other agents)
  # It consumes output from CarbonAgent, RecommendationAgent, etc.

inputs:
  input_schema:
    type: "object"
    properties:
      format:
        type: "string"
        description: "Report output format"
        enum: ["markdown", "html", "json", "text", "pdf", "excel"]
        default: "text"
        required: true

      carbon_data:
        type: "object"
        description: "Carbon footprint data from CarbonAgent"
        properties:
          total_co2e_kg:
            type: "number"
            description: "Total emissions in kg"
          total_co2e_tons:
            type: "number"
            description: "Total emissions in metric tons"
          emissions_breakdown:
            type: "array"
            description: "Breakdown by source"
          carbon_intensity:
            type: "object"
            description: "Intensity metrics"
          scope_categorization:
            type: "object"
            description: "GHG Protocol scopes"
        required: true

      building_info:
        type: "object"
        description: "Building/facility information"
        properties:
          name:
            type: "string"
          type:
            type: "string"
          area:
            type: "number"
          area_unit:
            type: "string"
          occupancy:
            type: "integer"
          location:
            type: "string"

      period:
        type: "object"
        description: "Reporting period"
        properties:
          start_date:
            type: "string"
            format: "date"
          end_date:
            type: "string"
            format: "date"
          duration:
            type: "number"
          duration_unit:
            type: "string"

      recommendations:
        type: "array"
        description: "Reduction recommendations"
        items:
          type: "object"

      template:
        type: "string"
        description: "Report template style"
        enum: ["standard", "executive", "technical", "compliance"]
        default: "standard"

      compliance_standard:
        type: "string"
        description: "Compliance standard (if applicable)"
        enum: ["ghg_protocol", "cdp", "tcfd", "gri_305", "sasb", "none"]
        default: "none"

      branding:
        type: "object"
        description: "Branding customization"
        properties:
          company_name:
            type: "string"
          logo_url:
            type: "string"
          primary_color:
            type: "string"
          secondary_color:
            type: "string"

      include_charts:
        type: "boolean"
        description: "Include charts and visualizations"
        default: true

      include_recommendations:
        type: "boolean"
        description: "Include recommendations section"
        default: true

      include_data_quality:
        type: "boolean"
        description: "Include data quality assessment"
        default: true

    required: ["format", "carbon_data"]

  example_input:
    format: "markdown"
    carbon_data:
      total_co2e_kg: 26700
      total_co2e_tons: 26.7
      emissions_breakdown:
        - source: "electricity"
          co2e_kg: 15000
          co2e_tons: 15.0
          percentage: 56.18
          scope: 2
        - source: "natural_gas"
          co2e_kg: 8500
          co2e_tons: 8.5
          percentage: 31.84
          scope: 1
        - source: "diesel"
          co2e_kg: 3200
          co2e_tons: 3.2
          percentage: 11.99
          scope: 1
      carbon_intensity:
        per_sqft: 0.534
        per_person: 133.5
      scope_categorization:
        scope_1:
          total_tons: 11.7
          percentage: 43.82
        scope_2:
          total_tons: 15.0
          percentage: 56.18
    building_info:
      name: "Headquarters Office"
      type: "office"
      area: 50000
      area_unit: "sqft"
      occupancy: 200
      location: "San Francisco, CA"
    period:
      start_date: "2024-01-01"
      end_date: "2024-12-31"
      duration: 12
      duration_unit: "month"
    recommendations:
      - priority: "high"
        source: "electricity"
        action: "Install solar PV system"
        potential_reduction: "Up to 56% reduction"
    template: "standard"
    include_charts: true
    include_recommendations: true

outputs:
  output_schema:
    type: "object"
    properties:
      report:
        type: "string"
        description: "Formatted report content (for text-based formats)"

      report_data:
        type: "object"
        description: "Structured report data (for JSON format)"

      format:
        type: "string"
        description: "Output format used"

      generated_at:
        type: "string"
        description: "ISO 8601 timestamp"

      metadata:
        type: "object"
        description: "Report metadata"
        properties:
          agent:
            type: "string"
          report_format:
            type: "string"
          page_count:
            type: "integer"
          chart_count:
            type: "integer"

  example_output:
    report: |
      # Carbon Footprint Report

      ## Executive Summary
      This 50,000 sqft office building generated 26.7 metric tons of CO2e emissions
      during the 2024 reporting period...

      ## Emissions Breakdown
      | Source | Emissions (kg) | Emissions (tons) | Percentage | Scope |
      |--------|----------------|------------------|------------|-------|
      | electricity | 15,000 | 15.0 | 56.18% | 2 |
      | natural_gas | 8,500 | 8.5 | 31.84% | 1 |
      | diesel | 3,200 | 3.2 | 11.99% | 1 |

      ## Recommendations
      1. **High Priority**: Install solar PV system (potential 56% reduction)
      2. **Medium Priority**: Switch to heat pumps (potential 50-70% reduction)

      ---
      *Report generated on 2025-10-13T10:30:00Z by GreenLang ReportAgent*
    format: "markdown"
    generated_at: "2025-10-13T10:30:00Z"
    metadata:
      agent: "ReportAgent"
      report_format: "markdown"
      page_count: 1
      chart_count: 0

testing:
  test_coverage_target: 0.85

  test_categories:
    - category: "unit_tests"
      description: "Test individual tool implementations (all 10 tools)"
      count: "30+"

    - category: "integration_tests"
      description: "Test complete report generation workflows for all formats"
      count: "12+"

    - category: "determinism_tests"
      description: "Verify same input produces same output across formats"
      count: "5+"

    - category: "boundary_tests"
      description: "Test edge cases (empty data, missing fields, large datasets)"
      count: "15+"

    - category: "performance_tests"
      description: "Verify report generation latency and resource usage"
      count: "3+"

  performance_requirements:
    max_latency_ms: 3000
    max_cost_usd: 0.50
    accuracy_target: 1.0  # 100% accuracy for data formatting

deployment:
  pack_id: "core/reporting_pack"
  pack_version: "1.0.0"

  dependencies:
    python_packages:
      - "pydantic>=2.0"
      - "typing-extensions>=4.5"
      - "markdown>=3.4"

    greenlang_modules:
      - "greenlang.agents.base"
      - "greenlang.agents.report_agent"
      - "greenlang.intelligence"

  resource_requirements:
    memory_mb: 512
    cpu_cores: 1
    gpu_required: false

  api_endpoints:
    - endpoint: "/api/v1/agents/report/generate"
      method: "POST"
      authentication: "required"

    - endpoint: "/api/v1/agents/report/export/pdf"
      method: "POST"
      authentication: "required"

    - endpoint: "/api/v1/agents/report/export/excel"
      method: "POST"
      authentication: "required"

documentation:
  readme: true
  api_docs: true
  examples: true
  tutorials: true

  example_use_cases:
    - title: "Executive Board Presentation"
      description: "Generate executive-level PDF report for board meeting"
      input_example:
        format: "pdf"
        template: "executive"
        carbon_data: {...}
        building_info: {...}
      output_summary: "Professional PDF with executive summary, charts, and key recommendations"

    - title: "CDP Climate Change Questionnaire"
      description: "Generate CDP-compliant report for annual submission"
      input_example:
        format: "excel"
        compliance_standard: "cdp"
        template: "compliance"
      output_summary: "Excel workbook with CDP questionnaire responses pre-filled"

    - title: "Monthly Operations Report"
      description: "Generate monthly markdown report for internal distribution"
      input_example:
        format: "markdown"
        template: "standard"
        period:
          duration: 1
          duration_unit: "month"
      output_summary: "Markdown report with monthly emissions summary and trends"

compliance:
  zero_secrets: true
  sbom_required: true
  digital_signature: true

  standards:
    - "GHG Protocol Corporate Standard"
    - "CDP Climate Change Questionnaire"
    - "TCFD Framework (Task Force on Climate-related Financial Disclosures)"
    - "GRI 305: Emissions (Global Reporting Initiative)"
    - "SASB (Sustainability Accounting Standards Board)"
    - "SEC Climate Disclosure Rules"

  certifications:
    - "GHG Protocol Compliant Reporting"
    - "CDP Reporting Compatible"
    - "TCFD Aligned"

business_impact:
  market_opportunity:
    addressable_market_usd: 3500000000
    market_segment: "Sustainability reporting, ESG disclosure, regulatory compliance"
    target_customers: "Public companies, large enterprises, regulated entities"
    growth_rate: "20% CAGR"

  carbon_impact:
    direct_impact: "Enables transparent sustainability reporting and stakeholder communication"
    indirect_impact: "Drives accountability and accelerates corporate climate action"
    scaling_potential: "All organizations with sustainability reporting requirements"

  economic_value:
    time_savings: "95% reduction in report generation time (hours to minutes)"
    cost_savings: "Reduces consultant and manual labor costs by 80%"
    compliance_value: "Automated compliance reduces regulatory risk and audit costs"
    competitive_advantage: "Faster, higher-quality reporting vs. manual methods"

metadata:
  created_date: "2025-10-13"
  created_by: "Claude (AI Assistant)"
  last_modified: "2025-10-13"
  review_status: "Draft"
  reviewers: []

  change_log:
    - version: "1.0.0"
      date: "2025-10-13"
      changes: |
        Initial specification created for ReportAgent / ReportAgentAI
        - Comprehensive 10-tool suite for report generation
        - Multi-format support (PDF, HTML, Excel, JSON, Markdown, Text)
        - Compliance reporting (GHG Protocol, CDP, TCFD, GRI, SASB)
        - Executive summaries and visualizations
        - Trend analysis and comparisons
        - Data quality assessment
        - Full AI integration with deterministic base
        - Production-ready test coverage plan (85%+)
      author: "Claude (AI Assistant)"

# END OF REPORT AGENT SPECIFICATION
# Production Ready for Agent Factory Generation
# Base: ReportAgent (deterministic) | AI: ReportAgentAI (intelligent narratives)
# Target Coverage: 85%+ (currently 5.17% - needs comprehensive testing)
