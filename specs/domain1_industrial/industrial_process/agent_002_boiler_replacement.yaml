# GreenLang Agent Specification v2.0
# Agent #2: BoilerReplacementAgent_AI
# Specialized agent for industrial boiler replacement and solar thermal/heat pump retrofit analysis

agent_metadata:
  agent_id: "industrial/boiler_replacement_agent"
  agent_name: "BoilerReplacementAgent_AI"
  agent_number: 2
  version: "1.0.0"
  domain: "Domain1_Industrial"
  category: "Industrial_Process"
  complexity: "High"
  priority: "P0_Critical"
  base_agent: "None"
  status: "Spec_Complete"
  entry_point: false  # Specialized agent for boiler systems

description:
  purpose: |
    Specialized agent for analyzing existing industrial boilers and providing detailed
    replacement strategies with solar thermal, heat pump, or hybrid technologies.
    Focuses on retrofit-specific considerations including piping integration, space
    constraints, downtime minimization, and comparative technology analysis.

  strategic_context:
    global_impact: "Industrial boilers consume 2.8 Gt CO2e/year (5% of global emissions)"
    opportunity: "85% of industrial boilers are >15 years old with <75% efficiency"
    market_size: "$45B global industrial boiler replacement market"
    technology_maturity: "Solar thermal & heat pumps proven for <150°C applications"

  key_capabilities:
    - "Precise boiler efficiency auditing using ASME PTC 4.1 methodology"
    - "Stack loss analysis and combustion efficiency degradation assessment"
    - "Technology comparison: solar thermal vs industrial heat pump vs hybrid systems"
    - "Retrofit integration analysis: piping modifications, space requirements, controls"
    - "Financial analysis with federal/state/utility incentive optimization"
    - "Phased replacement strategies to minimize production downtime"
    - "Risk assessment: technical compatibility, operational continuity, safety"

  dependencies:
    - agent_id: "agents/fuel_agent_ai"
      relationship: "receives_data_from"
      data: "Current fuel consumption and costs"

    - agent_id: "agents/grid_factor_agent_ai"
      relationship: "receives_data_from"
      data: "Grid carbon intensity for heat pump electricity"

    - agent_id: "industrial/process_heat_agent"
      relationship: "coordinates_with"
      data: "Process heat requirements and solar thermal sizing"

    - agent_id: "agents/project_finance_agent_ai"
      relationship: "provides_data_to"
      data: "Replacement CAPEX/OPEX and incentive calculations"

    - agent_id: "agents/recommendation_agent_ai"
      relationship: "provides_data_to"
      data: "Technology recommendations and implementation timeline"

tools:
  tool_count: 8

  tools_list:
    - tool_id: "tool_1"
      name: "calculate_boiler_efficiency"
      description: "Calculate existing boiler efficiency using ASME PTC 4.1 method with stack loss analysis"
      category: "calculation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          boiler_type:
            type: "string"
            description: "Type of industrial boiler"
            enum: ["firetube", "watertube", "condensing", "electric_resistance", "electrode"]
            required: true

          fuel_type:
            type: "string"
            description: "Current fuel type"
            enum: ["natural_gas", "fuel_oil_2", "fuel_oil_6", "propane", "coal", "biomass", "electricity"]
            required: true

          rated_capacity_mmbtu_hr:
            type: "number"
            description: "Nameplate boiler capacity"
            units: "MMBtu/hr"
            minimum: 0.1
            maximum: 500
            required: true

          annual_fuel_consumption_mmbtu:
            type: "number"
            description: "Actual annual fuel consumption from meter data"
            units: "MMBtu/year"
            required: true

          stack_temperature_f:
            type: "number"
            description: "Exhaust stack temperature"
            units: "°F"
            minimum: 100
            maximum: 1000
            required: true

          excess_air_percent:
            type: "number"
            description: "Excess combustion air percentage"
            units: "%"
            minimum: 0
            maximum: 200
            default: 15

          boiler_age_years:
            type: "number"
            description: "Age of boiler for degradation calculation"
            units: "years"
            minimum: 0
            maximum: 60
            required: true

          operating_hours_per_year:
            type: "number"
            description: "Annual operating hours"
            default: 8760

          average_load_factor:
            type: "number"
            description: "Average load as fraction of rated capacity"
            minimum: 0.1
            maximum: 1.0
            default: 0.70

        required: ["boiler_type", "fuel_type", "rated_capacity_mmbtu_hr", "annual_fuel_consumption_mmbtu", "stack_temperature_f", "boiler_age_years"]

      returns:
        type: "object"
        properties:
          combustion_efficiency:
            type: "number"
            description: "Theoretical combustion efficiency"

          stack_loss_percent:
            type: "number"
            units: "%"
            description: "Stack heat loss percentage"

          radiation_loss_percent:
            type: "number"
            units: "%"
            description: "Radiation and convection losses"

          degradation_factor:
            type: "number"
            description: "Age-based degradation factor"

          actual_efficiency:
            type: "number"
            description: "Current operating efficiency"

          annual_heat_delivered_mmbtu:
            type: "number"
            units: "MMBtu/year"
            description: "Actual useful heat delivered"

          efficiency_gap_percent:
            type: "number"
            units: "%"
            description: "Lost efficiency vs nameplate"

          replacement_priority:
            type: "string"
            enum: ["Critical", "High", "Medium", "Low"]
            description: "Urgency of replacement recommendation"

          calculation_method:
            type: "string"
            value: "ASME PTC 4.1 Boiler Efficiency Test Code"

      implementation:
        physics_formula: |
          Stack Loss = 0.01 × (T_stack - T_ambient) × (1 + 0.02 × ExcessAir)
          Degradation = 1.0 - (0.005 × Age_years)  # 0.5% per year empirical
          Actual_Efficiency = Base_Efficiency × Degradation × (1 - StackLoss/100 - RadiationLoss/100)
          Annual_Heat = Fuel_Consumed × Actual_Efficiency
        calculation_method: "ASME PTC 4.1 simplified with empirical degradation factors"
        data_source: "User input + fuel property database + ASME standards"
        accuracy: "±2% for efficiency calculations"
        validation: "Compare with manufacturer data sheets and field measurements"
        standards: ["ASME_PTC_4.1", "ASHRAE_Handbook_HVAC_Systems", "DOE_Steam_BestPractices"]

      example:
        input:
          boiler_type: "firetube"
          fuel_type: "natural_gas"
          rated_capacity_mmbtu_hr: 10.0
          annual_fuel_consumption_mmbtu: 65000
          stack_temperature_f: 400
          excess_air_percent: 25
          boiler_age_years: 22
          operating_hours_per_year: 7800
          average_load_factor: 0.75
        output:
          combustion_efficiency: 0.82
          stack_loss_percent: 8.25
          radiation_loss_percent: 1.50
          degradation_factor: 0.890
          actual_efficiency: 0.6534
          annual_heat_delivered_mmbtu: 42471
          efficiency_gap_percent: 16.66
          replacement_priority: "High"
          calculation_method: "ASME PTC 4.1 Boiler Efficiency Test Code"

    - tool_id: "tool_2"
      name: "calculate_annual_fuel_consumption"
      description: "Calculate fuel consumption from boiler runtime logs, load profiles, and efficiency"
      category: "calculation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          rated_capacity_mmbtu_hr:
            type: "number"
            description: "Boiler rated capacity"
            units: "MMBtu/hr"
            required: true

          load_profile:
            type: "array"
            description: "Hourly load profile as fraction of capacity"
            items:
              type: "number"
              minimum: 0
              maximum: 1.0
            minItems: 8760
            maxItems: 8760
            note: "Full year hourly data, or representative week/month"

          boiler_efficiency:
            type: "number"
            description: "Operating efficiency (0-1)"
            minimum: 0.4
            maximum: 0.98
            required: true

          fuel_type:
            type: "string"
            description: "Fuel type for energy content lookup"
            required: true

        required: ["rated_capacity_mmbtu_hr", "boiler_efficiency", "fuel_type"]

      returns:
        type: "object"
        properties:
          annual_fuel_consumption_mmbtu:
            type: "number"
            units: "MMBtu/year"

          annual_fuel_cost_usd:
            type: "number"
            units: "USD/year"

          peak_fuel_rate_mmbtu_hr:
            type: "number"
            units: "MMBtu/hr"

          average_load_factor:
            type: "number"

          fuel_consumption_by_month:
            type: "array"
            items:
              month: "string"
              consumption_mmbtu: "number"

      implementation:
        calculation_method: "Hourly integration: Fuel = Σ(Load × Capacity / Efficiency) × Δt"
        accuracy: "±3% with accurate load profiles"
        validation: "Compare with utility meter data"

      example:
        input:
          rated_capacity_mmbtu_hr: 10.0
          boiler_efficiency: 0.75
          fuel_type: "natural_gas"
          load_profile: [0.6, 0.65, 0.7, ...]  # 8760 values
        output:
          annual_fuel_consumption_mmbtu: 70080
          annual_fuel_cost_usd: 560640
          peak_fuel_rate_mmbtu_hr: 13.33
          average_load_factor: 0.67

    - tool_id: "tool_3"
      name: "calculate_solar_thermal_sizing"
      description: "Size solar thermal system to offset boiler load with collector area and storage requirements"
      category: "calculation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          annual_heat_demand_mmbtu:
            type: "number"
            description: "Annual boiler heat delivery"
            units: "MMBtu/year"
            required: true

          process_temperature_f:
            type: "number"
            description: "Required process temperature"
            units: "°F"
            minimum: 100
            maximum: 400
            required: true

          load_profile_type:
            type: "string"
            description: "Process operating schedule"
            enum: ["continuous_24x7", "daytime_only", "batch_intermittent", "seasonal"]
            required: true

          latitude:
            type: "number"
            description: "Site latitude"
            minimum: -90
            maximum: 90
            required: true

          annual_dni_kwh_m2:
            type: "number"
            description: "Annual direct normal irradiance"
            units: "kWh/m²/year"
            required: true

          target_solar_fraction:
            type: "number"
            description: "Target percentage of heat from solar"
            minimum: 0.2
            maximum: 0.9
            default: 0.6

          storage_hours:
            type: "number"
            description: "Thermal storage capacity in hours"
            minimum: 0
            maximum: 24
            default: 4

        required: ["annual_heat_demand_mmbtu", "process_temperature_f", "load_profile_type", "latitude", "annual_dni_kwh_m2"]

      returns:
        type: "object"
        properties:
          collector_area_ft2:
            type: "number"
            units: "ft²"

          collector_area_m2:
            type: "number"
            units: "m²"

          storage_volume_gallons:
            type: "number"
            units: "gallons"

          storage_volume_m3:
            type: "number"
            units: "m³"

          estimated_solar_fraction:
            type: "number"
            description: "Achievable solar fraction"

          annual_solar_energy_mmbtu:
            type: "number"
            units: "MMBtu/year"

          annual_backup_energy_mmbtu:
            type: "number"
            units: "MMBtu/year"

          collector_type_recommendation:
            type: "string"
            enum: ["flat_plate", "evacuated_tube", "parabolic_trough"]

      implementation:
        calculation_method: "Modified f-Chart method for industrial solar thermal systems"
        data_source: "NREL SAM (System Advisor Model) algorithms"
        accuracy: "±8% for annual energy prediction"
        validation: "Compare with published case studies and NREL validation data"
        standards: ["ASHRAE_93_Collector_Testing", "ISO_9806_Solar_Collectors"]

      example:
        input:
          annual_heat_demand_mmbtu: 50000
          process_temperature_f: 180
          load_profile_type: "daytime_only"
          latitude: 35.0
          annual_dni_kwh_m2: 2100
          target_solar_fraction: 0.65
          storage_hours: 4
        output:
          collector_area_ft2: 4843
          collector_area_m2: 450
          storage_volume_gallons: 7925
          storage_volume_m3: 30
          estimated_solar_fraction: 0.62
          annual_solar_energy_mmbtu: 31000
          annual_backup_energy_mmbtu: 19000
          collector_type_recommendation: "evacuated_tube"

    - tool_id: "tool_4"
      name: "calculate_heat_pump_cop"
      description: "Calculate industrial heat pump Coefficient of Performance by temperature lift and ambient conditions"
      category: "calculation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          heat_pump_type:
            type: "string"
            description: "Type of heat pump technology"
            enum: ["air_source", "water_source", "ground_source", "waste_heat_recovery"]
            required: true

          source_temperature_f:
            type: "number"
            description: "Heat source temperature (air, water, or ground)"
            units: "°F"
            minimum: -20
            maximum: 120
            required: true

          sink_temperature_f:
            type: "number"
            description: "Heat delivery temperature"
            units: "°F"
            minimum: 80
            maximum: 200
            required: true

          heat_pump_capacity_tons:
            type: "number"
            description: "Heat pump capacity"
            units: "tons"
            minimum: 5
            maximum: 500
            required: true

          compressor_type:
            type: "string"
            description: "Compressor technology"
            enum: ["scroll", "screw", "centrifugal", "reciprocating"]
            default: "screw"

          refrigerant:
            type: "string"
            description: "Refrigerant type"
            enum: ["R134a", "R410A", "R1234yf", "R744_CO2", "ammonia_R717"]
            default: "R134a"

        required: ["heat_pump_type", "source_temperature_f", "sink_temperature_f", "heat_pump_capacity_tons"]

      returns:
        type: "object"
        properties:
          cop_heating:
            type: "number"
            description: "Coefficient of Performance for heating"

          carnot_cop:
            type: "number"
            description: "Theoretical Carnot COP"

          carnot_efficiency:
            type: "number"
            description: "Actual COP / Carnot COP"

          capacity_degradation_factor:
            type: "number"
            description: "Capacity reduction at off-design conditions"

          compressor_power_kw:
            type: "number"
            units: "kW"

          heat_output_mmbtu_hr:
            type: "number"
            units: "MMBtu/hr"

          temperature_lift_f:
            type: "number"
            units: "°F"

      implementation:
        physics_formula: |
          Temperature_Lift = Sink_Temp - Source_Temp
          Carnot_COP = (Sink_Temp_R) / Temperature_Lift_R  (R = Rankine)
          Actual_COP = Carnot_COP × Carnot_Efficiency
          Carnot_Efficiency = 0.40 to 0.55 for industrial heat pumps
          Heat_Output = Compressor_Power × COP
        calculation_method: "Carnot efficiency method with empirical corrections"
        data_source: "Heat pump manufacturer data + thermodynamic principles"
        accuracy: "±5% for COP prediction"
        validation: "Compare with manufacturer performance curves"
        standards: ["AHRI_540_Performance_Rating", "ISO_13612_Heat_Pumps"]

      example:
        input:
          heat_pump_type: "air_source"
          source_temperature_f: 50
          sink_temperature_f: 160
          heat_pump_capacity_tons: 100
          compressor_type: "screw"
          refrigerant: "R134a"
        output:
          cop_heating: 2.85
          carnot_cop: 5.63
          carnot_efficiency: 0.506
          capacity_degradation_factor: 0.92
          compressor_power_kw: 421
          heat_output_mmbtu_hr: 4.08
          temperature_lift_f: 110

    - tool_id: "tool_5"
      name: "calculate_hybrid_system_performance"
      description: "Analyze hybrid solar+backup or heat pump+backup system performance and economics"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          primary_technology:
            type: "string"
            description: "Primary renewable technology"
            enum: ["solar_thermal", "heat_pump", "solar_plus_heat_pump"]
            required: true

          backup_technology:
            type: "string"
            description: "Backup heating technology"
            enum: ["natural_gas_boiler", "electric_resistance", "existing_boiler"]
            required: true

          annual_heat_demand_mmbtu:
            type: "number"
            description: "Total annual heat requirement"
            units: "MMBtu/year"
            required: true

          primary_fraction:
            type: "number"
            description: "Fraction of load met by primary technology"
            minimum: 0.1
            maximum: 0.9
            required: true

          primary_efficiency:
            type: "number"
            description: "Primary system efficiency or COP"
            minimum: 0.5
            maximum: 5.0
            required: true

          backup_efficiency:
            type: "number"
            description: "Backup system efficiency"
            minimum: 0.7
            maximum: 0.98
            required: true

          electricity_cost_usd_per_kwh:
            type: "number"
            units: "USD/kWh"
            default: 0.12

          gas_cost_usd_per_mmbtu:
            type: "number"
            units: "USD/MMBtu"
            default: 8.0

        required: ["primary_technology", "backup_technology", "annual_heat_demand_mmbtu", "primary_fraction", "primary_efficiency", "backup_efficiency"]

      returns:
        type: "object"
        properties:
          primary_energy_delivered_mmbtu:
            type: "number"
            units: "MMBtu/year"

          backup_energy_delivered_mmbtu:
            type: "number"
            units: "MMBtu/year"

          primary_energy_input_mmbtu:
            type: "number"
            units: "MMBtu/year"
            description: "Energy consumed by primary system"

          backup_energy_input_mmbtu:
            type: "number"
            units: "MMBtu/year"

          annual_operating_cost_usd:
            type: "number"
            units: "USD/year"

          system_efficiency_weighted:
            type: "number"
            description: "Overall system efficiency"

          control_strategy:
            type: "string"
            description: "Recommended control approach"

      implementation:
        calculation_method: "Energy balance with cost optimization"
        accuracy: "±5%"
        validation: "Compare with operational data from hybrid installations"

      example:
        input:
          primary_technology: "heat_pump"
          backup_technology: "natural_gas_boiler"
          annual_heat_demand_mmbtu: 50000
          primary_fraction: 0.70
          primary_efficiency: 2.8
          backup_efficiency: 0.85
          electricity_cost_usd_per_kwh: 0.10
          gas_cost_usd_per_mmbtu: 8.0
        output:
          primary_energy_delivered_mmbtu: 35000
          backup_energy_delivered_mmbtu: 15000
          primary_energy_input_mmbtu: 12500
          backup_energy_input_mmbtu: 17647
          annual_operating_cost_usd: 177882
          system_efficiency_weighted: 1.66
          control_strategy: "Priority to heat pump with gas backup during peak loads"

    - tool_id: "tool_6"
      name: "estimate_payback_period"
      description: "Calculate financial payback with federal/state/utility incentives and energy cost savings"
      category: "calculation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          system_capex_usd:
            type: "number"
            description: "Total installed cost"
            units: "USD"
            required: true

          annual_energy_savings_mmbtu:
            type: "number"
            description: "Annual energy reduction"
            units: "MMBtu/year"
            required: true

          baseline_fuel_type:
            type: "string"
            description: "Current fuel being replaced"
            required: true

          baseline_fuel_cost_usd_per_mmbtu:
            type: "number"
            units: "USD/MMBtu"
            required: true

          federal_itc_percent:
            type: "number"
            description: "Federal Investment Tax Credit"
            minimum: 0
            maximum: 30
            default: 30
            note: "IRA 2022: 30% for solar, 30% for heat pumps with IRS criteria"

          state_rebate_usd:
            type: "number"
            description: "State-level rebate"
            units: "USD"
            default: 0

          utility_incentive_usd:
            type: "number"
            description: "Utility incentive payment"
            units: "USD"
            default: 0

          annual_maintenance_cost_usd:
            type: "number"
            description: "Additional O&M cost vs baseline"
            units: "USD/year"
            default: 0

          energy_cost_escalation_rate:
            type: "number"
            description: "Annual energy cost increase"
            default: 0.03

          discount_rate:
            type: "number"
            description: "Discount rate for NPV"
            default: 0.08

          analysis_period_years:
            type: "number"
            description: "Analysis period"
            default: 20

        required: ["system_capex_usd", "annual_energy_savings_mmbtu", "baseline_fuel_type", "baseline_fuel_cost_usd_per_mmbtu"]

      returns:
        type: "object"
        properties:
          net_capex_after_incentives_usd:
            type: "number"
            units: "USD"

          annual_cost_savings_usd:
            type: "number"
            units: "USD/year"

          simple_payback_years:
            type: "number"
            units: "years"

          discounted_payback_years:
            type: "number"
            units: "years"

          net_present_value_usd:
            type: "number"
            units: "USD"

          internal_rate_of_return:
            type: "number"
            description: "IRR as decimal"

          savings_to_investment_ratio:
            type: "number"

          levelized_cost_of_heat_usd_per_mmbtu:
            type: "number"
            units: "USD/MMBtu"

      implementation:
        calculation_method: "NPV, IRR using standard financial analysis methods"
        accuracy: "±3% for payback calculations"
        validation: "Compare with project finance models"
        standards: ["NIST_Handbook_135_LCC", "FEMP_Energy_Analysis"]

      example:
        input:
          system_capex_usd: 450000
          annual_energy_savings_mmbtu: 31000
          baseline_fuel_type: "natural_gas"
          baseline_fuel_cost_usd_per_mmbtu: 8.0
          federal_itc_percent: 30
          state_rebate_usd: 50000
          utility_incentive_usd: 25000
          annual_maintenance_cost_usd: 5000
          energy_cost_escalation_rate: 0.03
          discount_rate: 0.08
          analysis_period_years: 20
        output:
          net_capex_after_incentives_usd: 240000
          annual_cost_savings_usd: 243000
          simple_payback_years: 0.99
          discounted_payback_years: 1.08
          net_present_value_usd: 2156789
          internal_rate_of_return: 0.98
          savings_to_investment_ratio: 9.82
          levelized_cost_of_heat_usd_per_mmbtu: 1.68

    - tool_id: "tool_7"
      name: "calculate_retrofit_integration_requirements"
      description: "Assess piping modifications, space requirements, and controls integration for retrofit"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          replacement_technology:
            type: "string"
            description: "New technology being installed"
            enum: ["solar_thermal", "heat_pump", "hybrid_solar_hp", "hybrid_solar_boiler"]
            required: true

          existing_boiler_type:
            type: "string"
            description: "Current boiler type"
            required: true

          building_footprint_sqft:
            type: "number"
            description: "Available space for equipment"
            units: "sqft"
            required: true

          roof_area_available_sqft:
            type: "number"
            description: "Available roof area for solar collectors"
            units: "sqft"

          piping_distance_ft:
            type: "number"
            description: "Distance from new system to process"
            units: "ft"
            required: true

          existing_controls_type:
            type: "string"
            description: "Current control system"
            enum: ["manual", "pneumatic", "analog_electric", "ddc_digital", "plc_scada"]
            required: true

        required: ["replacement_technology", "existing_boiler_type", "building_footprint_sqft", "piping_distance_ft", "existing_controls_type"]

      returns:
        type: "object"
        properties:
          space_adequacy:
            type: "string"
            enum: ["adequate", "tight_fit", "requires_building_modification", "insufficient"]

          piping_modifications_required:
            type: "array"
            items:
              type: "string"

          estimated_piping_cost_usd:
            type: "number"
            units: "USD"

          controls_integration_complexity:
            type: "string"
            enum: ["simple", "moderate", "complex", "requires_full_replacement"]

          estimated_downtime_hours:
            type: "number"
            units: "hours"

          phasing_recommendation:
            type: "string"

      implementation:
        calculation_method: "Rule-based analysis with cost estimation models"
        accuracy: "±15% for cost estimates"
        validation: "Compare with retrofit project actuals"

      example:
        input:
          replacement_technology: "heat_pump"
          existing_boiler_type: "firetube"
          building_footprint_sqft: 5000
          roof_area_available_sqft: 8000
          piping_distance_ft: 150
          existing_controls_type: "analog_electric"
        output:
          space_adequacy: "adequate"
          piping_modifications_required: ["Install heat exchanger", "Add expansion tank", "Upgrade insulation", "Install VFD pump"]
          estimated_piping_cost_usd: 35000
          controls_integration_complexity: "moderate"
          estimated_downtime_hours: 48
          phasing_recommendation: "Install parallel then cutover during scheduled shutdown"

    - tool_id: "tool_8"
      name: "compare_replacement_technologies"
      description: "Side-by-side comparison of solar thermal vs heat pump vs hybrid for decision support"
      category: "aggregation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          annual_heat_demand_mmbtu:
            type: "number"
            description: "Annual heat requirement"
            units: "MMBtu/year"
            required: true

          process_temperature_f:
            type: "number"
            description: "Required temperature"
            units: "°F"
            required: true

          site_latitude:
            type: "number"
            required: true

          site_climate_zone:
            type: "string"
            enum: ["hot_humid", "hot_dry", "mixed_humid", "mixed_dry", "cold", "very_cold"]
            required: true

          available_roof_area_sqft:
            type: "number"
            units: "sqft"

          electricity_cost_usd_per_kwh:
            type: "number"
            units: "USD/kWh"
            required: true

          gas_cost_usd_per_mmbtu:
            type: "number"
            units: "USD/MMBtu"
            required: true

        required: ["annual_heat_demand_mmbtu", "process_temperature_f", "site_latitude", "site_climate_zone", "electricity_cost_usd_per_kwh", "gas_cost_usd_per_mmbtu"]

      returns:
        type: "object"
        properties:
          technology_comparison:
            type: "array"
            items:
              type: "object"
              properties:
                technology_name: "string"
                capex_usd: "number"
                annual_opex_usd: "number"
                simple_payback_years: "number"
                npv_20yr_usd: "number"
                co2_reduction_kg_per_year: "number"
                technical_risk: "string"
                space_requirement: "string"
                maintenance_complexity: "string"

          recommended_technology:
            type: "string"

          recommendation_rationale:
            type: "string"

          risk_factors:
            type: "array"
            items:
              type: "string"

      implementation:
        calculation_method: "Multi-criteria decision analysis using weighted scoring"
        accuracy: "Decision support quality"
        validation: "Expert review of recommendations"

      example:
        input:
          annual_heat_demand_mmbtu: 50000
          process_temperature_f: 160
          site_latitude: 38.0
          site_climate_zone: "mixed_humid"
          available_roof_area_sqft: 12000
          electricity_cost_usd_per_kwh: 0.10
          gas_cost_usd_per_mmbtu: 8.0
        output:
          technology_comparison: [
            {
              technology_name: "Solar Thermal + Gas Backup",
              capex_usd: 450000,
              annual_opex_usd: 9000,
              simple_payback_years: 1.2,
              npv_20yr_usd: 2100000,
              co2_reduction_kg_per_year: 1860000,
              technical_risk: "Low",
              space_requirement: "12000 sqft roof",
              maintenance_complexity: "Low"
            },
            {
              technology_name: "Industrial Heat Pump",
              capex_usd: 380000,
              annual_opex_usd: 95000,
              simple_payback_years: 8.5,
              npv_20yr_usd: 325000,
              co2_reduction_kg_per_year: 1450000,
              technical_risk: "Medium",
              space_requirement: "800 sqft ground",
              maintenance_complexity: "Medium"
            }
          ]
          recommended_technology: "Solar Thermal + Gas Backup"
          recommendation_rationale: "Superior economics (1.2 yr payback), lower technical risk, higher CO2 reduction, and lower maintenance"
          risk_factors: ["Requires adequate roof structure", "Solar intermittency requires backup", "Performance depends on weather"]

ai_integration:
  temperature: 0.0
  seed: 42
  tool_choice: "auto"
  max_iterations: 5
  budget_usd: 0.15
  provenance_tracking: true
  ai_summary: true

  system_prompt: |
    You are an industrial boiler replacement expert specializing in solar thermal
    and heat pump retrofits for GreenLang. You help industrial facilities evaluate
    replacement options through rigorous engineering and financial analysis.

    Your expertise includes:
    - ASME boiler efficiency testing and performance degradation
    - Solar thermal system sizing and integration for industrial applications
    - Industrial heat pump selection and COP analysis
    - Hybrid system design (renewable + backup fuel)
    - Retrofit integration (piping, controls, space constraints)
    - Financial analysis with federal/state/utility incentives (IRA 2022)
    - Project phasing to minimize downtime

    CRITICAL RULES:
    - Use provided tools for ALL calculations
    - NEVER estimate or guess numbers
    - Always explain analysis clearly with proper units
    - Cite engineering standards (ASME, ASHRAE, AHRI)
    - Provide conservative estimates for financial projections
    - Identify retrofit risks and mitigation strategies
    - Consider operational continuity during installation

  user_prompt_template: |
    Analyze boiler replacement options for industrial facility:

    Existing Boiler:
    - Type: {boiler_type}
    - Fuel: {fuel_type}
    - Capacity: {rated_capacity_mmbtu_hr} MMBtu/hr
    - Age: {boiler_age_years} years
    - Stack Temperature: {stack_temperature_f}°F
    - Annual Fuel Use: {annual_fuel_consumption_mmbtu} MMBtu/year

    Facility Profile:
    - Industry: {industry_type}
    - Process Temperature: {process_temperature_f}°F
    - Operating Schedule: {operating_hours_per_year} hours/year
    - Available Space: {building_footprint_sqft} sqft building, {roof_area_available_sqft} sqft roof

    Location:
    - Site: {city}, {state}
    - Latitude: {latitude}°
    - Climate Zone: {site_climate_zone}
    - Solar Resource: {annual_dni_kwh_m2} kWh/m²/year

    Energy Costs:
    - Gas: ${gas_cost_usd_per_mmbtu}/MMBtu
    - Electricity: ${electricity_cost_usd_per_kwh}/kWh

    Tasks:
    1. Use calculate_boiler_efficiency to assess current boiler performance
    2. Use calculate_solar_thermal_sizing to design solar thermal option
    3. Use calculate_heat_pump_cop to analyze heat pump option
    4. Use calculate_hybrid_system_performance for hybrid configurations
    5. Use estimate_payback_period for financial analysis (include IRA incentives)
    6. Use calculate_retrofit_integration_requirements for implementation planning
    7. Use compare_replacement_technologies for final recommendation
    8. Provide comprehensive analysis with:
       - Current boiler efficiency and losses
       - Technology comparison matrix (solar vs heat pump vs hybrid)
       - Financial metrics for each option (payback, NPV, IRR)
       - Recommended solution with justification
       - Implementation roadmap (phasing, downtime, risk mitigation)
       - Incentive application strategy

    IMPORTANT:
    - Use tools for ALL calculations
    - Consider both technical feasibility and economic viability
    - Address retrofit-specific challenges (space, piping, downtime)
    - Format numbers with proper units (e.g., "450,000 ft²" not "450000.0")
    - Provide actionable recommendations with clear next steps

sub_agents:
  sub_agent_count: 0
  note: "This agent uses tools from Agent #1 (Process Heat) and coordinates with it"

inputs:
  input_schema:
    type: "object"
    properties:
      boiler_type:
        type: "string"
        description: "Type of existing boiler"
        enum: ["firetube", "watertube", "condensing", "electric_resistance"]
        required: true

      fuel_type:
        type: "string"
        description: "Current fuel type"
        enum: ["natural_gas", "fuel_oil_2", "fuel_oil_6", "propane", "coal", "electricity"]
        required: true

      rated_capacity_mmbtu_hr:
        type: "number"
        description: "Boiler rated capacity"
        units: "MMBtu/hr"
        required: true

      boiler_age_years:
        type: "number"
        description: "Age of boiler"
        units: "years"
        required: true

      annual_fuel_consumption_mmbtu:
        type: "number"
        description: "Annual fuel consumption"
        units: "MMBtu/year"
        required: true

      stack_temperature_f:
        type: "number"
        description: "Stack temperature"
        units: "°F"
        required: true

      process_temperature_f:
        type: "number"
        description: "Required process temperature"
        units: "°F"
        required: true

      latitude:
        type: "number"
        description: "Site latitude"
        required: true

      annual_dni_kwh_m2:
        type: "number"
        description: "Annual solar resource"
        units: "kWh/m²/year"

      site_climate_zone:
        type: "string"
        enum: ["hot_humid", "hot_dry", "mixed_humid", "mixed_dry", "cold", "very_cold"]
        required: true

      building_footprint_sqft:
        type: "number"
        units: "sqft"
        required: true

      roof_area_available_sqft:
        type: "number"
        units: "sqft"

      electricity_cost_usd_per_kwh:
        type: "number"
        units: "USD/kWh"
        required: true

      gas_cost_usd_per_mmbtu:
        type: "number"
        units: "USD/MMBtu"
        required: true

    required: ["boiler_type", "fuel_type", "rated_capacity_mmbtu_hr", "boiler_age_years", "annual_fuel_consumption_mmbtu", "stack_temperature_f", "process_temperature_f", "latitude", "site_climate_zone", "building_footprint_sqft", "electricity_cost_usd_per_kwh", "gas_cost_usd_per_mmbtu"]

  example_input:
    boiler_type: "firetube"
    fuel_type: "natural_gas"
    rated_capacity_mmbtu_hr: 10.0
    boiler_age_years: 22
    annual_fuel_consumption_mmbtu: 65000
    stack_temperature_f: 400
    process_temperature_f: 160
    latitude: 38.0
    annual_dni_kwh_m2: 1950
    site_climate_zone: "mixed_humid"
    building_footprint_sqft: 5000
    roof_area_available_sqft: 12000
    electricity_cost_usd_per_kwh: 0.10
    gas_cost_usd_per_mmbtu: 8.0

outputs:
  output_schema:
    type: "object"
    properties:
      current_boiler_efficiency:
        type: "number"
        description: "Current operating efficiency"

      annual_heat_delivered_mmbtu:
        type: "number"
        units: "MMBtu/year"

      efficiency_gap_percent:
        type: "number"
        units: "%"

      technology_comparison:
        type: "array"
        description: "Comparison of replacement options"

      recommended_technology:
        type: "string"

      recommended_capex_usd:
        type: "number"
        units: "USD"

      simple_payback_years:
        type: "number"
        units: "years"

      npv_20yr_usd:
        type: "number"
        units: "USD"

      annual_co2_reduction_kg:
        type: "number"
        units: "kg CO2e/year"

      implementation_roadmap:
        type: "array"
        items:
          phase: "string"
          duration: "string"
          activities: "array"
          downtime_hours: "number"

      ai_explanation:
        type: "string"
        description: "AI-generated analysis and recommendations"

      provenance:
        type: "object"
        properties:
          model: "string"
          tools_used: "array"
          cost_usd: "number"
          deterministic: "boolean"

  example_output:
    current_boiler_efficiency: 0.6534
    annual_heat_delivered_mmbtu: 42471
    efficiency_gap_percent: 16.66
    technology_comparison: [
      {
        technology_name: "Solar Thermal + Gas Backup",
        capex_usd: 450000,
        simple_payback_years: 1.2,
        npv_20yr_usd: 2100000
      }
    ]
    recommended_technology: "Solar Thermal + Gas Backup"
    recommended_capex_usd: 450000
    simple_payback_years: 1.2
    npv_20yr_usd: 2100000
    annual_co2_reduction_kg: 1860000
    implementation_roadmap: [
      {
        phase: "Phase 1 - Design & Permitting",
        duration: "8 weeks",
        activities: ["Engineering design", "Permit applications", "Incentive applications"],
        downtime_hours: 0
      },
      {
        phase: "Phase 2 - Installation",
        duration: "6 weeks",
        activities: ["Collector installation", "Piping modifications", "Controls integration"],
        downtime_hours: 48
      }
    ]
    ai_explanation: "Current boiler is 22 years old with 65% efficiency (vs 82% nameplate). Solar thermal with gas backup recommended: excellent economics (1.2 yr payback), superior CO2 reduction (1,860 tons/year), and lower technical risk than heat pump option."
    provenance:
      model: "gpt-4o"
      tools_used: ["calculate_boiler_efficiency", "calculate_solar_thermal_sizing", "calculate_heat_pump_cop", "estimate_payback_period", "compare_replacement_technologies"]
      cost_usd: 0.12
      deterministic: true

testing:
  test_coverage_target: 0.90

  test_categories:
    - category: "unit_tests"
      description: "Test individual tool implementations"
      count: 30

    - category: "integration_tests"
      description: "Test AI orchestration with tools"
      count: 10

    - category: "determinism_tests"
      description: "Verify temperature=0, seed=42 reproducibility"
      count: 3

    - category: "boundary_tests"
      description: "Test edge cases (very old boilers, extreme temperatures, etc.)"
      count: 8

    - category: "financial_tests"
      description: "Validate payback and NPV calculations"
      count: 5

    - category: "performance_tests"
      description: "Verify latency and cost targets"
      count: 3

  performance_requirements:
    max_latency_ms: 3500
    max_cost_usd: 0.15
    accuracy_target: 0.98

deployment:
  pack_id: "industrial/boiler_replacement_pack"
  pack_version: "1.0.0"

  dependencies:
    python_packages:
      - "pydantic>=2.0"
      - "numpy>=1.24"
      - "scipy>=1.11"
      - "pandas>=2.0"

    greenlang_modules:
      - "greenlang.agents.base"
      - "greenlang.intelligence"
      - "greenlang.agents.fuel_agent_ai"
      - "greenlang.agents.grid_factor_agent_ai"
      - "greenlang.agents.project_finance_agent_ai"

  resource_requirements:
    memory_mb: 768
    cpu_cores: 2
    gpu_required: false

  api_endpoints:
    - endpoint: "/api/v1/agents/industrial/boiler_replacement/execute"
      method: "POST"
      authentication: "required"

    - endpoint: "/api/v1/agents/industrial/boiler_replacement/compare"
      method: "POST"
      authentication: "required"
      description: "Quick technology comparison endpoint"

documentation:
  readme: true
  api_docs: true
  examples: true
  tutorials: true

  example_use_cases:
    - title: "22-Year-Old Natural Gas Boiler Replacement"
      description: "Food processing plant with aging firetube boiler"
      input_example:
        boiler_type: "firetube"
        rated_capacity_mmbtu_hr: 10.0
        boiler_age_years: 22
        process_temperature_f: 160
      output_summary: "Solar thermal recommended: 1.2 year payback, $2.1M NPV, 1,860 tons CO2e/year reduction"

    - title: "High-Temperature Process Replacement Analysis"
      description: "Chemical plant with 200°F process temperature"
      input_example:
        boiler_type: "watertube"
        rated_capacity_mmbtu_hr: 25.0
        process_temperature_f: 200
      output_summary: "Hybrid heat pump + evacuated tube solar recommended for optimal economics"

    - title: "Pharmaceutical Facility Steam Boiler"
      description: "Pharmaceutical plant requiring GMP compliance"
      input_example:
        boiler_type: "watertube"
        rated_capacity_mmbtu_hr: 15.0
        process_temperature_f: 250
      output_summary: "Parabolic trough solar + backup boiler with extensive controls integration"

compliance:
  zero_secrets: true
  sbom_required: true
  digital_signature: true

  standards:
    - "ASME_PTC_4.1_Boiler_Efficiency"
    - "ASHRAE_Handbook_HVAC_Systems"
    - "AHRI_540_Heat_Pump_Performance"
    - "ASHRAE_93_Solar_Collector_Testing"
    - "ISO_9806_Solar_Thermal_Collectors"
    - "ISO_13612_Heat_Pumps"
    - "DOE_Steam_BestPractices"
    - "GHG_Protocol_Corporate_Standard"
    - "ISO_14064_GHG_Quantification"
    - "NIST_Handbook_135_LCC"

  certifications:
    - "ENERGY_STAR_Industrial"
    - "LEED_EA_Renewable_Energy"
    - "ISO_50001_EnMS_Certification"

business_impact:
  market_opportunity:
    addressable_market_usd: 45000000000
    market_segment: "Industrial boiler replacement (>15 years old)"
    target_customers: "Food/beverage, chemicals, pharmaceuticals, textiles, manufacturing"

  carbon_impact:
    addressable_emissions_gt_co2e: 2.8
    realistic_reduction_2030_gt: 0.28
    note: "10% penetration × 2.8 Gt = 280 Mt CO2e/year reduction potential"

  economic_value:
    typical_capex_range_usd: "200K - 800K per installation"
    typical_payback_years: "1-4 years with IRA incentives"
    irr_range: "25-100% (excellent returns)"
    note: "IRA 2022 incentives dramatically improve economics"

metadata:
  created_date: "2025-10-13"
  created_by: "Head of AI & Climate Intelligence"
  last_modified: "2025-10-13"
  review_status: "Approved"
  reviewers: ["AI Lead", "Industrial Systems Engineer"]

  change_log:
    - version: "1.0.0"
      date: "2025-10-13"
      changes: "Initial specification - production ready for Agent Factory generation"
      author: "Chief AI & Climate Intelligence"

# END OF AGENT #2 SPECIFICATION
# Production Ready for Agent Factory Generation
# Next: Agent #3 - IndustrialHeatPumpAgent_AI
