# GreenLang Agent Specification v2.0
# Agent #9: IndustrialControlsAgent_AI
# Specialized agent for industrial process control optimization, PLC/SCADA integration, and control loop tuning

agent_metadata:
  agent_id: "industrial/industrial_controls_agent"
  agent_name: "IndustrialControlsAgent_AI"
  agent_number: 9
  version: "1.0.0"
  domain: "Domain1_Industrial"
  category: "Industrial_Process"
  complexity: "Medium"
  priority: "P2_Medium"
  base_agent: "None"
  status: "Spec_Complete"
  entry_point: false  # Specialized agent for industrial control systems

description:
  purpose: |
    Specialized agent for optimizing industrial process control systems through PID
    control loop tuning, setpoint optimization, interlock analysis, and alarm management.
    Provides expertise in PLC/SCADA integration (Modbus, OPC UA, Profinet), advanced
    control strategies (MPC, cascade, feedforward), and control loop performance monitoring.
    Delivers 5-15% efficiency improvements through optimized control strategies.

  strategic_context:
    global_impact: "Industrial process control optimization can reduce energy use by 5-15% in manufacturing"
    opportunity: "Most industrial facilities operate with poorly tuned control loops, resulting in inefficiency"
    market_size: "$200B global industrial automation and control systems market"
    technology_maturity: "Mature control technologies, emerging AI-based optimization and adaptive control"

  key_capabilities:
    - "PID control loop analysis and tuning (Ziegler-Nichols, Cohen-Coon, IMC methods)"
    - "Dynamic setpoint optimization based on operating conditions and constraints"
    - "Safety interlock analysis and nuisance trip reduction (HAZOP, ISA-84)"
    - "Alarm rationalization and prioritization (ISA-18.2 standard)"
    - "Control savings estimation and payback analysis"
    - "PLC/SCADA integration patterns (Modbus, OPC UA, Profinet, EtherNet/IP)"
    - "Advanced control strategies: MPC, cascade, feedforward, ratio control"
    - "Control loop performance monitoring (KPIs, variability reduction)"

  dependencies:
    - agent_id: "industrial/process_heat_agent"
      relationship: "coordinates_with"
      data: "Process control requirements for thermal systems"

    - agent_id: "industrial/steam_system_agent"
      relationship: "coordinates_with"
      data: "Steam system control optimization"

    - agent_id: "industrial/process_scheduling_agent"
      relationship: "coordinates_with"
      data: "Coordinated control and scheduling strategies"

    - agent_id: "agents/data_acquisition_agent_ai"
      relationship: "receives_data_from"
      data: "Real-time process data from SCADA/historians"

tools:
  tool_count: 5

  tools_list:
    - tool_id: "tool_1"
      name: "analyze_control_loops"
      description: "Analyze PID control loop performance and recommend optimal tuning parameters"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          process_type:
            type: "string"
            description: "Type of process being controlled"
            enum: ["temperature", "pressure", "flow", "level", "ph", "concentration", "speed", "position"]
            required: true

          current_tuning_p:
            type: "number"
            description: "Current proportional gain"
            required: true

          current_tuning_i:
            type: "number"
            description: "Current integral time (minutes)"
            required: true

          current_tuning_d:
            type: "number"
            description: "Current derivative time (minutes)"
            default: 0

          process_gain:
            type: "number"
            description: "Process gain (ΔPV/ΔCO) from step test"
            required: true

          process_time_constant_min:
            type: "number"
            description: "Process time constant from step test"
            units: "minutes"
            required: true

          process_dead_time_min:
            type: "number"
            description: "Process dead time/transport lag"
            units: "minutes"
            required: true

          control_objective:
            type: "string"
            description: "Primary control objective"
            enum: ["tight_control", "balanced", "conservative", "fast_response", "minimize_overshoot"]
            default: "balanced"

          tuning_method:
            type: "string"
            description: "Tuning methodology to apply"
            enum: ["ziegler_nichols", "cohen_coon", "imc", "lambda_tuning", "tyreus_luyben"]
            default: "imc"

          disturbance_frequency:
            type: "string"
            description: "Frequency of process disturbances"
            enum: ["rare", "occasional", "frequent", "continuous"]
            default: "occasional"

          measurement_noise_level:
            type: "string"
            description: "Noise in process measurement"
            enum: ["low", "moderate", "high"]
            default: "moderate"

        required: ["process_type", "current_tuning_p", "current_tuning_i", "process_gain", "process_time_constant_min", "process_dead_time_min"]

      returns:
        type: "object"
        properties:
          recommended_tuning_p:
            type: "number"
            description: "Optimal proportional gain"

          recommended_tuning_i:
            type: "number"
            description: "Optimal integral time"
            units: "minutes"

          recommended_tuning_d:
            type: "number"
            description: "Optimal derivative time"
            units: "minutes"

          tuning_method_used:
            type: "string"

          expected_improvement_percent:
            type: "number"
            description: "Expected reduction in process variability"
            units: "%"

          stability_margin:
            type: "number"
            description: "Gain margin for stability"

          closed_loop_time_constant_min:
            type: "number"
            description: "Expected closed-loop response time"
            units: "minutes"

          overshoot_percent:
            type: "number"
            description: "Expected overshoot for setpoint changes"
            units: "%"

          tuning_rationale:
            type: "string"

          implementation_notes:
            type: "array"
            items:
              type: "string"

          expected_energy_savings_percent:
            type: "number"
            description: "Estimated energy savings from improved control"
            units: "%"

      implementation:
        calculation_method: |
          Multiple tuning methods supported:

          1. IMC (Internal Model Control) - Recommended:
             λ = desired closed-loop time constant (typically τ or larger)
             Kc = (τ / (Kp × (λ + θ)))
             τI = τ
             τD = 0 (for first-order processes)

          2. Ziegler-Nichols (Ultimate Gain method):
             Find ultimate gain (Ku) and period (Pu)
             Kc = 0.6 × Ku
             τI = 0.5 × Pu
             τD = 0.125 × Pu

          3. Cohen-Coon:
             R = θ/τ (normalized dead time)
             Kc = (1/Kp) × ((τ/θ) × (0.9 + R/12))
             τI = θ × ((30 + 3R)/(9 + 20R))
             τD = θ × (4/(11 + 2R))

          4. Lambda Tuning (similar to IMC):
             λ = tuning factor (1-3× dead time)
             Kc = τ / (Kp × (λ + θ))
             τI = τ
             τD = 0
        data_source: "Process step test data, historical control performance data"
        accuracy: "Tuning recommendations within ±10% of field-optimized values"
        validation: "Simulate in control system before implementation, monitor stability"
        standards: ["ISA-5.1_Control_Valve_Sizing", "ISA-51.1_Process_Instrumentation", "ANSI_ISA-75.25.01_Control_Valve_Test"]

      example:
        input:
          process_type: "temperature"
          current_tuning_p: 2.5
          current_tuning_i: 5.0
          current_tuning_d: 0.0
          process_gain: 1.2
          process_time_constant_min: 8.0
          process_dead_time_min: 1.5
          control_objective: "balanced"
          tuning_method: "imc"
          disturbance_frequency: "occasional"
          measurement_noise_level: "moderate"
        output:
          recommended_tuning_p: 3.51
          recommended_tuning_i: 8.0
          recommended_tuning_d: 0.0
          tuning_method_used: "IMC (λ = 1.5 × dead time = 2.25 min)"
          expected_improvement_percent: 35
          stability_margin: 2.8
          closed_loop_time_constant_min: 3.75
          overshoot_percent: 5
          tuning_rationale: "IMC tuning provides balanced performance with good disturbance rejection. Process has moderate dead time (θ/τ = 0.19), suitable for IMC. Conservative λ chosen for robustness to model uncertainty."
          implementation_notes: ["Test tuning during stable operation period", "Monitor for oscillations in first 2 hours", "May need derivative if overshoot excessive", "Consider cascade control for better disturbance rejection"]
          expected_energy_savings_percent: 3.5

    - tool_id: "tool_2"
      name: "optimize_setpoints"
      description: "Optimize process setpoints dynamically based on operating conditions, constraints, and objectives"
      category: "optimization"
      deterministic: true

      parameters:
        type: "object"
        properties:
          equipment_type:
            type: "string"
            description: "Equipment being optimized"
            enum: ["boiler", "chiller", "compressor", "heat_exchanger", "reactor", "distillation_column", "dryer", "furnace"]
            required: true

          current_setpoint:
            type: "number"
            description: "Current operating setpoint"
            required: true

          setpoint_units:
            type: "string"
            description: "Units of setpoint"
            enum: ["degC", "degF", "bar", "psi", "kg_hr", "m3_hr", "rpm", "percent"]
            required: true

          operating_constraints:
            type: "object"
            description: "Operating limits and constraints"
            properties:
              minimum_value:
                type: "number"
                description: "Minimum allowable setpoint"
              maximum_value:
                type: "number"
                description: "Maximum allowable setpoint"
              rate_of_change_limit:
                type: "number"
                description: "Maximum rate of change per hour"
              quality_constraint:
                type: "string"
                description: "Product quality requirements"
            required: true

          optimization_objectives:
            type: "array"
            description: "Prioritized optimization objectives"
            items:
              type: "object"
              properties:
                objective:
                  type: "string"
                  enum: ["minimize_energy", "maximize_throughput", "minimize_cost", "improve_quality", "reduce_emissions"]
                weight:
                  type: "number"
                  minimum: 0
                  maximum: 1
            required: true

          current_operating_conditions:
            type: "object"
            description: "Current process conditions"
            properties:
              ambient_temperature_c:
                type: "number"
              load_percent:
                type: "number"
              fuel_cost_usd_per_mmbtu:
                type: "number"
              electricity_cost_usd_per_kwh:
                type: "number"
              production_rate:
                type: "number"
            required: true

          process_model_parameters:
            type: "object"
            description: "Process model for optimization"
            properties:
              energy_consumption_model:
                type: "string"
                description: "Energy use as function of setpoint"
              quality_impact_model:
                type: "string"
                description: "Product quality impact"
              throughput_model:
                type: "string"
                description: "Production rate impact"

          forecast_horizon_hours:
            type: "number"
            description: "Optimization horizon"
            default: 4
            minimum: 1
            maximum: 24

        required: ["equipment_type", "current_setpoint", "setpoint_units", "operating_constraints", "optimization_objectives", "current_operating_conditions"]

      returns:
        type: "object"
        properties:
          optimal_setpoint:
            type: "number"
            description: "Recommended optimal setpoint"

          setpoint_change:
            type: "number"
            description: "Change from current setpoint"

          expected_energy_savings_percent:
            type: "number"
            units: "%"

          expected_energy_savings_annual_usd:
            type: "number"
            units: "USD/year"

          quality_impact:
            type: "string"
            enum: ["improved", "maintained", "slightly_reduced"]

          throughput_impact_percent:
            type: "number"
            units: "%"

          constraint_binding:
            type: "array"
            description: "Constraints limiting further optimization"
            items:
              type: "string"

          sensitivity_analysis:
            type: "object"
            properties:
              setpoint_plus_5_percent_energy_impact:
                type: "number"
              setpoint_minus_5_percent_energy_impact:
                type: "number"

          implementation_schedule:
            type: "array"
            description: "Recommended setpoint change schedule"
            items:
              type: "object"
              properties:
                time_hours:
                  type: "number"
                setpoint:
                  type: "number"

          confidence_level:
            type: "string"
            enum: ["high", "medium", "low"]

          optimization_rationale:
            type: "string"

      implementation:
        calculation_method: |
          Multi-objective optimization approach:

          1. Energy Model:
             E = f(setpoint, ambient, load, equipment_characteristics)
             Typically polynomial: E = a + b×SP + c×SP²

          2. Constraint Handling:
             SP_min ≤ SP ≤ SP_max
             dSP/dt ≤ rate_limit
             Quality_metric ≥ Quality_threshold

          3. Objective Function:
             Minimize: Σ (wi × Objective_i)
             Where objectives include: energy cost, production loss, quality deviation

          4. Optimization Algorithm:
             - For simple cases: analytical solution
             - For complex: sequential quadratic programming (SQP)
             - For MPC: linear/quadratic programming over horizon
        data_source: "Equipment performance curves, historical operating data, real-time measurements"
        accuracy: "±5% for energy savings estimation"
        validation: "Pilot test on one unit before broad deployment"
        standards: ["ISA-95_Enterprise_Control", "ISA-106_Procedure_Automation", "ANSI_ISA-88_Batch_Control"]

      example:
        input:
          equipment_type: "boiler"
          current_setpoint: 175
          setpoint_units: "degC"
          operating_constraints:
            minimum_value: 150
            maximum_value: 190
            rate_of_change_limit: 10
            quality_constraint: "steam_quality_95_percent_min"
          optimization_objectives:
            - objective: "minimize_energy"
              weight: 0.7
            - objective: "improve_quality"
              weight: 0.3
          current_operating_conditions:
            ambient_temperature_c: 20
            load_percent: 75
            fuel_cost_usd_per_mmbtu: 8.0
            electricity_cost_usd_per_kwh: 0.12
            production_rate: 15000
          forecast_horizon_hours: 4
        output:
          optimal_setpoint: 168
          setpoint_change: -7
          expected_energy_savings_percent: 4.2
          expected_energy_savings_annual_usd: 42000
          quality_impact: "maintained"
          throughput_impact_percent: 0
          constraint_binding: ["minimum_steam_quality"]
          sensitivity_analysis:
            setpoint_plus_5_percent_energy_impact: -3.5
            setpoint_minus_5_percent_energy_impact: 5.8
          implementation_schedule:
            - time_hours: 0
              setpoint: 175
            - time_hours: 1
              setpoint: 171
            - time_hours: 2
              setpoint: 168
          confidence_level: "high"
          optimization_rationale: "Reducing steam temperature from 175°C to 168°C saves 4.2% energy while maintaining required steam quality (95%). Lower setpoint is constrained by minimum quality requirement. Gradual implementation over 2 hours prevents process upset."

    - tool_id: "tool_3"
      name: "analyze_interlocks"
      description: "Analyze safety interlock systems and recommend improvements to reduce nuisance trips"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          process_description:
            type: "string"
            description: "Description of process and hazards"
            required: true

          current_interlock_count:
            type: "number"
            description: "Number of interlock conditions"
            required: true

          annual_trip_count:
            type: "number"
            description: "Total trips per year"
            required: true

          safety_trips_count:
            type: "number"
            description: "Legitimate safety trips per year"
            required: true

          nuisance_trips_count:
            type: "number"
            description: "Nuisance/false trips per year"
            required: true

          interlock_logic_type:
            type: "string"
            enum: ["single_element", "two_out_of_three", "redundant_diverse", "time_delayed"]
            required: true

          safety_integrity_level:
            type: "string"
            description: "SIL level per ISA-84"
            enum: ["SIL1", "SIL2", "SIL3", "SIL4"]
            required: true

          downtime_hours_per_trip:
            type: "number"
            description: "Average downtime per trip"
            units: "hours"
            required: true

          production_loss_usd_per_hour:
            type: "number"
            description: "Cost of production loss"
            units: "USD/hour"
            required: true

          interlock_details:
            type: "array"
            description: "Individual interlock configurations"
            items:
              type: "object"
              properties:
                interlock_id:
                  type: "string"
                variable:
                  type: "string"
                setpoint:
                  type: "number"
                time_delay_sec:
                  type: "number"
                trip_frequency_per_year:
                  type: "number"

        required: ["process_description", "current_interlock_count", "annual_trip_count", "safety_trips_count", "nuisance_trips_count", "interlock_logic_type", "safety_integrity_level", "downtime_hours_per_trip", "production_loss_usd_per_hour"]

      returns:
        type: "object"
        properties:
          interlock_adequacy:
            type: "string"
            enum: ["adequate", "over_protected", "under_protected", "needs_optimization"]

          nuisance_trip_percent:
            type: "number"
            description: "Percentage of trips that are nuisance"
            units: "%"

          annual_nuisance_trip_cost_usd:
            type: "number"
            units: "USD/year"

          recommendations:
            type: "array"
            items:
              type: "object"
              properties:
                recommendation:
                  type: "string"
                expected_trip_reduction_percent:
                  type: "number"
                implementation_cost_usd:
                  type: "number"
                annual_savings_usd:
                  type: "number"
                payback_years:
                  type: "number"
                safety_impact:
                  type: "string"

          redundancy_recommendations:
            type: "array"
            items:
              type: "string"

          time_delay_recommendations:
            type: "array"
            items:
              type: "object"
              properties:
                interlock_id:
                  type: "string"
                current_delay_sec:
                  type: "number"
                recommended_delay_sec:
                  type: "number"
                rationale:
                  type: "string"

          sil_compliance_status:
            type: "string"

          estimated_annual_savings_usd:
            type: "number"
            units: "USD/year"

      implementation:
        calculation_method: |
          Interlock Analysis:

          1. Nuisance Trip Rate:
             NTR = Nuisance_Trips / Total_Trips
             Target: <20% (industry best practice)

          2. Economic Impact:
             Annual_Cost = Trip_Count × Hours_per_Trip × Production_Loss_$/hr

          3. Optimization Strategies:
             a) Time delays (must maintain safety)
             b) Setpoint adjustment (within safety limits)
             c) 2oo3 (two-out-of-three) voting for redundancy
             d) Condition-based enabling (e.g., only active during certain modes)

          4. SIL Verification:
             - SIL 1: 10⁻² to 10⁻¹ (probability of failure on demand)
             - SIL 2: 10⁻³ to 10⁻²
             - SIL 3: 10⁻⁴ to 10⁻³
             - SIL 4: 10⁻⁵ to 10⁻⁴
        data_source: "HAZOP studies, trip logs, process historian data"
        accuracy: "Trip reduction estimates ±20%"
        validation: "Requires safety review and HAZOP validation before implementation"
        standards: ["ISA-84_Safety_Instrumented_Systems", "IEC-61511_Functional_Safety", "HAZOP_Guidelines"]

      example:
        input:
          process_description: "High-pressure steam boiler with multiple safety interlocks"
          current_interlock_count: 12
          annual_trip_count: 18
          safety_trips_count: 3
          nuisance_trips_count: 15
          interlock_logic_type: "single_element"
          safety_integrity_level: "SIL2"
          downtime_hours_per_trip: 4
          production_loss_usd_per_hour: 25000
        output:
          interlock_adequacy: "needs_optimization"
          nuisance_trip_percent: 83.3
          annual_nuisance_trip_cost_usd: 1500000
          recommendations:
            - recommendation: "Implement 2oo3 voting for high-pressure interlock"
              expected_trip_reduction_percent: 60
              implementation_cost_usd: 45000
              annual_savings_usd: 900000
              payback_years: 0.05
              safety_impact: "Maintained or improved (eliminates single-point failures)"
            - recommendation: "Add 5-second time delay to low-level interlock"
              expected_trip_reduction_percent: 20
              implementation_cost_usd: 5000
              annual_savings_usd: 300000
              payback_years: 0.02
              safety_impact: "Maintained (5 sec acceptable for level control)"
          redundancy_recommendations: ["Upgrade critical interlocks to 2oo3 voting", "Add diverse measurement technology for key variables"]
          time_delay_recommendations:
            - interlock_id: "LOW_WATER_LEVEL"
              current_delay_sec: 0
              recommended_delay_sec: 5
              rationale: "Level fluctuations cause false trips; 5 sec delay maintains safety while filtering transients"
          sil_compliance_status: "SIL2 maintained with recommended changes"
          estimated_annual_savings_usd: 1200000

    - tool_id: "tool_4"
      name: "assess_alarm_management"
      description: "Analyze alarm systems and recommend rationalization per ISA-18.2 standards"
      category: "analysis"
      deterministic: true

      parameters:
        type: "object"
        properties:
          total_configured_alarms:
            type: "number"
            description: "Total alarms configured in system"
            required: true

          average_alarms_per_day:
            type: "number"
            description: "Average alarm rate"
            required: true

          peak_alarms_per_10_min:
            type: "number"
            description: "Peak alarm rate during upset"
            required: true

          alarm_flood_events_per_year:
            type: "number"
            description: "Events with >10 alarms/10min"
            default: 0

          operator_count:
            type: "number"
            description: "Number of operators per shift"
            required: true

          process_units:
            type: "array"
            description: "Process units monitored"
            items:
              type: "string"
            required: true

          alarm_priority_distribution:
            type: "object"
            description: "Distribution of alarm priorities"
            properties:
              critical_count:
                type: "number"
              high_count:
                type: "number"
              medium_count:
                type: "number"
              low_count:
                type: "number"
            required: true

          standing_alarms_percent:
            type: "number"
            description: "Percentage of time with uncleared alarms"
            units: "%"
            required: true

          nuisance_alarm_percent:
            type: "number"
            description: "Percentage of alarms that are nuisance/chattering"
            units: "%"
            required: true

        required: ["total_configured_alarms", "average_alarms_per_day", "peak_alarms_per_10_min", "operator_count", "process_units", "alarm_priority_distribution", "standing_alarms_percent", "nuisance_alarm_percent"]

      returns:
        type: "object"
        properties:
          alarm_system_health:
            type: "string"
            enum: ["good", "acceptable", "overloaded", "critical"]

          isa_182_compliance:
            type: "object"
            properties:
              average_rate_compliant:
                type: "boolean"
                description: "Target: <6 alarms/hr average (ISA-18.2)"
              peak_rate_compliant:
                type: "boolean"
                description: "Target: <10 alarms/10min peak"
              priority_distribution_compliant:
                type: "boolean"
                description: "Critical: <5%, High: <15%"
              standing_alarm_compliant:
                type: "boolean"
                description: "Target: <1% time with standing alarms"

          rationalized_alarm_count:
            type: "number"
            description: "Recommended alarm count after rationalization"

          alarms_to_eliminate:
            type: "number"
            description: "Alarms to remove/consolidate"

          alarms_to_reprioritize:
            type: "number"

          priority_recommendations:
            type: "array"
            items:
              type: "object"
              properties:
                alarm_category:
                  type: "string"
                current_priority:
                  type: "string"
                recommended_priority:
                  type: "string"
                count:
                  type: "number"
                rationale:
                  type: "string"

          deadband_recommendations:
            type: "array"
            description: "Alarms needing deadband/time delay"
            items:
              type: "object"
              properties:
                alarm_type:
                  type: "string"
                recommended_deadband_percent:
                  type: "number"
                recommended_time_delay_sec:
                  type: "number"

          estimated_alarm_reduction_percent:
            type: "number"
            units: "%"

          expected_operator_response_improvement:
            type: "string"

          implementation_priority:
            type: "string"
            enum: ["critical_immediate", "high_1_month", "medium_3_months", "low_6_months"]

      implementation:
        calculation_method: |
          ISA-18.2 Alarm Management Metrics:

          1. Average Alarm Rate:
             Target: <6 alarms/hour per operator
             Acceptable: 6-12 alarms/hour
             Overloaded: >12 alarms/hour

          2. Peak Alarm Rate:
             Target: <10 alarms/10min
             Manageable: 10-20 alarms/10min
             Unmanageable: >20 alarms/10min

          3. Priority Distribution (% of total):
             Critical: <5%
             High: <15%
             Medium: ~80%
             Low: Small percentage

          4. Rationalization Process:
             a) Eliminate non-actionable alarms
             b) Consolidate related alarms
             c) Adjust priorities based on consequence
             d) Add deadbands for chattering alarms
             e) Implement time delays where appropriate
        data_source: "Alarm history logs, operator interviews, consequence analysis"
        accuracy: "Alarm reduction estimates ±15%"
        validation: "Operator review, consequence-based prioritization"
        standards: ["ISA-18.2_Alarm_Management", "EEMUA-191_Alarm_Systems", "IEC-62682_Alarm_Management"]

      example:
        input:
          total_configured_alarms: 2500
          average_alarms_per_day: 450
          peak_alarms_per_10_min: 35
          alarm_flood_events_per_year: 12
          operator_count: 2
          process_units: ["Reactor", "Distillation", "Heat Exchange", "Utilities"]
          alarm_priority_distribution:
            critical_count: 250
            high_count: 600
            medium_count: 1400
            low_count: 250
          standing_alarms_percent: 8
          nuisance_alarm_percent: 25
        output:
          alarm_system_health: "overloaded"
          isa_182_compliance:
            average_rate_compliant: false
            peak_rate_compliant: false
            priority_distribution_compliant: false
            standing_alarm_compliant: false
          rationalized_alarm_count: 800
          alarms_to_eliminate: 1200
          alarms_to_reprioritize: 500
          priority_recommendations:
            - alarm_category: "Instrument out-of-service alarms"
              current_priority: "High"
              recommended_priority: "Remove"
              count: 300
              rationale: "Not actionable - operators cannot respond to instrument maintenance needs via alarm"
            - alarm_category: "Informational status alarms"
              current_priority: "Medium"
              recommended_priority: "Remove"
              count: 400
              rationale: "Status information - should be available in HMI but not generate alarms"
            - alarm_category: "Minor quality deviations"
              current_priority: "Critical"
              recommended_priority: "Medium"
              count: 150
              rationale: "Over-prioritized - small quality deviations do not warrant critical alarms"
          deadband_recommendations:
            - alarm_type: "Tank level alarms"
              recommended_deadband_percent: 5
              recommended_time_delay_sec: 10
            - alarm_type: "Pressure fluctuation alarms"
              recommended_deadband_percent: 3
              recommended_time_delay_sec: 5
          estimated_alarm_reduction_percent: 68
          expected_operator_response_improvement: "Significant - operators will be able to focus on actionable alarms instead of being overwhelmed"
          implementation_priority: "critical_immediate"

    - tool_id: "tool_5"
      name: "estimate_control_savings"
      description: "Quantify energy and cost savings from control system improvements"
      category: "calculation"
      deterministic: true

      parameters:
        type: "object"
        properties:
          improvement_type:
            type: "string"
            enum: ["control_tuning", "setpoint_optimization", "advanced_control_mpc", "cascade_control", "feedforward_control"]
            required: true

          baseline_energy_use_mmbtu_yr:
            type: "number"
            description: "Current annual energy consumption"
            units: "MMBtu/year"
            required: true

          baseline_variability_percent:
            type: "number"
            description: "Current process variability (std dev / mean)"
            units: "%"
            required: true

          improved_variability_percent:
            type: "number"
            description: "Expected variability after improvement"
            units: "%"
            required: true

          energy_intensity_per_unit:
            type: "number"
            description: "Energy per unit of production"
            units: "MMBtu/unit"
            required: true

          annual_production_units:
            type: "number"
            description: "Annual production volume"
            required: true

          fuel_cost_usd_per_mmbtu:
            type: "number"
            units: "USD/MMBtu"
            required: true

          electricity_use_kwh_yr:
            type: "number"
            description: "Annual electricity consumption"
            units: "kWh/year"
            default: 0

          electricity_cost_usd_per_kwh:
            type: "number"
            units: "USD/kWh"
            default: 0.10

          operating_hours_per_year:
            type: "number"
            default: 8760

          implementation_cost_usd:
            type: "number"
            description: "Cost to implement control improvements"
            units: "USD"
            required: true

          quality_improvement_value_usd_yr:
            type: "number"
            description: "Annual value from improved product quality"
            units: "USD/year"
            default: 0

        required: ["improvement_type", "baseline_energy_use_mmbtu_yr", "baseline_variability_percent", "improved_variability_percent", "energy_intensity_per_unit", "annual_production_units", "fuel_cost_usd_per_mmbtu", "implementation_cost_usd"]

      returns:
        type: "object"
        properties:
          variability_reduction_percent:
            type: "number"
            units: "%"

          energy_savings_mmbtu_yr:
            type: "number"
            units: "MMBtu/year"

          energy_savings_percent:
            type: "number"
            units: "%"

          annual_fuel_cost_savings_usd:
            type: "number"
            units: "USD/year"

          annual_electricity_cost_savings_usd:
            type: "number"
            units: "USD/year"

          total_annual_savings_usd:
            type: "number"
            units: "USD/year"
            description: "Energy + quality + maintenance savings"

          implementation_cost_usd:
            type: "number"
            units: "USD"

          simple_payback_years:
            type: "number"
            units: "years"

          10yr_npv_usd:
            type: "number"
            units: "USD"
            description: "NPV at 8% discount rate"

          internal_rate_of_return:
            type: "number"

          co2e_reduction_kg_yr:
            type: "number"
            units: "kg CO2e/year"

          savings_breakdown:
            type: "object"
            properties:
              energy_savings_usd:
                type: "number"
              quality_improvement_usd:
                type: "number"
              reduced_variability_usd:
                type: "number"
              reduced_trips_usd:
                type: "number"

          confidence_level:
            type: "string"
            enum: ["high", "medium", "low"]

      implementation:
        calculation_method: |
          Control Improvement Savings Estimation:

          1. Variability-Energy Relationship:
             Many processes: 1% reduction in variability = 0.2-0.5% energy savings
             ΔE = k × (σ_baseline - σ_improved) × Baseline_Energy
             Typical k = 0.3 to 0.5

          2. Setpoint Optimization:
             Direct calculation: ΔE = Energy(SP_new) - Energy(SP_old)
             From equipment curves or models

          3. Advanced Control (MPC):
             Typical savings: 5-15% energy, 2-8% throughput
             From maintaining optimal setpoints under constraints

          4. Economic Analysis:
             Annual_Savings = ΔE × Fuel_Cost + Quality_Value + Reduced_Trips
             NPV = Σ(Savings_t / (1+r)^t) - Initial_Cost
             IRR: solve NPV = 0 for discount rate
        data_source: "Baseline performance data, process models, industry benchmarks"
        accuracy: "±20% for savings estimates (depends on baseline data quality)"
        validation: "Monitor and measure post-implementation; adjust models"
        standards: ["NIST_Handbook_135_LCC", "ISA-95_KPIs", "ASHRAE_Guideline_14_Measurement"]

      example:
        input:
          improvement_type: "control_tuning"
          baseline_energy_use_mmbtu_yr: 500000
          baseline_variability_percent: 8.0
          improved_variability_percent: 4.0
          energy_intensity_per_unit: 2.5
          annual_production_units: 200000
          fuel_cost_usd_per_mmbtu: 8.0
          electricity_use_kwh_yr: 5000000
          electricity_cost_usd_per_kwh: 0.10
          operating_hours_per_year: 8760
          implementation_cost_usd: 75000
          quality_improvement_value_usd_yr: 50000
        output:
          variability_reduction_percent: 50.0
          energy_savings_mmbtu_yr: 15000
          energy_savings_percent: 3.0
          annual_fuel_cost_savings_usd: 120000
          annual_electricity_cost_savings_usd: 15000
          total_annual_savings_usd: 185000
          implementation_cost_usd: 75000
          simple_payback_years: 0.41
          10yr_npv_usd: 1166000
          internal_rate_of_return: 2.43
          co2e_reduction_kg_yr: 800550
          savings_breakdown:
            energy_savings_usd: 135000
            quality_improvement_usd: 50000
            reduced_variability_usd: 0
            reduced_trips_usd: 0
          confidence_level: "high"

ai_integration:
  temperature: 0.0
  seed: 42
  tool_choice: "auto"
  max_iterations: 5
  budget_usd: 0.15
  provenance_tracking: true
  ai_summary: true

  system_prompt: |
    You are an industrial process control expert specializing in control loop optimization,
    PLC/SCADA systems, and advanced control strategies for GreenLang. You help facilities
    improve control system performance through PID tuning, setpoint optimization, interlock
    analysis, and alarm management.

    Your expertise includes:
    - PID control loop tuning (Ziegler-Nichols, Cohen-Coon, IMC, Lambda)
    - Dynamic setpoint optimization and model predictive control (MPC)
    - Safety interlock analysis and nuisance trip reduction (ISA-84)
    - Alarm rationalization per ISA-18.2 standards
    - PLC/SCADA integration (Modbus, OPC UA, Profinet, EtherNet/IP)
    - Advanced control strategies (cascade, feedforward, ratio control)
    - Control system economics and energy savings quantification

    CRITICAL RULES:
    - Use provided tools for ALL calculations
    - NEVER estimate or guess numbers
    - Always explain control theory clearly but concisely
    - Prioritize safety in all recommendations
    - Follow ISA and IEC standards for control and safety systems
    - Provide conservative tuning for initial implementation
    - Always recommend pilot testing before full deployment
    - Quantify expected savings and payback periods

  user_prompt_template: |
    Analyze industrial process control system optimization opportunity:

    Process Information:
    - Process Type: {process_type}
    - Equipment: {equipment_description}
    - Control Objective: {control_objective}
    - Operating Hours: {operating_hours_per_year} hours/year

    Current Control Performance:
    - Control Loop: P={current_p}, I={current_i}, D={current_d}
    - Process Variability: {baseline_variability_percent}%
    - Alarm Rate: {average_alarms_per_day} alarms/day
    - Annual Trips: {annual_trip_count} (Nuisance: {nuisance_trips_count})

    Process Characteristics:
    - Process Gain: {process_gain}
    - Time Constant: {process_time_constant_min} min
    - Dead Time: {process_dead_time_min} min

    Economic Context:
    - Annual Energy Use: {baseline_energy_use_mmbtu_yr} MMBtu/year
    - Fuel Cost: ${fuel_cost_usd_per_mmbtu}/MMBtu
    - Production Loss: ${production_loss_usd_per_hour}/hour downtime

    Tasks:
    1. Use analyze_control_loops to assess current tuning and recommend optimal PID parameters
    2. Use optimize_setpoints to identify optimal operating setpoints for energy efficiency
    3. Use analyze_interlocks to evaluate safety interlock configuration and reduce nuisance trips
    4. Use assess_alarm_management to rationalize alarm system per ISA-18.2
    5. Use estimate_control_savings to quantify total financial benefits
    6. Provide comprehensive analysis with:
       - Recommended control loop tuning (P, I, D values)
       - Optimal setpoints with energy savings
       - Interlock optimization recommendations
       - Alarm rationalization plan
       - Total annual savings and payback period
       - Implementation roadmap with priorities
       - Safety considerations and validation requirements

    IMPORTANT:
    - Use tools for ALL calculations
    - Prioritize safety in all recommendations
    - Provide conservative initial tuning (can fine-tune later)
    - Recommend pilot testing for major changes
    - Follow ISA-84 for interlocks, ISA-18.2 for alarms
    - Format numbers with proper units
    - Provide actionable implementation steps

sub_agents:
  sub_agent_count: 0
  note: "Coordinates with ProcessHeatAgent, SteamSystemAgent, ProcessSchedulingAgent for integrated control optimization"

inputs:
  input_schema:
    type: "object"
    properties:
      process_type:
        type: "string"
        required: true

      equipment_description:
        type: "string"
        required: true

      current_tuning_p:
        type: "number"
        required: true

      current_tuning_i:
        type: "number"
        required: true

      current_tuning_d:
        type: "number"
        default: 0

      process_gain:
        type: "number"
        required: true

      process_time_constant_min:
        type: "number"
        required: true

      process_dead_time_min:
        type: "number"
        required: true

      baseline_variability_percent:
        type: "number"
        required: true

      baseline_energy_use_mmbtu_yr:
        type: "number"
        required: true

      fuel_cost_usd_per_mmbtu:
        type: "number"
        required: true

      operating_hours_per_year:
        type: "number"
        default: 8760

    required: ["process_type", "equipment_description", "current_tuning_p", "current_tuning_i", "process_gain", "process_time_constant_min", "process_dead_time_min", "baseline_variability_percent", "baseline_energy_use_mmbtu_yr", "fuel_cost_usd_per_mmbtu"]

  example_input:
    process_type: "temperature"
    equipment_description: "Industrial steam boiler temperature control"
    current_tuning_p: 2.5
    current_tuning_i: 5.0
    current_tuning_d: 0.0
    process_gain: 1.2
    process_time_constant_min: 8.0
    process_dead_time_min: 1.5
    baseline_variability_percent: 8.0
    baseline_energy_use_mmbtu_yr: 500000
    fuel_cost_usd_per_mmbtu: 8.0
    operating_hours_per_year: 8760

outputs:
  output_schema:
    type: "object"
    properties:
      recommended_tuning_p:
        type: "number"

      recommended_tuning_i:
        type: "number"

      recommended_tuning_d:
        type: "number"

      optimal_setpoint:
        type: "number"

      expected_variability_reduction_percent:
        type: "number"

      energy_savings_mmbtu_yr:
        type: "number"
        units: "MMBtu/year"

      annual_savings_usd:
        type: "number"
        units: "USD/year"

      simple_payback_years:
        type: "number"
        units: "years"

      implementation_roadmap:
        type: "array"

      ai_explanation:
        type: "string"

      provenance:
        type: "object"

  example_output:
    recommended_tuning_p: 3.51
    recommended_tuning_i: 8.0
    recommended_tuning_d: 0.0
    optimal_setpoint: 168
    expected_variability_reduction_percent: 50
    energy_savings_mmbtu_yr: 15000
    annual_savings_usd: 185000
    simple_payback_years: 0.41
    implementation_roadmap: ["Phase 1: Implement PID retuning (Week 1)", "Phase 2: Test setpoint optimization (Week 2-3)", "Phase 3: Rationalize alarms per ISA-18.2 (Week 4-6)", "Phase 4: Optimize interlocks (Week 7-8)"]
    ai_explanation: "Control system optimization achieves $185K/year savings through improved PID tuning (50% variability reduction = 3% energy savings), setpoint optimization, and alarm rationalization. IMC tuning method recommended for balanced performance. Payback: 5 months. Safety maintained throughout. Recommend pilot test on one unit before full deployment."
    provenance:
      model: "gpt-4o"
      tools_used: ["analyze_control_loops", "optimize_setpoints", "assess_alarm_management", "estimate_control_savings"]
      cost_usd: 0.12
      deterministic: true

testing:
  test_coverage_target: 0.85

  test_categories:
    - category: "unit_tests"
      description: "Test individual tool implementations"
      count: 25

    - category: "integration_tests"
      description: "Test AI orchestration"
      count: 8

    - category: "determinism_tests"
      description: "Verify reproducibility"
      count: 3

    - category: "boundary_tests"
      description: "Test edge cases (unstable processes, over-tuned systems)"
      count: 6

    - category: "safety_tests"
      description: "Validate safety constraint compliance"
      count: 5

  performance_requirements:
    max_latency_ms: 4000
    max_cost_usd: 0.15
    accuracy_target: 0.90

deployment:
  pack_id: "industrial/process_control_pack"
  pack_version: "1.0.0"

  dependencies:
    python_packages:
      - "pydantic>=2.0"
      - "numpy>=1.24"
      - "scipy>=1.11"
      - "control>=0.9"

    greenlang_modules:
      - "greenlang.agents.base"
      - "greenlang.intelligence"

  resource_requirements:
    memory_mb: 512
    cpu_cores: 1
    gpu_required: false

  api_endpoints:
    - endpoint: "/api/v1/agents/industrial/controls/execute"
      method: "POST"
      authentication: "required"

documentation:
  readme: true
  api_docs: true
  examples: true
  tutorials: true

  example_use_cases:
    - title: "Boiler Control Optimization"
      description: "PID tuning and setpoint optimization for steam boiler"
      output_summary: "3% energy savings, 50% variability reduction, 5-month payback"

    - title: "Alarm System Rationalization"
      description: "ISA-18.2 compliant alarm management for chemical plant"
      output_summary: "68% alarm reduction, $1.2M/year savings from reduced nuisance trips"

    - title: "Interlock System Optimization"
      description: "Safety interlock analysis with nuisance trip reduction"
      output_summary: "60% trip reduction, $900K/year savings, safety maintained"

compliance:
  zero_secrets: true
  sbom_required: true
  digital_signature: true

  standards:
    - "ISA-5.1_Control_Valve_Sizing"
    - "ISA-51.1_Process_Instrumentation"
    - "ISA-18.2_Alarm_Management"
    - "ISA-84_Safety_Instrumented_Systems"
    - "ISA-95_Enterprise_Control"
    - "IEC-61511_Functional_Safety"
    - "IEC-62682_Alarm_Management"

business_impact:
  market_opportunity:
    addressable_market_usd: 200000000000
    market_segment: "Industrial facilities with process control systems"
    target_customers: "Chemical, refining, pulp/paper, food/beverage, pharmaceuticals"

  carbon_impact:
    addressable_emissions_gt_co2e: 0.8
    realistic_reduction_2030_gt: 0.04
    note: "5% penetration × 5% efficiency improvement × 16 Gt industrial emissions"

  economic_value:
    typical_savings_range: "2-8% energy reduction, 30-60% alarm reduction"
    typical_payback_years: "0.5-2 years"
    irr_range: "50-200%"

metadata:
  created_date: "2025-10-13"
  created_by: "Head of AI & Climate Intelligence"
  last_modified: "2025-10-13"
  review_status: "Approved"
  reviewers: ["AI Lead", "Process Control Engineer"]

  change_log:
    - version: "1.0.0"
      date: "2025-10-13"
      changes: "Initial specification - production ready for Agent Factory generation"
      author: "Chief AI & Climate Intelligence"

# END OF AGENT #9 SPECIFICATION
# Production Ready for Agent Factory Generation
