name: Boiler – Natural Gas (LHV)
version: 2.1.3
kind: pack
pack_schema_version: '1.0'
author:
  name: GreenLang Team
  email: support@greenlang.io
  organization: GreenLang
license: Apache-2.0
tags:
- buildings
- combustion
- scope1
- natural-gas
- boiler
id: buildings/boiler_ng_v1
summary: Computes CO2e emissions from natural gas boiler fuel consumption using Lower
  Heating Value (LHV) method.
owners:
- '@gl/industry-buildings'
- '@gl/climate-science'
ai:
  json_mode: true
  system_prompt: 'You are a climate advisor specializing in industrial building emissions.


    Guidelines:

    - Use tools to calculate emissions; never guess numbers.

    - Always cite emission factors with proper URIs (ef://).

    - Validate all inputs for physical plausibility (efficiency 0-1, volumes ≥ 0).

    - Provide uncertainty estimates when available.

    - Follow GHG Protocol Corporate Standard for scope 1 emissions.


    When uncertain, ask clarifying questions rather than making assumptions.

    '
  budget:
    max_cost_usd: 1.0
    max_input_tokens: 15000
    max_output_tokens: 2000
    max_retries: 3
  rag_collections:
  - ghg_protocol_corp
  - ipcc_ar6
  - gl_docs
  tools:
  - name: select_emission_factor
    description: Select appropriate emission factor based on fuel type, region, and
      year
    schema_in:
      type: object
      properties:
        fuel_type:
          type: string
          enum:
          - natural_gas
          - coal
          - oil
          - biomass
        region:
          type: string
          description: ISO 3166-1 alpha-2 country code
        year:
          type: integer
          minimum: 1990
          maximum: 2100
      required:
      - fuel_type
      - region
      - year
    schema_out:
      type: object
      properties:
        ef_uri:
          type: string
          pattern: ^ef://
          description: Emission factor URI
        value:
          type: number
          description: Emission factor value
        unit:
          type: string
          description: Emission factor unit
        source:
          type: string
          description: Data source (IPCC, EPA, etc.)
      required:
      - ef_uri
      - value
      - unit
      - source
    impl: python://gl.ai.tools.ef:select
    safe: true
  - name: validate_input
    description: Validate input parameters for physical plausibility
    schema_in:
      type: object
      properties:
        parameter:
          type: string
          description: Parameter name
        value:
          type: number
          description: Parameter value
        unit:
          type: string
          description: Parameter unit
      required:
      - parameter
      - value
      - unit
    schema_out:
      type: object
      properties:
        valid:
          type: boolean
          description: Whether input is valid
        warning:
          type: string
          description: Warning message if suspicious
        suggestion:
          type: number
          description: Suggested value if invalid
      required:
      - valid
    impl: python://gl.ai.tools.validation:validate_input
    safe: true
realtime:
  default_mode: replay
  snapshot_path: snapshots/2024-10-06_boiler_data.json
  connectors:
  - name: grid_intensity
    topic: region_hourly_ci
    window: 1h
    ttl: 6h
    required: false
  - name: weather
    topic: outdoor_temperature
    window: 15min
    ttl: 1h
    required: false
provenance:
  pin_ef: true
  gwp_set: AR6GWP100
  record:
  - inputs
  - outputs
  - factors
  - ef_uri
  - ef_cid
  - unit_system
  - code_sha
  - env
  - inputs_hash
  - seed
  - timestamp
  - user
security:
  allowlist_hosts:
  - api.ipcc.ch
  - api.epa.gov
  - api.eia.gov
  block_on_violation: true
tests:
  golden:
  - name: baseline
    description: Standard boiler operation with typical efficiency
    input:
      fuel_volume: 100.0
      lhv: 38.0
      efficiency: 0.92
      region: US
    expect:
      co2e_kg:
        value: 197.6
        tol: 0.01
      energy_mj:
        value: 3496.0
        tol: 0.001
      intensity:
        value: 0.0565
        tol: 0.01
  - name: high_efficiency
    description: Modern condensing boiler with high efficiency
    input:
      fuel_volume: 50.0
      lhv: 38.0
      efficiency: 0.98
      region: EU
    expect:
      co2e_kg:
        value: 99.3
        tol: 0.01
  - name: low_efficiency
    description: Old boiler with poor efficiency
    input:
      fuel_volume: 200.0
      lhv: 38.0
      efficiency: 0.7
      region: UK
    expect:
      co2e_kg:
        value: 355.2
        tol: 0.01
  properties:
  - name: monotone_fuel_volume
    rule: output.co2e_kg is nondecreasing in input.fuel_volume
    description: More fuel → more emissions (all else equal)
  - name: monotone_efficiency_inverse
    rule: output.co2e_kg is nonincreasing in input.efficiency
    description: Higher efficiency → fewer emissions (all else equal)
  - name: non_negative_emissions
    rule: output.co2e_kg >= 0
    description: Emissions cannot be negative
  - name: energy_balance
    rule: output.energy_mj == input.fuel_volume * input.lhv * input.efficiency
    description: Energy output equals input energy adjusted by efficiency
    tolerance: 1e-6
  - name: intensity_bounds
    rule: 0 < output.intensity < 0.2
    description: Emission intensity should be between 0 and 0.2 kgCO2e/MJ for NG
