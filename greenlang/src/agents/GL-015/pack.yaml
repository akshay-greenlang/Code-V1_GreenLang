# ==============================================================================
# GL-015 INSULSCAN Insulation Inspection Agent - Agent Pack Manifest
# ==============================================================================
# Pack Schema Version: 1.0
# Agent ID: GL-015
# Codename: INSULSCAN
# ==============================================================================

kind: Pack
pack_schema_version: "1.0"
license: Apache-2.0

# ==============================================================================
# AGENT METADATA
# ==============================================================================
metadata:
  # Core Identification
  agent_id: GL-015
  codename: INSULSCAN
  name: InsulationInspectionAgent
  version: "1.0.0"

  # Classification
  category: energy_conservation
  type: monitor
  domain: Energy Conservation

  # Business Priority
  priority: medium
  business_priority: P2
  market_tam: "$3B"
  target_date: "Q3 2026"

  # Description
  description: >-
    Detects insulation degradation using thermal imaging and advanced analytics
    for energy conservation. Analyzes infrared camera images to identify heat loss,
    assess insulation condition, and generate prioritized repair recommendations
    with ROI calculations.

  # Extended Description
  long_description: |
    The INSULSCAN agent provides comprehensive insulation inspection capabilities
    including:

    1. THERMAL IMAGE ANALYSIS
       - IR camera image processing and hotspot detection
       - Temperature gradient analysis and mapping
       - Surface temperature anomaly identification
       - Multi-point temperature comparison

    2. HEAT LOSS QUANTIFICATION
       - Heat flux calculations using Stefan-Boltzmann law
       - Energy loss in kW/m2 and annual MWh
       - Cost impact analysis in USD
       - Comparison to properly insulated baseline

    3. DEGRADATION ASSESSMENT
       - Insulation condition severity classification
       - Damage type identification (moisture, mechanical, CUI)
       - Corrosion Under Insulation (CUI) risk assessment
       - Remaining useful life estimation

    4. REPAIR PRIORITIZATION
       - ROI-based repair ranking
       - Payback period calculations
       - Repair cost estimation
       - Work order generation for CMMS

    5. ECONOMIC IMPACT ANALYSIS
       - Annual energy waste quantification
       - Repair vs. replace cost comparison
       - Multi-year savings projections
       - Carbon emissions impact

    Zero-Hallucination Guarantee: All thermal calculations use deterministic
    engineering formulas from ASTM C1055, ASTM C680, and 3E Plus methodology.

apiVersion: greenlang.io/v1

# ==============================================================================
# RUNTIME SPECIFICATION
# ==============================================================================
spec:
  runtime:
    language: python
    version: "3.11"
    framework: fastapi
    entry_point: main:app
    deterministic: true
    temperature: 0.0
    seed: 42
    zero_hallucination: true
    max_retries: 3
    cache_ttl_seconds: 300
    batch_processing:
      enabled: true
      max_batch_size: 100

  # ============================================================================
  # DEPENDENCIES
  # ============================================================================
  dependencies:
    required:
      # Web Framework
      - fastapi>=0.104.1
      - uvicorn>=0.24.0

      # Data Validation
      - pydantic>=2.5.0
      - pydantic-settings>=2.1.0

      # Database
      - asyncpg>=0.29.0
      - sqlalchemy>=2.0.23

      # Cache
      - redis>=5.0.1

      # Image Processing
      - numpy>=1.26.2
      - opencv-python>=4.8.1
      - pillow>=10.1.0
      - scikit-image>=0.22.0

      # Numerical Computing
      - scipy>=1.11.4
      - pandas>=2.1.3

      # Monitoring
      - prometheus-client>=0.19.0

      # Utilities
      - python-dateutil>=2.8.2
      - pytz>=2023.3

    optional:
      # Observability
      - opentelemetry-api>=1.21.0
      - opentelemetry-sdk>=1.21.0
      - opentelemetry-exporter-otlp>=1.21.0

      # Logging
      - structlog>=23.2.0

      # Advanced Image Processing
      - matplotlib>=3.8.2
      - seaborn>=0.13.0

      # Thermal Camera SDKs
      - flirpy>=0.1.0

  # ============================================================================
  # RESOURCE REQUIREMENTS
  # ============================================================================
  resources:
    cpu:
      requests: "500m"
      limits: "2000m"
    memory:
      requests: "1Gi"
      limits: "4Gi"
    storage: "50Gi"

  # ============================================================================
  # NETWORK PORTS
  # ============================================================================
  ports:
    - name: http
      port: 8000
      protocol: TCP
      description: "Main API endpoint"
    - name: metrics
      port: 8001
      protocol: TCP
      description: "Prometheus metrics endpoint"
    - name: health
      port: 8002
      protocol: TCP
      description: "Health check endpoint"

  # ============================================================================
  # INPUT SPECIFICATION
  # ============================================================================
  inputs:
    - name: thermal_image_data
      type: object
      required: true
      description: "IR camera thermal images with temperature matrices"
      schema:
        image_id:
          type: string
          description: "Unique image identifier"
        camera_type:
          type: string
          enum: [FLIR, Fluke, Testo, Optris, InfraTec]
          description: "Thermal camera manufacturer"
        camera_model:
          type: string
          description: "Camera model identifier"
        temperature_matrix:
          type: array
          description: "2D array of temperature values in Celsius"
        min_temp_c:
          type: float
          description: "Minimum temperature in image"
        max_temp_c:
          type: float
          description: "Maximum temperature in image"
        avg_temp_c:
          type: float
          description: "Average temperature in image"
        resolution_width:
          type: integer
          description: "Image width in pixels"
        resolution_height:
          type: integer
          description: "Image height in pixels"
        emissivity_setting:
          type: float
          description: "Camera emissivity setting (0.0-1.0)"
        reflected_temp_c:
          type: float
          description: "Reflected apparent temperature"
        capture_timestamp:
          type: string
          format: datetime
          description: "Image capture timestamp"
        hotspots:
          type: array
          description: "Identified hotspot regions"

    - name: ambient_conditions
      type: object
      required: true
      description: "Environmental conditions during inspection"
      schema:
        ambient_temp_c:
          type: float
          description: "Ambient air temperature (Celsius)"
        wind_speed_m_s:
          type: float
          description: "Wind speed at inspection location (m/s)"
        wind_direction_deg:
          type: float
          description: "Wind direction (degrees from North)"
        relative_humidity_percent:
          type: float
          description: "Relative humidity (%)"
        solar_loading_w_m2:
          type: float
          description: "Solar radiation intensity (W/m2)"
        sky_condition:
          type: string
          enum: [clear, partly_cloudy, overcast, rain, night]
          description: "Sky conditions"
        measurement_timestamp:
          type: string
          format: datetime
          description: "Ambient measurement timestamp"

    - name: equipment_parameters
      type: object
      required: true
      description: "Equipment specifications for insulated asset"
      schema:
        equipment_id:
          type: string
          description: "Unique equipment identifier"
        equipment_name:
          type: string
          description: "Equipment name/description"
        equipment_type:
          type: string
          enum: [pipe, vessel, tank, exchanger, column, duct, valve, flange]
          description: "Type of equipment"
        process_temp_c:
          type: float
          description: "Internal process temperature (Celsius)"
        design_temp_c:
          type: float
          description: "Design operating temperature (Celsius)"
        pipe_diameter_mm:
          type: float
          description: "Pipe outer diameter (mm) - for pipes only"
        pipe_length_m:
          type: float
          description: "Inspected pipe length (m)"
        surface_area_m2:
          type: float
          description: "Total insulated surface area (m2)"
        operating_hours_per_year:
          type: integer
          description: "Annual operating hours"
        location:
          type: string
          description: "Physical location identifier"
        unit:
          type: string
          description: "Process unit name"

    - name: insulation_specifications
      type: object
      required: true
      description: "Insulation design specifications"
      schema:
        insulation_type:
          type: string
          enum: [mineral_wool, calcium_silicate, cellular_glass, perlite, aerogel, polyurethane, polystyrene, phenolic_foam, fiberglass]
          description: "Insulation material type"
        insulation_thickness_mm:
          type: float
          description: "Design insulation thickness (mm)"
        actual_thickness_mm:
          type: float
          description: "Measured/estimated actual thickness (mm)"
        thermal_conductivity_w_mk:
          type: float
          description: "Insulation thermal conductivity (W/m-K)"
        jacket_type:
          type: string
          enum: [aluminum, stainless_steel, galvanized_steel, pvc, none]
          description: "Weather barrier/jacketing material"
        installation_date:
          type: string
          format: date
          description: "Insulation installation date"
        expected_life_years:
          type: integer
          description: "Expected insulation service life (years)"
        age_years:
          type: float
          description: "Current insulation age (years)"
        last_inspection_date:
          type: string
          format: date
          description: "Date of last inspection"

    - name: historical_data
      type: object
      required: false
      description: "Historical inspection and performance data"
      schema:
        previous_inspections:
          type: array
          description: "Array of previous inspection records"
        repair_history:
          type: array
          description: "History of repairs and replacements"
        energy_consumption_history:
          type: array
          description: "Historical energy consumption data"

  # ============================================================================
  # OUTPUT SPECIFICATION
  # ============================================================================
  outputs:
    - name: heat_loss_analysis
      type: object
      description: "Quantified heat losses with energy and cost impact"
      schema:
        equipment_id:
          type: string
        analysis_timestamp:
          type: string
        total_heat_loss_w:
          type: float
          description: "Total heat loss rate (Watts)"
        heat_loss_per_area_w_m2:
          type: float
          description: "Heat flux per unit area (W/m2)"
        baseline_heat_loss_w:
          type: float
          description: "Expected heat loss with proper insulation"
        excess_heat_loss_w:
          type: float
          description: "Excess heat loss above baseline"
        annual_energy_loss_mwh:
          type: float
          description: "Annual energy loss (MWh)"
        annual_energy_cost_usd:
          type: float
          description: "Annual energy cost (USD)"
        thermal_efficiency_percent:
          type: float
          description: "Current insulation thermal efficiency (%)"

    - name: degradation_assessment
      type: object
      description: "Insulation condition and degradation severity"
      schema:
        equipment_id:
          type: string
        overall_condition:
          type: string
          enum: [excellent, good, fair, poor, critical]
        degradation_severity:
          type: string
          enum: [none, minor, moderate, severe, failed]
        damage_types:
          type: array
          description: "Identified damage types"
        moisture_detected:
          type: boolean
        cui_risk_level:
          type: string
          enum: [low, medium, high, critical]
        remaining_life_years:
          type: float
        confidence_score:
          type: float

    - name: repair_priorities
      type: object
      description: "Prioritized repair recommendations with ROI"
      schema:
        equipment_id:
          type: string
        priority_ranking:
          type: integer
        recommended_action:
          type: string
          enum: [monitor, spot_repair, partial_replacement, full_replacement, emergency_repair]
        estimated_repair_cost_usd:
          type: float
        estimated_savings_annual_usd:
          type: float
        payback_period_months:
          type: float
        roi_percent:
          type: float
        urgency_level:
          type: string
          enum: [routine, planned, urgent, critical]

    - name: inspection_report
      type: object
      description: "Comprehensive inspection findings and recommendations"
      schema:
        report_id:
          type: string
        inspection_date:
          type: string
        equipment_summary:
          type: object
        findings:
          type: array
        recommendations:
          type: array
        images:
          type: array
        compliance_status:
          type: string

    - name: economic_impact
      type: object
      description: "Energy waste costs and repair payback analysis"
      schema:
        total_annual_waste_usd:
          type: float
        total_repair_cost_usd:
          type: float
        total_annual_savings_usd:
          type: float
        portfolio_roi_percent:
          type: float
        carbon_emissions_avoided_kg:
          type: float

  # ============================================================================
  # INTEGRATIONS
  # ============================================================================
  integrations:
    thermal_cameras:
      - name: FLIR
        protocol: "FLIR Atlas SDK"
        description: "FLIR thermal camera integration"
        required: false
      - name: Fluke
        protocol: "Fluke Connect API"
        description: "Fluke thermal camera integration"
        required: false
      - name: Testo
        protocol: "Testo IRSoft API"
        description: "Testo thermal camera integration"
        required: false
      - name: Optris
        protocol: "Optris PI Connect"
        description: "Optris thermal camera integration"
        required: false
      - name: InfraTec
        protocol: "IRBIS SDK"
        description: "InfraTec thermal camera integration"
        required: false

    cmms_systems:
      - name: SAP_PM
        protocol: "SAP RFC/BAPI"
        description: "SAP Plant Maintenance integration"
        required: false
      - name: IBM_Maximo
        protocol: "Maximo REST API"
        description: "IBM Maximo Asset Management integration"
        required: false
      - name: Oracle_EAM
        protocol: "Oracle REST API"
        description: "Oracle Enterprise Asset Management integration"
        required: false

    asset_management:
      - name: IBM_Maximo
        protocol: "Maximo REST API"
        description: "IBM Maximo Asset Management"
        required: false
      - name: SAP_EAM
        protocol: "SAP REST API"
        description: "SAP Enterprise Asset Management"
        required: false
      - name: Hexagon_EAM
        protocol: "Hexagon API"
        description: "Hexagon EAM integration"
        required: false

    weather_services:
      - name: OpenWeatherMap
        protocol: "REST API"
        description: "OpenWeatherMap weather data"
        required: false
      - name: NOAA
        protocol: "NOAA API"
        description: "NOAA weather service"
        required: false
      - name: DarkSky
        protocol: "DarkSky API"
        description: "Dark Sky weather API"
        required: false

    greenlang_agents:
      - name: GL-001_THERMOSYNC
        description: "Steam trap monitoring coordination"
        required: false
      - name: GL-006_HEATRECLAIM
        description: "Heat recovery network optimization"
        required: false
      - name: GL-014_EXCHANGER-PRO
        description: "Heat exchanger optimization coordination"
        required: false

  # ============================================================================
  # CAPABILITIES
  # ============================================================================
  capabilities:
    thermal_analysis:
      - thermal_image_processing
      - hotspot_detection
      - temperature_gradient_analysis
      - emissivity_correction
      - reflected_temperature_compensation

    heat_loss_calculation:
      - stefan_boltzmann_heat_flux
      - convective_heat_transfer
      - conductive_heat_loss
      - wind_chill_correction
      - solar_loading_compensation

    degradation_analysis:
      - insulation_condition_assessment
      - moisture_detection
      - cui_risk_assessment
      - damage_type_classification
      - remaining_life_estimation

    repair_optimization:
      - roi_based_prioritization
      - payback_period_calculation
      - repair_cost_estimation
      - work_order_generation

    economic_analysis:
      - energy_cost_calculation
      - savings_projection
      - carbon_footprint_analysis
      - portfolio_optimization

  # ============================================================================
  # COMPLIANCE
  # ============================================================================
  compliance:
    standards:
      - standard: ASTM_C1055
        version: "2020"
        description: "Standard Guide for Heated System Surface Conditions"
      - standard: ASTM_C680
        version: "2019"
        description: "Determination of Heat Gain or Loss by Insulation Systems"
      - standard: CINI_Manual
        version: "4.0"
        description: "CINI Insulation Manual for Industrial Applications"
      - standard: ISO_12241
        version: "2022"
        description: "Thermal Insulation for Building Equipment"
      - standard: ASHRAE_90.1
        version: "2022"
        description: "Energy Standard for Buildings"
      - standard: 3E_Plus
        version: "4.1"
        description: "NAIMA 3E Plus Insulation Thickness Software"

    audit_trail:
      enabled: true
      retention_days: 2555  # 7 years
      provenance_tracking: true
      hash_algorithm: SHA-256

    zero_hallucination: true
    deterministic_calculations: true

  # ============================================================================
  # MONITORING
  # ============================================================================
  monitoring:
    metrics_enabled: true
    metrics_port: 8001
    metrics_path: /metrics

    dashboards:
      - agent_performance
      - insulation_condition
      - heat_loss_trends
      - repair_backlog
      - economic_impact

    alerts:
      - name: critical_heat_loss
        condition: "heat_loss > threshold * 3"
        severity: critical
      - name: high_cui_risk
        condition: "cui_risk == critical"
        severity: critical
      - name: degraded_insulation
        condition: "condition == poor or condition == critical"
        severity: warning
      - name: overdue_inspection
        condition: "days_since_inspection > max_interval"
        severity: warning

  # ============================================================================
  # SECURITY
  # ============================================================================
  security:
    authentication: jwt
    authorization: rbac
    encryption: tls_1_3
    secrets_management: kubernetes
    api_key_required: true
    audit_logging: true

  # ============================================================================
  # DEPLOYMENT
  # ============================================================================
  deployment:
    replicas: 2
    strategy: rolling_update
    max_surge: 1
    max_unavailable: 0

    health_check:
      path: /health
      interval: 30s
      timeout: 10s
      failure_threshold: 3

    readiness_check:
      path: /readiness
      interval: 10s
      timeout: 5s
      failure_threshold: 3

    liveness_check:
      path: /liveness
      interval: 30s
      timeout: 10s
      failure_threshold: 3

# ==============================================================================
# AUTHOR & DOCUMENTATION
# ==============================================================================
authors:
  - name: GreenLang AI Agent Factory
    email: agents@greenlang.io

repository: https://github.com/greenlang/agents/gl-015
documentation: https://docs.greenlang.io/agents/gl-015
changelog: https://github.com/greenlang/agents/gl-015/blob/main/CHANGELOG.md

tags:
  - insulation
  - thermal-imaging
  - heat-loss
  - energy-conservation
  - infrared
  - inspection
  - industrial
  - CUI
  - corrosion
  - maintenance
  - ASTM
  - predictive-maintenance
