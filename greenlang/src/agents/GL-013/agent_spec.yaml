# GreenLang AgentSpec v2.0
# GL-013 PREDICTMAINT PredictiveMaintenanceAgent
# Complete agent specification for predictive maintenance operations
# Target: $10B TAM | Priority: P1 | Release: Q1 2026

apiVersion: greenlang.io/v2
kind: AgentSpec

# =============================================================================
# METADATA SECTION
# =============================================================================
metadata:
  name: PredictiveMaintenanceAgent
  version: "1.0.0"
  agent_id: GL-013
  codename: PREDICTMAINT
  labels:
    type: predictor
    category: Maintenance
    domain: predictive_maintenance
    priority: P1
    complexity: high
    id: GL-013
  annotations:
    description: "Predicts equipment failures before they occur using ML models and deterministic calculations"
    created_by: "GreenLang Team"
    created_date: "2024-12-01"
    last_modified: "2024-12-01"
    documentation: "https://greenlang.io/agents/GL-013"
    tam: "$10B"
    target_date: "Q1 2026"
    support_contact: "support@greenlang.io"
    business_value: "Reduce unplanned downtime by 50%, extend equipment life by 25%"

# =============================================================================
# SPECIFICATION SECTION
# =============================================================================
spec:
  # ---------------------------------------------------------------------------
  # Input Specifications with Full Schema
  # ---------------------------------------------------------------------------
  inputs:
    # Vibration Data Input
    - name: vibration_data
      type: object
      required: true
      description: "Sensor data from accelerometers including velocity and acceleration measurements"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
            description: "Unique identifier for the equipment"
          timestamp:
            type: string
            format: datetime
            description: "ISO 8601 timestamp of measurement"
          velocity_mm_s_rms:
            type: number
            description: "Velocity in mm/s RMS (Root Mean Square)"
            minimum: 0
            maximum: 100
          acceleration_g:
            type: number
            description: "Acceleration in g units"
            minimum: 0
            maximum: 50
          frequency_hz:
            type: number
            description: "Dominant frequency in Hz"
            minimum: 0
            maximum: 10000
          peak_to_peak_mm:
            type: number
            description: "Peak-to-peak displacement in mm"
            minimum: 0
          crest_factor:
            type: number
            description: "Crest factor (peak/RMS ratio)"
            minimum: 1
          kurtosis:
            type: number
            description: "Kurtosis value for impulsiveness detection"
          spectrum_data:
            type: array
            items:
              type: object
              properties:
                frequency_hz:
                  type: number
                amplitude:
                  type: number
            description: "Frequency spectrum data points"
          measurement_point:
            type: string
            description: "Location of measurement (DE, NDE, Axial)"
            enum: ["DE", "NDE", "AXIAL", "HORIZONTAL", "VERTICAL"]
        required:
          - equipment_id
          - timestamp
          - velocity_mm_s_rms
          - acceleration_g

    # Temperature Data Input
    - name: temperature_data
      type: object
      required: true
      description: "RTD/thermocouple readings from equipment"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
            description: "Unique identifier for the equipment"
          timestamp:
            type: string
            format: datetime
            description: "ISO 8601 timestamp of measurement"
          bearing_temp_c:
            type: number
            description: "Bearing temperature in Celsius"
            minimum: -40
            maximum: 200
          winding_temp_c:
            type: number
            description: "Motor winding temperature in Celsius"
            minimum: -40
            maximum: 250
          ambient_temp_c:
            type: number
            description: "Ambient temperature in Celsius"
            minimum: -50
            maximum: 60
          oil_temp_c:
            type: number
            description: "Lubricant oil temperature in Celsius"
            minimum: -40
            maximum: 150
          delta_temp_c:
            type: number
            description: "Temperature rise above ambient"
          rate_of_change_c_hr:
            type: number
            description: "Rate of temperature change per hour"
          thermal_image_url:
            type: string
            format: uri
            description: "URL to thermal image if available"
        required:
          - equipment_id
          - timestamp
          - bearing_temp_c

    # Pressure Data Input
    - name: pressure_data
      type: object
      required: false
      description: "Pressure transmitter readings"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
            description: "Unique identifier for the equipment"
          timestamp:
            type: string
            format: datetime
          inlet_pressure_bar:
            type: number
            description: "Inlet pressure in bar"
            minimum: 0
          outlet_pressure_bar:
            type: number
            description: "Outlet pressure in bar"
            minimum: 0
          differential_pressure_bar:
            type: number
            description: "Differential pressure across equipment"
          suction_pressure_psi:
            type: number
            description: "Suction pressure in PSI"
          discharge_pressure_psi:
            type: number
            description: "Discharge pressure in PSI"
          seal_pressure_bar:
            type: number
            description: "Seal system pressure"
        required:
          - equipment_id
          - timestamp

    # Operating Hours Input
    - name: operating_hours
      type: object
      required: true
      description: "Equipment runtime counters and operational data"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
            description: "Unique identifier for the equipment"
          total_run_hours:
            type: number
            description: "Total accumulated running hours"
            minimum: 0
          hours_since_last_maintenance:
            type: number
            description: "Hours since last scheduled maintenance"
            minimum: 0
          hours_since_last_failure:
            type: number
            description: "Hours since last unplanned failure"
            minimum: 0
          start_count:
            type: integer
            description: "Total number of equipment starts"
            minimum: 0
          load_cycles:
            type: integer
            description: "Number of load cycles"
            minimum: 0
          average_load_percent:
            type: number
            description: "Average load as percentage of rated capacity"
            minimum: 0
            maximum: 150
          operating_efficiency_percent:
            type: number
            description: "Current operating efficiency"
            minimum: 0
            maximum: 100
          last_reading_timestamp:
            type: string
            format: datetime
        required:
          - equipment_id
          - total_run_hours

    # Maintenance History Input
    - name: maintenance_history
      type: object
      required: true
      description: "Historical work orders and repairs from CMMS"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
            description: "Unique identifier for the equipment"
          work_orders:
            type: array
            items:
              type: object
              properties:
                work_order_id:
                  type: string
                work_order_type:
                  type: string
                  enum: ["PREVENTIVE", "CORRECTIVE", "PREDICTIVE", "EMERGENCY", "INSPECTION"]
                description:
                  type: string
                failure_code:
                  type: string
                failure_mode:
                  type: string
                root_cause:
                  type: string
                parts_replaced:
                  type: array
                  items:
                    type: string
                labor_hours:
                  type: number
                total_cost_usd:
                  type: number
                completed_date:
                  type: string
                  format: datetime
                downtime_hours:
                  type: number
          failure_history:
            type: array
            items:
              type: object
              properties:
                failure_date:
                  type: string
                  format: datetime
                failure_mode:
                  type: string
                severity:
                  type: string
                  enum: ["MINOR", "MODERATE", "MAJOR", "CRITICAL"]
                time_to_repair_hours:
                  type: number
                cost_usd:
                  type: number
          mean_time_between_failures_hours:
            type: number
            description: "MTBF calculated from historical data"
          mean_time_to_repair_hours:
            type: number
            description: "MTTR calculated from historical data"
        required:
          - equipment_id

    # Equipment Parameters Input
    - name: equipment_parameters
      type: object
      required: true
      description: "Nameplate data and equipment specifications"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
            description: "Unique identifier for the equipment"
          equipment_type:
            type: string
            description: "Type of equipment"
            enum: ["PUMP", "MOTOR", "COMPRESSOR", "FAN", "GEARBOX", "BEARING", "TURBINE", "GENERATOR", "CONVEYOR", "VALVE"]
          manufacturer:
            type: string
            description: "Equipment manufacturer"
          model:
            type: string
            description: "Model number"
          serial_number:
            type: string
            description: "Serial number"
          installation_date:
            type: string
            format: date
            description: "Date of installation"
          rated_power_kw:
            type: number
            description: "Rated power in kW"
            minimum: 0
          rated_speed_rpm:
            type: number
            description: "Rated speed in RPM"
            minimum: 0
          rated_voltage_v:
            type: number
            description: "Rated voltage in Volts"
          rated_current_a:
            type: number
            description: "Rated current in Amperes"
          bearing_type:
            type: string
            description: "Type of bearing installed"
          bearing_manufacturer:
            type: string
          bearing_model:
            type: string
          lubrication_type:
            type: string
            enum: ["OIL", "GREASE", "SELF_LUBRICATING", "WATER"]
          criticality:
            type: string
            description: "Equipment criticality rating"
            enum: ["A", "B", "C", "D"]
          design_life_years:
            type: number
            description: "Expected design life in years"
          iso_vibration_class:
            type: string
            description: "ISO 10816 vibration class"
            enum: ["I", "II", "III", "IV"]
          alarm_thresholds:
            type: object
            properties:
              vibration_alert_mm_s:
                type: number
              vibration_alarm_mm_s:
                type: number
              temperature_alert_c:
                type: number
              temperature_alarm_c:
                type: number
        required:
          - equipment_id
          - equipment_type
          - criticality

    # CMMS Integration Input
    - name: cmms_data
      type: object
      required: false
      description: "Data from Computerized Maintenance Management System"
      schema:
        type: object
        properties:
          system_type:
            type: string
            description: "CMMS system type"
            enum: ["SAP_PM", "MAXIMO", "FIIX", "UPKEEP", "MAINTENANCE_CONNECTION", "CUSTOM"]
          connection_status:
            type: string
            enum: ["CONNECTED", "DISCONNECTED", "ERROR"]
          pending_work_orders:
            type: array
            items:
              type: object
              properties:
                work_order_id:
                  type: string
                priority:
                  type: string
                scheduled_date:
                  type: string
                  format: datetime
          spare_parts_inventory:
            type: array
            items:
              type: object
              properties:
                part_number:
                  type: string
                description:
                  type: string
                quantity_on_hand:
                  type: integer
                reorder_point:
                  type: integer
                lead_time_days:
                  type: integer
          maintenance_schedules:
            type: array
            items:
              type: object
              properties:
                schedule_id:
                  type: string
                equipment_id:
                  type: string
                task_description:
                  type: string
                frequency_days:
                  type: integer
                next_due_date:
                  type: string
                  format: date

    # Condition Monitoring System Input
    - name: cms_data
      type: object
      required: false
      description: "Data from online Condition Monitoring Systems"
      schema:
        type: object
        properties:
          system_type:
            type: string
            description: "CMS vendor/type"
            enum: ["SKF_ENLIGHT", "EMERSON_AMS", "GE_BENTLY", "HONEYWELL", "ROCKWELL", "CUSTOM"]
          equipment_id:
            type: string
          online_monitoring_enabled:
            type: boolean
          last_sync_timestamp:
            type: string
            format: datetime
          overall_health_score:
            type: number
            minimum: 0
            maximum: 100
          alerts:
            type: array
            items:
              type: object
              properties:
                alert_id:
                  type: string
                severity:
                  type: string
                  enum: ["INFO", "WARNING", "ALERT", "ALARM", "DANGER"]
                parameter:
                  type: string
                value:
                  type: number
                threshold:
                  type: number
                timestamp:
                  type: string
                  format: datetime

  # ---------------------------------------------------------------------------
  # Output Specifications with Full Schema
  # ---------------------------------------------------------------------------
  outputs:
    # Maintenance Schedules Output
    - name: maintenance_schedules
      type: object
      description: "Optimized maintenance timing recommendations"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
          generated_timestamp:
            type: string
            format: datetime
          schedule_type:
            type: string
            enum: ["PREDICTIVE", "CONDITION_BASED", "TIME_BASED"]
          recommended_actions:
            type: array
            items:
              type: object
              properties:
                action_id:
                  type: string
                action_type:
                  type: string
                  enum: ["INSPECTION", "LUBRICATION", "ALIGNMENT", "BALANCING", "BEARING_REPLACEMENT", "OVERHAUL", "REPAIR"]
                description:
                  type: string
                priority:
                  type: string
                  enum: ["P1_CRITICAL", "P2_HIGH", "P3_MEDIUM", "P4_LOW"]
                recommended_date:
                  type: string
                  format: date
                deadline_date:
                  type: string
                  format: date
                estimated_duration_hours:
                  type: number
                estimated_cost_usd:
                  type: number
                required_parts:
                  type: array
                  items:
                    type: string
                required_skills:
                  type: array
                  items:
                    type: string
                confidence_percent:
                  type: number
                  minimum: 0
                  maximum: 100
          optimization_score:
            type: number
            minimum: 0
            maximum: 100
          cost_savings_usd:
            type: number
          downtime_savings_hours:
            type: number
          provenance_hash:
            type: string
            description: "SHA-256 hash for audit trail"

    # Failure Predictions Output
    - name: failure_predictions
      type: object
      description: "Equipment-specific failure forecasts"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
          prediction_timestamp:
            type: string
            format: datetime
          prediction_horizon_days:
            type: integer
          failure_modes:
            type: array
            items:
              type: object
              properties:
                failure_mode:
                  type: string
                  enum: ["BEARING_FAILURE", "MISALIGNMENT", "IMBALANCE", "LOOSENESS", "ELECTRICAL_FAULT", "LUBRICATION_FAILURE", "CAVITATION", "OVERHEATING", "WEAR", "FATIGUE"]
                probability_percent:
                  type: number
                  minimum: 0
                  maximum: 100
                confidence_interval:
                  type: object
                  properties:
                    lower_bound:
                      type: number
                    upper_bound:
                      type: number
                    confidence_level:
                      type: number
                estimated_time_to_failure_hours:
                  type: number
                severity:
                  type: string
                  enum: ["LOW", "MEDIUM", "HIGH", "CRITICAL"]
                contributing_factors:
                  type: array
                  items:
                    type: string
                recommended_action:
                  type: string
          overall_failure_probability:
            type: number
            minimum: 0
            maximum: 100
          model_version:
            type: string
          provenance_hash:
            type: string

    # Parts Inventory Output
    - name: parts_inventory
      type: object
      description: "Spare parts requirements and forecasts"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
          forecast_timestamp:
            type: string
            format: datetime
          forecast_horizon_days:
            type: integer
          required_parts:
            type: array
            items:
              type: object
              properties:
                part_number:
                  type: string
                part_description:
                  type: string
                quantity_required:
                  type: integer
                required_by_date:
                  type: string
                  format: date
                current_stock:
                  type: integer
                reorder_required:
                  type: boolean
                estimated_cost_usd:
                  type: number
                lead_time_days:
                  type: integer
                supplier:
                  type: string
                criticality:
                  type: string
                  enum: ["CRITICAL", "ESSENTIAL", "STANDARD"]
          total_parts_cost_usd:
            type: number
          stockout_risk:
            type: boolean
          provenance_hash:
            type: string

    # Health Indices Output
    - name: health_indices
      type: object
      description: "Equipment health scores (0-100)"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
          assessment_timestamp:
            type: string
            format: datetime
          overall_health_score:
            type: number
            minimum: 0
            maximum: 100
          health_status:
            type: string
            enum: ["EXCELLENT", "GOOD", "SATISFACTORY", "POOR", "CRITICAL"]
          component_scores:
            type: object
            properties:
              mechanical_health:
                type: number
                minimum: 0
                maximum: 100
              electrical_health:
                type: number
                minimum: 0
                maximum: 100
              thermal_health:
                type: number
                minimum: 0
                maximum: 100
              lubrication_health:
                type: number
                minimum: 0
                maximum: 100
              structural_health:
                type: number
                minimum: 0
                maximum: 100
          trend:
            type: string
            enum: ["IMPROVING", "STABLE", "DEGRADING", "RAPIDLY_DEGRADING"]
          degradation_rate_percent_per_day:
            type: number
          historical_scores:
            type: array
            items:
              type: object
              properties:
                timestamp:
                  type: string
                  format: datetime
                score:
                  type: number
          iso_10816_compliance:
            type: object
            properties:
              zone:
                type: string
                enum: ["A", "B", "C", "D"]
              status:
                type: string
                enum: ["COMPLIANT", "WARNING", "NON_COMPLIANT"]
          provenance_hash:
            type: string

    # Remaining Useful Life Output
    - name: remaining_useful_life
      type: object
      description: "RUL estimates with confidence intervals"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
          calculation_timestamp:
            type: string
            format: datetime
          rul_hours:
            type: number
            description: "Estimated remaining useful life in hours"
            minimum: 0
          rul_days:
            type: number
            description: "Estimated remaining useful life in days"
            minimum: 0
          confidence_interval:
            type: object
            properties:
              lower_bound_hours:
                type: number
              upper_bound_hours:
                type: number
              confidence_level_percent:
                type: number
          end_of_life_date:
            type: string
            format: date
            description: "Estimated end-of-life date"
          calculation_method:
            type: string
            enum: ["WEIBULL", "EXPONENTIAL", "PHYSICS_BASED", "HYBRID"]
          degradation_model:
            type: object
            properties:
              model_type:
                type: string
              parameters:
                type: object
              r_squared:
                type: number
          sensitivity_analysis:
            type: object
            properties:
              best_case_rul_hours:
                type: number
              worst_case_rul_hours:
                type: number
              key_factors:
                type: array
                items:
                  type: string
          provenance_hash:
            type: string

    # Anomaly Alerts Output
    - name: anomaly_alerts
      type: object
      description: "Real-time condition alerts"
      schema:
        type: object
        properties:
          equipment_id:
            type: string
          alert_timestamp:
            type: string
            format: datetime
          alerts:
            type: array
            items:
              type: object
              properties:
                alert_id:
                  type: string
                alert_type:
                  type: string
                  enum: ["VIBRATION", "TEMPERATURE", "PRESSURE", "PERFORMANCE", "PATTERN"]
                severity:
                  type: string
                  enum: ["INFO", "WARNING", "ALERT", "ALARM", "DANGER"]
                parameter:
                  type: string
                current_value:
                  type: number
                threshold_value:
                  type: number
                deviation_percent:
                  type: number
                detection_method:
                  type: string
                  enum: ["THRESHOLD", "STATISTICAL", "ML_BASED", "PATTERN_RECOGNITION"]
                description:
                  type: string
                recommended_action:
                  type: string
                escalation_required:
                  type: boolean
                auto_acknowledged:
                  type: boolean
          total_alert_count:
            type: integer
          critical_alert_count:
            type: integer
          provenance_hash:
            type: string

    # Coordination Result Output
    - name: coordination_result
      type: object
      description: "Agent coordination result for multi-agent workflows"
      schema:
        type: object
        properties:
          coordination_id:
            type: string
          timestamp:
            type: string
            format: datetime
          coordinated_agents:
            type: array
            items:
              type: string
          status:
            type: string
            enum: ["SUCCESS", "PARTIAL", "FAILED"]
          messages_exchanged:
            type: integer
          processing_time_ms:
            type: number
          provenance_hash:
            type: string

  # ---------------------------------------------------------------------------
  # Agent Capabilities
  # ---------------------------------------------------------------------------
  capabilities:
    - name: remaining_useful_life_calculation
      description: "Calculate RUL using Weibull analysis and physics-based models"
      deterministic: true
      zero_hallucination: true
      standard: "ISO_13381"

    - name: failure_probability_estimation
      description: "Estimate failure probability using survival analysis"
      deterministic: true
      zero_hallucination: true
      standard: "FMEA"

    - name: vibration_analysis
      description: "Analyze vibration data per ISO 10816 standards"
      deterministic: true
      zero_hallucination: true
      standard: "ISO_10816"

    - name: thermal_degradation_analysis
      description: "Analyze thermal trends and degradation patterns"
      deterministic: true
      zero_hallucination: true
      standard: "ISO_13373"

    - name: maintenance_scheduling_optimization
      description: "Optimize maintenance schedules using cost-benefit analysis"
      deterministic: true
      zero_hallucination: true
      standard: "ISO_55000"

    - name: spare_parts_forecasting
      description: "Forecast spare parts requirements based on failure predictions"
      deterministic: true
      zero_hallucination: true

    - name: anomaly_detection
      description: "Detect anomalies using statistical and threshold methods"
      deterministic: true
      zero_hallucination: true
      standard: "ISO_17359"

    - name: condition_monitoring
      description: "Monitor equipment condition in real-time"
      deterministic: true
      zero_hallucination: true
      standard: "ISO_17359"

    - name: cmms_integration
      description: "Integrate with CMMS systems for work order management"
      deterministic: true

    - name: agent_coordination
      description: "Coordinate with other GreenLang agents via message bus"
      deterministic: true

  # ---------------------------------------------------------------------------
  # Tool Specifications (12 Deterministic Tools)
  # ---------------------------------------------------------------------------
  tools:
    - name: calculate_remaining_useful_life
      description: "Calculate RUL using Weibull distribution and degradation models"
      function: PredictiveMaintenanceTools.calculate_remaining_useful_life
      deterministic: true
      inputs:
        - operating_hours
        - maintenance_history
        - equipment_parameters
        - health_indices
      outputs:
        - RemainingUsefulLifeResult
      formula: |
        # Weibull-based RUL calculation
        # RUL = eta * (-ln(R(t)))^(1/beta) - t
        # where eta = scale parameter, beta = shape parameter
        # R(t) = reliability at time t

    - name: calculate_failure_probability
      description: "Calculate failure probability using survival analysis"
      function: PredictiveMaintenanceTools.calculate_failure_probability
      deterministic: true
      inputs:
        - operating_hours
        - maintenance_history
        - vibration_data
        - temperature_data
      outputs:
        - FailureProbabilityResult
      formula: |
        # Failure probability calculation
        # P(failure) = 1 - R(t) = 1 - exp(-(t/eta)^beta)
        # Hazard rate h(t) = (beta/eta) * (t/eta)^(beta-1)

    - name: analyze_vibration
      description: "Analyze vibration data per ISO 10816 standards"
      function: PredictiveMaintenanceTools.analyze_vibration
      deterministic: true
      inputs:
        - vibration_data
        - equipment_parameters
      outputs:
        - VibrationAnalysisResult
      standard: ISO_10816
      thresholds:
        class_I:
          zone_A: 0.71
          zone_B: 1.8
          zone_C: 4.5
          zone_D: 11.2
        class_II:
          zone_A: 1.12
          zone_B: 2.8
          zone_C: 7.1
          zone_D: 18.0
        class_III:
          zone_A: 1.8
          zone_B: 4.5
          zone_C: 11.2
          zone_D: 28.0
        class_IV:
          zone_A: 2.8
          zone_B: 7.1
          zone_C: 18.0
          zone_D: 45.0

    - name: analyze_thermal_degradation
      description: "Analyze thermal trends and predict degradation"
      function: PredictiveMaintenanceTools.analyze_thermal_degradation
      deterministic: true
      inputs:
        - temperature_data
        - equipment_parameters
        - operating_hours
      outputs:
        - ThermalAnalysisResult
      formula: |
        # Arrhenius-based thermal life calculation
        # L = L0 * exp(Ea / (k * (1/T - 1/T0)))
        # where Ea = activation energy, k = Boltzmann constant

    - name: optimize_maintenance_schedule
      description: "Optimize maintenance timing using cost-benefit analysis"
      function: PredictiveMaintenanceTools.optimize_maintenance_schedule
      deterministic: true
      inputs:
        - failure_predictions
        - remaining_useful_life
        - maintenance_history
        - cmms_data
      outputs:
        - MaintenanceScheduleResult
      optimization_method: "linear_programming"
      constraints:
        - minimize_total_cost
        - maximize_availability
        - respect_resource_capacity

    - name: forecast_spare_parts
      description: "Forecast spare parts requirements"
      function: PredictiveMaintenanceTools.forecast_spare_parts
      deterministic: true
      inputs:
        - failure_predictions
        - maintenance_schedules
        - cmms_data
      outputs:
        - SparePartsforecastResult

    - name: detect_anomalies
      description: "Detect anomalies in sensor data using statistical methods"
      function: PredictiveMaintenanceTools.detect_anomalies
      deterministic: true
      inputs:
        - vibration_data
        - temperature_data
        - pressure_data
      outputs:
        - AnomalyDetectionResult
      methods:
        - z_score
        - iqr
        - mahalanobis_distance
        - control_charts

    - name: calculate_health_index
      description: "Calculate overall equipment health index"
      function: PredictiveMaintenanceTools.calculate_health_index
      deterministic: true
      inputs:
        - vibration_data
        - temperature_data
        - pressure_data
        - operating_hours
        - equipment_parameters
      outputs:
        - HealthIndexResult
      formula: |
        # Weighted health index calculation
        # HI = sum(w_i * HI_i) for i in [mechanical, electrical, thermal, lubrication]
        # Each component HI_i = 100 - (degradation_factor * deviation_percent)

    - name: integrate_cmms
      description: "Integrate with CMMS for work order and inventory data"
      function: PredictiveMaintenanceTools.integrate_cmms
      deterministic: true
      inputs:
        - cmms_data
      outputs:
        - CMSSIntegrationResult
      supported_systems:
        - SAP_PM
        - MAXIMO
        - FIIX
        - UPKEEP
        - MAINTENANCE_CONNECTION

    - name: integrate_condition_monitoring
      description: "Integrate with condition monitoring systems"
      function: PredictiveMaintenanceTools.integrate_condition_monitoring
      deterministic: true
      inputs:
        - cms_data
      outputs:
        - CMSIntegrationResult
      supported_systems:
        - SKF_ENLIGHT
        - EMERSON_AMS
        - GE_BENTLY
        - HONEYWELL
        - ROCKWELL

    - name: coordinate_agents
      description: "Coordinate with other GreenLang agents"
      function: PredictiveMaintenanceTools.coordinate_agents
      deterministic: true
      inputs:
        - agent_ids
        - coordination_request
      outputs:
        - CoordinationResult
      coordination_patterns:
        - request_response
        - publish_subscribe
        - scatter_gather

    - name: generate_maintenance_report
      description: "Generate comprehensive maintenance report"
      function: PredictiveMaintenanceTools.generate_maintenance_report
      deterministic: true
      inputs:
        - health_indices
        - failure_predictions
        - maintenance_schedules
        - remaining_useful_life
      outputs:
        - MaintenanceReportResult
      report_formats:
        - json
        - pdf
        - excel

  # ---------------------------------------------------------------------------
  # Requirements
  # ---------------------------------------------------------------------------
  requirements:
    python_version: ">=3.10"
    memory_mb: 4096
    cpu_cores: 4
    gpu_required: false
    packages:
      - numpy>=1.24.0
      - scipy>=1.10.0
      - pandas>=2.0.0
      - scikit-learn>=1.3.0
      - pydantic>=2.0.0
      - fastapi>=0.100.0
      - prometheus-client>=0.17.0
      - httpx>=0.24.0
      - reliability>=0.8.0
      - statsmodels>=0.14.0

# =============================================================================
# AI CONFIGURATION
# =============================================================================
ai_config:
  provider: anthropic
  model: claude-sonnet-4-20250514
  temperature: 0.0
  seed: 42
  deterministic: true
  max_tokens: 4096
  allowed_operations:
    - classification
    - entity_resolution
    - natural_language_generation
    - failure_mode_classification
    - work_order_categorization
    - narrative_summary_generation
  prohibited_operations:
    - numeric_calculation
    - failure_probability_generation
    - rul_estimation
    - health_score_calculation
    - threshold_determination

# =============================================================================
# RUNTIME CONFIGURATION
# =============================================================================
runtime:
  timeout_seconds: 120
  max_retries: 3
  cache_ttl_seconds: 300
  max_parallel_agents: 10
  checkpoint_enabled: true
  checkpoint_interval_seconds: 300
  batch_processing:
    enabled: true
    max_batch_size: 1000
    parallel_workers: 4

# =============================================================================
# COMPLIANCE CONFIGURATION
# =============================================================================
compliance:
  standards:
    - ISO_10816  # Mechanical vibration evaluation
    - ISO_13373  # Condition monitoring and diagnostics
    - ISO_17359  # General guidelines for condition monitoring
    - ISO_55000  # Asset management
    - IEC_61511  # Functional safety
    - ASME       # American Society of Mechanical Engineers
  audit_trail:
    enabled: true
    retention_days: 2555  # 7 years for regulatory compliance
    storage_format: "json"
    encryption: true
  provenance_tracking:
    enabled: true
    hash_algorithm: SHA-256
    include_timestamps: true
    include_model_versions: true
  zero_hallucination:
    enabled: true
    llm_prohibited_for:
      - numeric_calculations
      - failure_probability_estimation
      - rul_estimation
      - health_score_calculation
      - threshold_comparisons
    llm_allowed_for:
      - failure_mode_classification
      - work_order_description_parsing
      - narrative_report_generation
  validation_rules:
    count: 250
    categories:
      - input_validation
      - output_validation
      - threshold_validation
      - consistency_validation
      - regulatory_compliance

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================
monitoring:
  prometheus:
    enabled: true
    port: 9090
    path: /metrics
    scrape_interval: 15s
    metrics:
      - name: predictmaint_predictions_total
        type: counter
        help: "Total number of predictions made"
      - name: predictmaint_prediction_latency_seconds
        type: histogram
        help: "Prediction latency in seconds"
      - name: predictmaint_health_score
        type: gauge
        help: "Current equipment health score"
      - name: predictmaint_rul_hours
        type: gauge
        help: "Current RUL estimate in hours"
      - name: predictmaint_alerts_total
        type: counter
        help: "Total number of alerts generated"
        labels: ["severity"]
      - name: predictmaint_cache_hit_ratio
        type: gauge
        help: "Cache hit ratio"
  grafana:
    enabled: true
    dashboards:
      - predictive_maintenance_overview
      - equipment_health_monitoring
      - failure_predictions
      - maintenance_schedule_optimization
      - rul_tracking
      - anomaly_detection
  alerts:
    - name: high_failure_probability
      condition: "failure_probability > 80%"
      severity: critical
      notification_channels:
        - email
        - slack
        - pagerduty
    - name: low_health_score
      condition: "health_score < 40"
      severity: critical
      notification_channels:
        - email
        - slack
    - name: rul_threshold
      condition: "rul_days < 30"
      severity: warning
      notification_channels:
        - email
    - name: anomaly_detected
      condition: "anomaly_severity == ALARM"
      severity: high
      notification_channels:
        - email
        - slack
    - name: prediction_latency
      condition: "latency_p99 > 2000ms"
      severity: warning
      notification_channels:
        - slack
  health_check:
    enabled: true
    interval_seconds: 30
    endpoints:
      - /health
      - /ready

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
security:
  authentication:
    type: oauth2
    provider: keycloak
    required: true
  authorization:
    type: rbac
    roles:
      - name: admin
        permissions:
          - read
          - write
          - delete
          - configure
      - name: maintenance_engineer
        permissions:
          - read
          - write
          - acknowledge_alerts
      - name: operator
        permissions:
          - read
          - acknowledge_alerts
      - name: viewer
        permissions:
          - read
  encryption:
    at_rest: AES_256
    in_transit: TLS_1_3
    key_rotation_days: 90
  audit:
    enabled: true
    retention_days: 2555
    log_level: INFO
    include_request_body: true
    include_response_body: false
  secrets_management:
    provider: hashicorp_vault
    path: "secret/greenlang/gl-013"

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================
deployment:
  replicas: 3
  strategy: RollingUpdate
  max_surge: 1
  max_unavailable: 0
  resources:
    requests:
      memory: "2Gi"
      cpu: "1000m"
    limits:
      memory: "4Gi"
      cpu: "4000m"
  autoscaling:
    enabled: true
    min_replicas: 2
    max_replicas: 10
    target_cpu_utilization: 70
    target_memory_utilization: 80
    scale_down_stabilization_seconds: 300
  health_check:
    liveness_probe:
      path: /health
      port: 8080
      initial_delay_seconds: 30
      period_seconds: 10
      timeout_seconds: 5
      failure_threshold: 3
    readiness_probe:
      path: /ready
      port: 8080
      initial_delay_seconds: 5
      period_seconds: 5
      timeout_seconds: 3
      failure_threshold: 3
  environment:
    - name: LOG_LEVEL
      value: INFO
    - name: METRICS_ENABLED
      value: "true"
    - name: CACHE_TTL_SECONDS
      value: "300"
    - name: DETERMINISTIC_MODE
      value: "true"
    - name: ZERO_HALLUCINATION
      value: "true"
  node_selector:
    workload-type: computation
  tolerations:
    - key: "dedicated"
      operator: "Equal"
      value: "greenlang"
      effect: "NoSchedule"
  affinity:
    pod_anti_affinity:
      preferred_during_scheduling_ignored_during_execution:
        - weight: 100
          pod_affinity_term:
            label_selector:
              match_expressions:
                - key: app
                  operator: In
                  values:
                    - gl-013-predictmaint
            topology_key: kubernetes.io/hostname

# =============================================================================
# INTEGRATION CONFIGURATION
# =============================================================================
integrations:
  # CMMS Integrations
  - name: sap_pm
    type: cmms
    protocol: rest_api
    description: "SAP Plant Maintenance integration"
    config:
      base_url: "${SAP_PM_URL}"
      auth_type: oauth2
      sync_interval_minutes: 15
  - name: maximo
    type: cmms
    protocol: rest_api
    description: "IBM Maximo integration"
    config:
      base_url: "${MAXIMO_URL}"
      auth_type: api_key
      sync_interval_minutes: 15

  # Condition Monitoring System Integrations
  - name: skf_enlight
    type: condition_monitoring
    protocol: rest_api
    description: "SKF Enlight condition monitoring"
    config:
      base_url: "${SKF_URL}"
      streaming_enabled: true
  - name: emerson_ams
    type: condition_monitoring
    protocol: opc_ua
    description: "Emerson AMS integration"
    config:
      endpoint: "${EMERSON_ENDPOINT}"
      security_mode: SignAndEncrypt

  # Agent Coordination
  - name: greenlang_agents
    type: agent_coordination
    protocol: message_bus
    description: "GreenLang agent coordination"
    agents:
      - GL-001  # THERMOSYNC
      - GL-002  # Boiler control
      - GL-003  # Heat recovery
      - GL-014  # Energy optimizer

  # Data Sources
  - name: historian
    type: data_integration
    protocol: opc_ua
    description: "Process historian integration"
    config:
      endpoint: "${HISTORIAN_ENDPOINT}"
      sampling_interval_ms: 1000
  - name: scada
    type: data_integration
    protocol: opc_ua
    description: "SCADA system integration"
    config:
      endpoint: "${SCADA_ENDPOINT}"
      security_mode: SignAndEncrypt

# =============================================================================
# DATA RETENTION CONFIGURATION
# =============================================================================
data_retention:
  raw_sensor_data:
    retention_days: 90
    compression: true
    archive_to: s3
  processed_data:
    retention_days: 365
    compression: true
  predictions:
    retention_days: 2555  # 7 years
    compression: true
  audit_logs:
    retention_days: 2555  # 7 years
    immutable: true
  reports:
    retention_days: 2555  # 7 years

# =============================================================================
# FEATURE FLAGS
# =============================================================================
feature_flags:
  ml_enhanced_predictions: false
  real_time_streaming: true
  auto_work_order_creation: false
  advanced_analytics: true
  multi_equipment_correlation: false

# =============================================================================
# METADATA
# =============================================================================
metadata_extended:
  author: "GreenLang Team"
  created_date: "2024-12-01"
  last_modified: "2024-12-01"
  documentation_url: "https://greenlang.io/agents/GL-013"
  support_contact: "support@greenlang.io"
  repository: "https://github.com/greenlang/gl-013-predictmaint"
  changelog_url: "https://greenlang.io/agents/GL-013/changelog"
  tags:
    - predictive_maintenance
    - condition_monitoring
    - reliability
    - asset_management
    - industrial
    - iot
    - maintenance_optimization
  business_metrics:
    target_downtime_reduction_percent: 50
    target_maintenance_cost_reduction_percent: 30
    target_equipment_life_extension_percent: 25
    target_availability_percent: 99.5
