# ============================================================================
# CSRD/ESRS PLATFORM - PRODUCTION ENVIRONMENT CONFIGURATION
# ============================================================================
#
# INSTRUCTIONS:
# 1. Copy this file to .env.production
# 2. Fill in all values marked with CHANGE_ME or REQUIRED
# 3. NEVER commit .env.production to version control
# 4. Store production secrets in a secure vault (HashiCorp Vault, AWS Secrets Manager, etc.)
#
# Security Best Practices:
# - Use strong, unique passwords (min 32 characters)
# - Rotate credentials every 90 days
# - Enable encryption at rest and in transit
# - Limit access using principle of least privilege
# - Enable audit logging
# - Use environment-specific keys (never reuse between environments)
# ============================================================================

# ----------------------------------------------------------------------------
# ENVIRONMENT CONFIGURATION
# ----------------------------------------------------------------------------

# Environment name: production, staging, development
ENVIRONMENT=production

# Application version
VERSION=1.0.0

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Enable debug mode (NEVER enable in production)
DEBUG=false

# Enable detailed error traces (disable in production for security)
DETAILED_ERROR_TRACES=false

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------

# PostgreSQL connection (REQUIRED)
# Format: postgresql://username:password@host:port/database
DATABASE_URL=postgresql://csrd_user:CHANGE_ME_STRONG_PASSWORD@localhost:5432/csrd_db

# Alternative: Individual database parameters
DB_HOST=localhost
DB_PORT=5432
DB_NAME=csrd_db
DB_USERNAME=csrd_user
DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Database pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# Enable SSL for database connections (recommended for production)
DB_SSL_MODE=require

# ----------------------------------------------------------------------------
# CACHE CONFIGURATION (Redis)
# ----------------------------------------------------------------------------

# Redis connection (REQUIRED)
REDIS_URL=redis://localhost:6379/0

# Alternative: Individual Redis parameters
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD

# Redis cache settings
CACHE_TTL_SECONDS=3600
CACHE_MAX_SIZE_MB=512

# ----------------------------------------------------------------------------
# VECTOR DATABASE (Weaviate)
# ----------------------------------------------------------------------------

# Weaviate connection for RAG and semantic search
WEAVIATE_URL=http://localhost:8080
WEAVIATE_API_KEY=CHANGE_ME_WEAVIATE_API_KEY

# Weaviate settings
WEAVIATE_TIMEOUT=30
WEAVIATE_BATCH_SIZE=100

# ----------------------------------------------------------------------------
# AI/LLM API KEYS (REQUIRED)
# ----------------------------------------------------------------------------

# Anthropic Claude API (primary LLM)
ANTHROPIC_API_KEY=sk-ant-api03-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# OpenAI API (alternative LLM)
OPENAI_API_KEY=sk-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# Pinecone (vector database alternative)
PINECONE_API_KEY=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
PINECONE_ENVIRONMENT=us-east-1-aws

# LLM model selection
LLM_MODEL_PRIMARY=claude-3-opus-20240229
LLM_MODEL_FALLBACK=gpt-4-turbo-preview
LLM_MAX_TOKENS=4096
LLM_TEMPERATURE=0.0

# ----------------------------------------------------------------------------
# SECURITY & ENCRYPTION (CRITICAL - REQUIRED)
# ----------------------------------------------------------------------------

# Secret key for JWT tokens and session management (REQUIRED)
# Generate with: openssl rand -base64 32
SECRET_KEY=CHANGE_ME_SECRET_KEY_MINIMUM_32_CHARACTERS_RANDOM_STRING

# Encryption key for sensitive ESG data (REQUIRED)
# Generate with: python -c 'from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())'
# CRITICAL: Store this key securely! If lost, encrypted data cannot be recovered.
CSRD_ENCRYPTION_KEY=CHANGE_ME_BASE64_ENCODED_ENCRYPTION_KEY

# Enable encryption for sensitive data (REQUIRED: true in production)
ENCRYPT_SENSITIVE_DATA=true

# Key rotation settings
ENCRYPTION_KEY_ROTATION_DAYS=90
ENCRYPTION_KEY_GRACE_PERIOD_DAYS=30

# CORS allowed origins (comma-separated)
CORS_ORIGINS=https://yourdomain.com,https://app.yourdomain.com

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST=20

# ----------------------------------------------------------------------------
# APPLICATION SETTINGS
# ----------------------------------------------------------------------------

# API server settings
HOST=0.0.0.0
PORT=8000

# Number of worker processes/threads
WORKERS=4
WORKER_PROCESSES=4

# Request timeouts (seconds)
REQUEST_TIMEOUT=300
WORKER_TIMEOUT=300

# Maximum file upload size (MB)
MAX_FILE_SIZE_MB=500

# Output directory for generated reports
OUTPUT_DIR=/app/output

# Data directory for reference data
DATA_DIR=/app/data

# Log directory
LOG_DIR=/app/logs

# ----------------------------------------------------------------------------
# FEATURE FLAGS
# ----------------------------------------------------------------------------

# Enable AI-powered materiality assessment
ENABLE_AI_MATERIALITY=true

# Enable AI-generated narratives
ENABLE_AI_NARRATIVES=true

# Enable XBRL generation
ENABLE_XBRL_GENERATION=true

# Enable email notifications
ENABLE_EMAIL_NOTIFICATIONS=false

# Enable Sentry error tracking
ENABLE_SENTRY=true

# Enable Prometheus metrics
ENABLE_PROMETHEUS_METRICS=true

# ----------------------------------------------------------------------------
# EMAIL NOTIFICATIONS (Optional)
# ----------------------------------------------------------------------------

# SMTP server configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=noreply@yourdomain.com
SMTP_PASSWORD=CHANGE_ME_SMTP_PASSWORD
SMTP_USE_TLS=true

# Email addresses
NOTIFICATION_EMAIL=sustainability@yourcompany.com
ADMIN_EMAIL=admin@yourcompany.com

# ----------------------------------------------------------------------------
# MONITORING & OBSERVABILITY
# ----------------------------------------------------------------------------

# Sentry error tracking
SENTRY_DSN=https://XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX@sentry.io/XXXXXXX
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Prometheus metrics
PROMETHEUS_PORT=9090
PROMETHEUS_PATH=/metrics

# Grafana
GRAFANA_URL=http://localhost:3000
GRAFANA_USER=admin
GRAFANA_PASSWORD=CHANGE_ME_GRAFANA_PASSWORD

# ----------------------------------------------------------------------------
# EXTERNAL SERVICES (Optional)
# ----------------------------------------------------------------------------

# AWS S3 (for cloud storage)
AWS_ACCESS_KEY_ID=AKIAXXXXXXXXXXXXXXXX
AWS_SECRET_ACCESS_KEY=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
AWS_S3_BUCKET=csrd-reports-production
AWS_REGION=us-east-1

# Azure Blob Storage (alternative)
AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=XXXX;AccountKey=XXXX
AZURE_CONTAINER_NAME=csrd-reports

# ----------------------------------------------------------------------------
# CSRD-SPECIFIC SETTINGS
# ----------------------------------------------------------------------------

# Default company information (for testing only)
DEFAULT_COMPANY_NAME=Example Manufacturing GmbH
DEFAULT_LEI_CODE=529900EXAMPLE0000001
DEFAULT_REPORTING_YEAR=2024
DEFAULT_COMPANY_COUNTRY=DE

# ESRS framework version
ESRS_VERSION=1.0
XBRL_TAXONOMY_VERSION=2024

# Data quality thresholds
DATA_QUALITY_THRESHOLD=0.95
COMPLIANCE_THRESHOLD=0.90

# Materiality thresholds
MATERIALITY_THRESHOLD_IMPACT=0.70
MATERIALITY_THRESHOLD_FINANCIAL=0.70

# ----------------------------------------------------------------------------
# PERFORMANCE TUNING
# ----------------------------------------------------------------------------

# Database query optimization
DB_QUERY_CACHE_ENABLED=true
DB_QUERY_CACHE_SIZE=1000

# API response caching
API_CACHE_ENABLED=true
API_CACHE_TTL=300

# Batch processing
BATCH_SIZE=1000
BATCH_TIMEOUT=1800

# Concurrent processing
MAX_CONCURRENT_JOBS=10
THREAD_POOL_SIZE=20

# ----------------------------------------------------------------------------
# BACKUP & DISASTER RECOVERY
# ----------------------------------------------------------------------------

# Backup configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_DESTINATION=s3://csrd-backups-production

# ----------------------------------------------------------------------------
# COMPLIANCE & AUDIT
# ----------------------------------------------------------------------------

# Enable audit logging
AUDIT_LOGGING_ENABLED=true
AUDIT_LOG_DESTINATION=/app/logs/audit.log

# Data retention policy (days)
DATA_RETENTION_DAYS=2555  # 7 years (EU requirement)

# Enable data anonymization for non-production exports
DATA_ANONYMIZATION_ENABLED=false

# ----------------------------------------------------------------------------
# KUBERNETES-SPECIFIC (if deploying to K8s)
# ----------------------------------------------------------------------------

# Kubernetes namespace
K8S_NAMESPACE=production

# Service account
K8S_SERVICE_ACCOUNT=csrd-app

# Pod annotations
K8S_POD_ANNOTATIONS=prometheus.io/scrape:true,prometheus.io/port:8000

# ----------------------------------------------------------------------------
# HEALTH CHECK CONFIGURATION
# ----------------------------------------------------------------------------

# Health check endpoints
HEALTH_CHECK_PATH=/health
READINESS_CHECK_PATH=/ready
LIVENESS_CHECK_PATH=/health

# Health check intervals (seconds)
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10

# ----------------------------------------------------------------------------
# ADDITIONAL NOTES
# ============================================================================
#
# 1. SECURITY CHECKLIST:
#    [ ] All passwords are strong and unique
#    [ ] All API keys are production keys (not test keys)
#    [ ] Encryption key is backed up securely
#    [ ] Database uses SSL/TLS
#    [ ] CORS is restricted to known domains
#    [ ] Rate limiting is enabled
#    [ ] Debug mode is disabled
#    [ ] Detailed error traces are disabled
#
# 2. REQUIRED SECRETS:
#    - DATABASE_URL or DB_PASSWORD
#    - REDIS_URL or REDIS_PASSWORD
#    - ANTHROPIC_API_KEY
#    - SECRET_KEY
#    - CSRD_ENCRYPTION_KEY
#
# 3. OPTIONAL BUT RECOMMENDED:
#    - SENTRY_DSN (error tracking)
#    - AWS credentials or AZURE credentials (cloud storage)
#    - SMTP credentials (email notifications)
#
# ============================================================================
