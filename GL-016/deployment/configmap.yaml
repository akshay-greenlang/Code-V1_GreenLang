---
# GL-016 WATERGUARD - Kubernetes ConfigMap
# Project: GreenLang Industrial Sustainability Framework
# Agent: Water Treatment Quality Control

apiVersion: v1
kind: ConfigMap
metadata:
  name: gl-016-waterguard-config
  namespace: greenlang
  labels:
    app: waterguard
    agent: gl-016
    component: water-treatment
    tier: agent
  annotations:
    description: "Water treatment agent configuration"
data:
  # ============================================================================
  # AGENT CONFIGURATION
  # ============================================================================
  AGENT_ID: "GL-016"
  AGENT_NAME: "WATERGUARD"
  AGENT_VERSION: "1.0.0"
  ENVIRONMENT: "production"

  # ============================================================================
  # API CONFIGURATION
  # ============================================================================
  API_HOST: "0.0.0.0"
  API_PORT: "8000"
  API_WORKERS: "4"
  API_TIMEOUT: "30"

  # ============================================================================
  # MONITORING & METRICS
  # ============================================================================
  METRICS_PORT: "9090"
  METRICS_ENABLED: "true"
  PROMETHEUS_ENDPOINT: "/metrics"

  # Logging
  LOG_LEVEL: "INFO"
  LOG_FORMAT: "json"
  LOG_OUTPUT: "stdout"

  # OpenTelemetry
  OTEL_ENABLED: "true"
  OTEL_EXPORTER_OTLP_ENDPOINT: "http://otel-collector.monitoring.svc.cluster.local:4317"
  OTEL_SERVICE_NAME: "gl-016-waterguard"

  # ============================================================================
  # SCADA INTEGRATION
  # ============================================================================
  SCADA_ENABLED: "true"
  SCADA_HOST: "scada.plant.local"
  SCADA_PORT: "4840"
  SCADA_PROTOCOL: "opcua"
  SCADA_TIMEOUT: "10"
  SCADA_RETRY_ATTEMPTS: "3"
  SCADA_RETRY_DELAY: "5"
  SCADA_KEEPALIVE_INTERVAL: "30"

  # ============================================================================
  # WATER QUALITY ANALYZERS
  # ============================================================================
  ANALYZER_ENABLED: "true"
  ANALYZER_PROTOCOL: "modbus"

  # pH Analyzer
  PH_ANALYZER_HOST: "192.168.1.101"
  PH_ANALYZER_PORT: "502"
  PH_ANALYZER_UNIT_ID: "1"

  # Turbidity Analyzer
  TURBIDITY_ANALYZER_HOST: "192.168.1.102"
  TURBIDITY_ANALYZER_PORT: "502"
  TURBIDITY_ANALYZER_UNIT_ID: "2"

  # Chlorine Analyzer
  CHLORINE_ANALYZER_HOST: "192.168.1.103"
  CHLORINE_ANALYZER_PORT: "502"
  CHLORINE_ANALYZER_UNIT_ID: "3"

  # Conductivity Analyzer
  CONDUCTIVITY_ANALYZER_HOST: "192.168.1.104"
  CONDUCTIVITY_ANALYZER_PORT: "502"
  CONDUCTIVITY_ANALYZER_UNIT_ID: "4"

  # ============================================================================
  # ERP INTEGRATION
  # ============================================================================
  ERP_ENABLED: "true"
  ERP_BASE_URL: "https://erp.company.com/api/v1"
  ERP_TIMEOUT: "15"

  # ============================================================================
  # WATER QUALITY PARAMETERS
  # ============================================================================

  # pH Limits
  PH_MIN: "6.5"
  PH_MAX: "8.5"
  PH_TARGET: "7.2"
  PH_ALARM_LOW: "6.0"
  PH_ALARM_HIGH: "9.0"

  # Turbidity (NTU)
  TURBIDITY_MAX: "1.0"
  TURBIDITY_ALARM: "2.0"

  # Chlorine (mg/L)
  CHLORINE_MIN: "0.2"
  CHLORINE_MAX: "2.0"
  CHLORINE_TARGET: "0.5"
  CHLORINE_ALARM_LOW: "0.1"
  CHLORINE_ALARM_HIGH: "3.0"

  # Conductivity (µS/cm)
  CONDUCTIVITY_MAX: "1500"
  CONDUCTIVITY_ALARM: "2000"

  # ============================================================================
  # CHEMICAL DOSING
  # ============================================================================

  # Dosing Control
  DOSING_ENABLED: "true"
  DOSING_MODE: "automatic"
  DOSING_SAFETY_LOCKOUT: "300"

  # pH Adjustment
  PH_UP_PUMP_ADDRESS: "DO_001"
  PH_DOWN_PUMP_ADDRESS: "DO_002"
  PH_UP_MAX_RATE: "10.0"
  PH_DOWN_MAX_RATE: "10.0"

  # Chlorination
  CHLORINE_PUMP_ADDRESS: "DO_003"
  CHLORINE_MAX_RATE: "5.0"

  # Coagulation
  COAGULANT_PUMP_ADDRESS: "DO_004"
  COAGULANT_MAX_RATE: "15.0"

  # ============================================================================
  # PREDICTIVE ANALYTICS
  # ============================================================================
  PREDICTION_ENABLED: "true"
  PREDICTION_INTERVAL: "300"
  PREDICTION_HORIZON: "3600"

  # Model paths
  MODEL_PH_PATH: "/app/models/ph_predictor.pkl"
  MODEL_TURBIDITY_PATH: "/app/models/turbidity_predictor.pkl"
  MODEL_CHLORINE_PATH: "/app/models/chlorine_predictor.pkl"

  # ============================================================================
  # DATA STORAGE
  # ============================================================================

  # Local cache
  CACHE_ENABLED: "true"
  CACHE_TYPE: "redis"
  REDIS_HOST: "redis.greenlang.svc.cluster.local"
  REDIS_PORT: "6379"
  REDIS_DB: "0"

  # Data retention
  DATA_RETENTION_DAYS: "90"
  ARCHIVE_ENABLED: "true"
  ARCHIVE_PATH: "/app/data/archives"

  # ============================================================================
  # SECURITY
  # ============================================================================

  # TLS/SSL
  TLS_ENABLED: "true"
  TLS_CERT_PATH: "/app/certs/server.crt"
  TLS_KEY_PATH: "/app/certs/server.key"
  TLS_CA_PATH: "/app/certs/ca.crt"

  # Authentication
  AUTH_ENABLED: "true"
  AUTH_TYPE: "jwt"
  JWT_ALGORITHM: "HS256"
  JWT_EXPIRATION: "3600"

  # API Keys
  API_KEY_REQUIRED: "true"

  # ============================================================================
  # INTER-AGENT COMMUNICATION
  # ============================================================================
  MESH_ENABLED: "true"
  MESH_DISCOVERY_SERVICE: "http://agent-mesh-discovery.greenlang.svc.cluster.local:8080"

  # Related agents
  AGENT_GL001_URL: "http://gl-001-thermosync.greenlang.svc.cluster.local:8000"
  AGENT_GL003_URL: "http://gl-003-flowmaster.greenlang.svc.cluster.local:8000"
  AGENT_GL009_URL: "http://gl-009-energyvault.greenlang.svc.cluster.local:8000"

  # ============================================================================
  # HEALTH & DIAGNOSTICS
  # ============================================================================
  HEALTH_CHECK_INTERVAL: "30"
  HEALTH_CHECK_TIMEOUT: "5"
  DIAGNOSTICS_ENABLED: "true"
  DEBUG_MODE: "false"

  # ============================================================================
  # BACKUP & RECOVERY
  # ============================================================================
  BACKUP_ENABLED: "true"
  BACKUP_INTERVAL: "3600"
  BACKUP_RETENTION: "7"
  BACKUP_PATH: "/app/backups"

  # ============================================================================
  # FEATURE FLAGS
  # ============================================================================
  FEATURE_PREDICTIVE_ANALYTICS: "true"
  FEATURE_AUTO_DOSING: "true"
  FEATURE_ADAPTIVE_CONTROL: "true"
  FEATURE_ANOMALY_DETECTION: "true"
  FEATURE_REMOTE_MONITORING: "true"

---
# Application configuration file
apiVersion: v1
kind: ConfigMap
metadata:
  name: gl-016-waterguard-app-config
  namespace: greenlang
  labels:
    app: waterguard
    agent: gl-016
data:
  app-config.yaml: |
    agent:
      id: GL-016
      name: WATERGUARD
      description: "Water Treatment Quality Control Agent"
      version: 1.0.0

    water_quality:
      parameters:
        - name: pH
          unit: "pH"
          range: [6.5, 8.5]
          target: 7.2
          tolerance: 0.2
          critical_low: 6.0
          critical_high: 9.0

        - name: turbidity
          unit: "NTU"
          range: [0, 1.0]
          target: 0.3
          tolerance: 0.2
          critical_high: 2.0

        - name: chlorine
          unit: "mg/L"
          range: [0.2, 2.0]
          target: 0.5
          tolerance: 0.1
          critical_low: 0.1
          critical_high: 3.0

        - name: conductivity
          unit: "µS/cm"
          range: [0, 1500]
          target: 800
          tolerance: 200
          critical_high: 2000

    dosing:
      chemicals:
        - name: ph_up
          type: base
          max_rate: 10.0
          unit: "L/h"

        - name: ph_down
          type: acid
          max_rate: 10.0
          unit: "L/h"

        - name: chlorine
          type: disinfectant
          max_rate: 5.0
          unit: "L/h"

        - name: coagulant
          type: clarifying
          max_rate: 15.0
          unit: "L/h"

    alarms:
      levels:
        - name: info
          priority: 4
          auto_ack: true

        - name: warning
          priority: 3
          auto_ack: false

        - name: alarm
          priority: 2
          auto_ack: false

        - name: critical
          priority: 1
          auto_ack: false
          notification: immediate
