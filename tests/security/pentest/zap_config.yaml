# OWASP ZAP Configuration for GreenLang Penetration Testing

# Global configuration
globalexcludeurl:
  - ".*\\.(jpg|jpeg|png|gif|css|js|ico|svg|woff|woff2|ttf)$"
  - ".*logout.*"
  - ".*signout.*"

# Authentication configuration
auth:
  method: "form"
  loginUrl: "https://api.greenlang.io/api/v1/auth/login"
  loginRequestData: "username={%username%}&password={%password%}"
  loginIndicator: "\\Qtoken\\E"
  logoutIndicator: "\\Qunauthorized\\E"
  excludeFromScan:
    - ".*logout.*"

# Context configuration
contexts:
  - name: "GreenLang API"
    urls:
      - "https://api.greenlang.io/api/v1/.*"
    includePaths:
      - "https://api.greenlang.io/api/v1/.*"
    excludePaths:
      - "https://api.greenlang.io/api/v1/auth/logout"
      - "https://api.greenlang.io/api/v1/admin/.*"  # Exclude admin endpoints from automated testing

# Scanner configuration
scanner:
  # Active scan configuration
  activeScan:
    enabled: true
    policyName: "Default Policy"
    strength: "MEDIUM"  # LOW, MEDIUM, HIGH, INSANE
    threshold: "MEDIUM"  # OFF, LOW, MEDIUM, HIGH

  # Passive scan configuration
  passiveScan:
    enabled: true

  # Spider configuration
  spider:
    enabled: true
    maxDepth: 5
    maxDuration: 10  # minutes
    maxChildren: 10
    acceptCookies: true
    handleODataParametersVisited: true

  # Ajax Spider configuration
  ajaxSpider:
    enabled: true
    maxDuration: 10  # minutes
    maxCrawlDepth: 10

# Attack strength for specific scan rules
rules:
  # SQL Injection
  - id: 40018
    name: "SQL Injection"
    strength: "HIGH"
    threshold: "LOW"

  # XSS
  - id: 40012
    name: "Cross Site Scripting (Reflected)"
    strength: "HIGH"
    threshold: "LOW"

  - id: 40014
    name: "Cross Site Scripting (Persistent)"
    strength: "HIGH"
    threshold: "LOW"

  # CSRF
  - id: 20012
    name: "Anti-CSRF Tokens Check"
    strength: "HIGH"
    threshold: "LOW"

  # Authentication
  - id: 10055
    name: "CSP Scanner"
    strength: "MEDIUM"
    threshold: "MEDIUM"

  # Authorization
  - id: 10094
    name: "Base64 Disclosure"
    strength: "MEDIUM"
    threshold: "MEDIUM"

  # Path Traversal
  - id: 6
    name: "Path Traversal"
    strength: "HIGH"
    threshold: "LOW"

  # Remote Code Execution
  - id: 90019
    name: "Server Side Code Injection"
    strength: "HIGH"
    threshold: "MEDIUM"

  # XXE
  - id: 90023
    name: "XML External Entity Attack"
    strength: "HIGH"
    threshold: "LOW"

# Report configuration
report:
  format: ["HTML", "JSON", "XML", "MD"]
  outputDir: "./zap-reports"
  includeConfidence:
    - "HIGH"
    - "MEDIUM"
    - "LOW"
  includeRiskLevel:
    - "HIGH"
    - "MEDIUM"
    - "LOW"
    - "INFORMATIONAL"

# API configuration
api:
  format: "openapi"  # openapi, soap, graphql
  definition: "https://api.greenlang.io/openapi.json"
  targetUrl: "https://api.greenlang.io"

# Rate limiting to avoid overwhelming the server
rateLimit:
  requestsPerSecond: 10
  delayBetweenRequests: 100  # milliseconds

# Session management
session:
  name: "GreenLang Session"
  sessionTokens:
    - "session"
    - "JSESSIONID"
    - "auth_token"

# Custom headers
headers:
  - name: "X-API-Key"
    value: "${API_KEY}"
  - name: "User-Agent"
    value: "OWASP-ZAP-Scanner/2.0"

# Technology detection
technology:
  # Automatically detect technologies
  detect: true
  # Known technologies for GreenLang
  include:
    - "Python"
    - "FastAPI"
    - "PostgreSQL"
    - "Redis"

# Alert filters
alertFilters:
  # Reduce false positives
  - ruleId: 10021  # X-Content-Type-Options
    newRisk: "INFORMATIONAL"

  - ruleId: 10020  # X-Frame-Options
    newRisk: "INFORMATIONAL"

# Breakpoints (for manual testing)
breakpoints:
  - type: "REQUEST"
    string: "POST.*"
    enabled: false

  - type: "RESPONSE"
    string: ".*error.*"
    enabled: false

# Performance tuning
performance:
  threads: 4
  hostPerScan: 1
  delayInMs: 0
  maxRuleDurationInMins: 5

# Output verbosity
verbosity:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  logToFile: true
  logFile: "./zap-scan.log"
