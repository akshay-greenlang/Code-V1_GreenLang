# GL-017_Condensync ConfigMap
# Non-sensitive configuration data for Condenser Optimization Agent
# Version: 1.0.0

---
# Main Application Configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: gl-017-condensync-config
  namespace: greenlang
  labels:
    app: gl-017-condensync
    app.kubernetes.io/name: gl-017-condensync
    app.kubernetes.io/component: config
data:
  # Application Settings
  APP_NAME: "GL-017_Condensync"
  APP_VERSION: "1.0.0"
  ENVIRONMENT: "production"
  AGENT_ID: "gl-017"
  AGENT_GROUP: "thermal"

  # Server Configuration
  SERVER_HOST: "0.0.0.0"
  SERVER_PORT: "8000"
  SERVER_WORKERS: "4"
  SERVER_TIMEOUT: "60"
  SERVER_GRACEFUL_TIMEOUT: "30"
  SERVER_KEEP_ALIVE: "5"

  # Logging Configuration
  LOG_LEVEL: "INFO"
  LOG_FORMAT: "json"
  LOG_OUTPUT: "stdout"
  LOG_INCLUDE_TIMESTAMP: "true"
  LOG_INCLUDE_CALLER: "true"

  # Condenser Optimization Settings
  CONDENSER_OPTIMIZATION_ENABLED: "true"
  CONDENSER_OPTIMIZATION_INTERVAL: "60"
  CONDENSER_PREDICTION_HORIZON: "3600"
  CONDENSER_EFFICIENCY_THRESHOLD: "0.85"
  CONDENSER_MAX_TEMPERATURE_DELTA: "10"
  CONDENSER_MIN_FLOW_RATE: "100"
  CONDENSER_PRESSURE_TOLERANCE: "0.05"

  # Model Configuration
  MODEL_UPDATE_INTERVAL: "3600"
  MODEL_RETRAIN_THRESHOLD: "0.1"
  MODEL_VALIDATION_SPLIT: "0.2"
  MODEL_CACHE_TTL: "86400"

  # Feature Flags
  feature-flags: |
    {
      "enable_metrics": true,
      "enable_tracing": true,
      "enable_profiling": false,
      "enable_debug_endpoints": false,
      "enable_rate_limiting": true,
      "enable_circuit_breaker": true,
      "enable_retry": true,
      "enable_caching": true,
      "enable_ml_predictions": true,
      "enable_realtime_optimization": true,
      "enable_anomaly_detection": true,
      "enable_auto_tuning": false
    }

  # Rate Limiting Configuration
  RATE_LIMIT_ENABLED: "true"
  RATE_LIMIT_REQUESTS_PER_MINUTE: "100"
  RATE_LIMIT_BURST: "20"
  RATE_LIMIT_STRATEGY: "sliding_window"

  # Circuit Breaker Configuration
  CIRCUIT_BREAKER_ENABLED: "true"
  CIRCUIT_BREAKER_FAILURE_THRESHOLD: "5"
  CIRCUIT_BREAKER_SUCCESS_THRESHOLD: "3"
  CIRCUIT_BREAKER_TIMEOUT: "30"
  CIRCUIT_BREAKER_HALF_OPEN_REQUESTS: "3"

  # Retry Configuration
  RETRY_MAX_ATTEMPTS: "3"
  RETRY_INITIAL_BACKOFF: "100"
  RETRY_MAX_BACKOFF: "5000"
  RETRY_MULTIPLIER: "2"
  RETRY_JITTER: "true"

  # Cache Configuration
  CACHE_ENABLED: "true"
  CACHE_DEFAULT_TTL: "300"
  CACHE_MAX_SIZE: "1000"
  CACHE_STRATEGY: "LRU"

  # Metrics Configuration
  METRICS_ENABLED: "true"
  METRICS_PORT: "9090"
  METRICS_PATH: "/metrics"
  METRICS_NAMESPACE: "greenlang"
  METRICS_SUBSYSTEM: "gl_017_condensync"

  # Tracing Configuration (OpenTelemetry)
  OTEL_ENABLED: "true"
  OTEL_SERVICE_NAME: "gl-017-condensync"
  OTEL_EXPORTER_OTLP_ENDPOINT: "http://otel-collector.monitoring:4317"
  OTEL_EXPORTER_OTLP_PROTOCOL: "grpc"
  OTEL_TRACES_SAMPLER: "parentbased_traceidratio"
  OTEL_TRACES_SAMPLER_ARG: "0.1"

  # Health Check Configuration
  HEALTH_CHECK_ENABLED: "true"
  HEALTH_CHECK_PATH: "/api/v1/health"
  READINESS_CHECK_PATH: "/api/v1/ready"
  LIVENESS_INCLUDE_DETAILS: "false"

  # CORS Configuration
  CORS_ENABLED: "true"
  CORS_ALLOWED_ORIGINS: "https://*.greenlang.io"
  CORS_ALLOWED_METHODS: "GET,POST,PUT,DELETE,OPTIONS"
  CORS_ALLOWED_HEADERS: "Authorization,Content-Type,X-Request-ID"
  CORS_MAX_AGE: "3600"

  # Database Pool Configuration
  DB_POOL_MIN_SIZE: "5"
  DB_POOL_MAX_SIZE: "20"
  DB_POOL_TIMEOUT: "30"
  DB_POOL_RECYCLE: "3600"

  # Redis Configuration
  REDIS_POOL_SIZE: "10"
  REDIS_TIMEOUT: "5"
  REDIS_MAX_RETRIES: "3"

---
# Condenser-Specific Configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: gl-017-condensync-condenser-config
  namespace: greenlang
  labels:
    app: gl-017-condensync
data:
  condenser-parameters.yaml: |
    # Condenser Optimization Parameters
    condenser:
      # Efficiency Settings
      efficiency:
        target: 0.92
        minimum: 0.80
        alert_threshold: 0.85

      # Temperature Settings (Celsius)
      temperature:
        inlet_min: 15
        inlet_max: 45
        outlet_min: 20
        outlet_max: 55
        approach_target: 5
        approach_max: 10

      # Pressure Settings (bar)
      pressure:
        min: 0.03
        max: 0.15
        optimal: 0.08
        tolerance: 0.02

      # Flow Rate Settings (m3/h)
      flow_rate:
        min: 100
        max: 2000
        optimal_range: [500, 1500]

      # Fouling Factor
      fouling:
        clean: 0.0001
        warning: 0.0003
        critical: 0.0005

      # Optimization Algorithm
      optimization:
        algorithm: "gradient_descent"
        learning_rate: 0.01
        max_iterations: 1000
        convergence_threshold: 0.0001

  prediction-config.yaml: |
    # Prediction Model Configuration
    prediction:
      # Model Settings
      model:
        type: "lstm"
        sequence_length: 24
        hidden_units: 128
        layers: 3
        dropout: 0.2

      # Training Settings
      training:
        epochs: 100
        batch_size: 32
        validation_split: 0.2
        early_stopping_patience: 10

      # Prediction Horizons (seconds)
      horizons:
        short_term: 300
        medium_term: 3600
        long_term: 86400

---
# Environment-Specific Configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: gl-017-condensync-env-config
  namespace: greenlang
  labels:
    app: gl-017-condensync
    environment: production
data:
  # Development
  DEV_DATABASE_POOL_SIZE: "5"
  DEV_REDIS_POOL_SIZE: "5"
  DEV_LOG_LEVEL: "DEBUG"
  DEV_OPTIMIZATION_INTERVAL: "30"

  # Staging
  STAGING_DATABASE_POOL_SIZE: "10"
  STAGING_REDIS_POOL_SIZE: "10"
  STAGING_LOG_LEVEL: "INFO"
  STAGING_OPTIMIZATION_INTERVAL: "60"

  # Production
  PROD_DATABASE_POOL_SIZE: "20"
  PROD_REDIS_POOL_SIZE: "20"
  PROD_LOG_LEVEL: "INFO"
  PROD_OPTIMIZATION_INTERVAL: "60"
