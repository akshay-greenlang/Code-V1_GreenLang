# =============================================================================
# GL-017 CONDENSYNC - ConfigMap
# Application configuration, logging settings, and feature flags
# =============================================================================
apiVersion: v1
kind: ConfigMap
metadata:
  name: gl-017-condensync-config
  namespace: greenlang
  labels:
    app: gl-017-condensync
    app.kubernetes.io/name: condensync
    app.kubernetes.io/instance: gl-017
    app.kubernetes.io/version: "1.0.0"
    app.kubernetes.io/component: config
    app.kubernetes.io/part-of: greenlang
data:
  # ==========================================================================
  # Agent Configuration
  # ==========================================================================
  AGENT_ID: "GL-017"
  AGENT_NAME: "CONDENSYNC"
  AGENT_VERSION: "1.0.0"
  AGENT_DESCRIPTION: "Condenser Optimization Agent"

  # ==========================================================================
  # Server Configuration
  # ==========================================================================
  HTTP_HOST: "0.0.0.0"
  HTTP_PORT: "8017"
  METRICS_PORT: "9017"
  WORKERS: "4"
  TIMEOUT_KEEP_ALIVE: "30"
  GRACEFUL_SHUTDOWN_TIMEOUT: "30"

  # ==========================================================================
  # Logging Configuration
  # ==========================================================================
  LOG_LEVEL: "INFO"
  LOG_FORMAT: "json"
  LOG_TIMESTAMP_FORMAT: "iso8601"
  LOG_INCLUDE_TRACE_ID: "true"
  LOG_INCLUDE_SPAN_ID: "true"
  LOG_OUTPUT: "stdout"

  # ==========================================================================
  # Database Configuration
  # ==========================================================================
  DB_POOL_SIZE: "10"
  DB_MAX_OVERFLOW: "20"
  DB_POOL_TIMEOUT: "30"
  DB_POOL_RECYCLE: "1800"
  DB_ECHO: "false"

  # ==========================================================================
  # Redis Configuration
  # ==========================================================================
  REDIS_MAX_CONNECTIONS: "50"
  REDIS_SOCKET_TIMEOUT: "5"
  REDIS_SOCKET_CONNECT_TIMEOUT: "5"
  REDIS_RETRY_ON_TIMEOUT: "true"
  REDIS_HEALTH_CHECK_INTERVAL: "30"

  # ==========================================================================
  # SCADA Integration Configuration
  # ==========================================================================
  SCADA_POLL_INTERVAL: "5"
  SCADA_TIMEOUT: "30"
  SCADA_RETRY_COUNT: "3"
  SCADA_RETRY_DELAY: "5"
  SCADA_BATCH_SIZE: "100"

  # ==========================================================================
  # Condenser Optimization Parameters
  # ==========================================================================
  CONDENSER_OPTIMIZATION_INTERVAL: "60"
  CONDENSER_MIN_PRESSURE_THRESHOLD: "0.05"
  CONDENSER_MAX_PRESSURE_THRESHOLD: "0.15"
  CONDENSER_EFFICIENCY_TARGET: "0.92"
  CONDENSER_SUBCOOLING_MIN: "2.0"
  CONDENSER_SUBCOOLING_MAX: "8.0"

  # ==========================================================================
  # Feature Flags
  # ==========================================================================
  FEATURE_AUTO_OPTIMIZATION: "true"
  FEATURE_PREDICTIVE_MAINTENANCE: "true"
  FEATURE_ANOMALY_DETECTION: "true"
  FEATURE_REAL_TIME_ALERTS: "true"
  FEATURE_HISTORICAL_ANALYSIS: "true"
  FEATURE_ML_RECOMMENDATIONS: "false"
  FEATURE_ADVANCED_DIAGNOSTICS: "true"

  # ==========================================================================
  # Metrics and Monitoring
  # ==========================================================================
  METRICS_ENABLED: "true"
  METRICS_PREFIX: "gl017_condensync"
  METRICS_HISTOGRAM_BUCKETS: "0.005,0.01,0.025,0.05,0.1,0.25,0.5,1.0,2.5,5.0,10.0"
  TRACING_ENABLED: "true"
  TRACING_SAMPLE_RATE: "0.1"
  TRACING_EXPORTER: "otlp"
  TRACING_ENDPOINT: "http://otel-collector:4317"

  # ==========================================================================
  # Health Check Configuration
  # ==========================================================================
  HEALTH_CHECK_TIMEOUT: "5"
  HEALTH_CHECK_INTERVAL: "30"
  HEALTH_CHECK_INCLUDE_DETAILS: "true"

  # ==========================================================================
  # Security Configuration
  # ==========================================================================
  CORS_ORIGINS: "*"
  CORS_ALLOW_CREDENTIALS: "false"
  CORS_ALLOW_METHODS: "GET,POST,PUT,DELETE,OPTIONS"
  CORS_ALLOW_HEADERS: "Content-Type,Authorization,X-Request-ID,X-Trace-ID"
  RATE_LIMIT_ENABLED: "true"
  RATE_LIMIT_REQUESTS_PER_MINUTE: "1000"

  # ==========================================================================
  # Application Configuration File
  # ==========================================================================
  app-config.yaml: |
    agent:
      id: GL-017
      name: CONDENSYNC
      version: 1.0.0
      description: Condenser Optimization Agent

    server:
      host: 0.0.0.0
      port: 8017
      workers: 4

    optimization:
      interval_seconds: 60
      pressure_limits:
        min: 0.05
        max: 0.15
      efficiency_target: 0.92
      subcooling:
        min: 2.0
        max: 8.0

    features:
      auto_optimization: true
      predictive_maintenance: true
      anomaly_detection: true
      real_time_alerts: true
