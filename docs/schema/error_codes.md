# GL-FOUND-X-002: Error Codes Reference

## Overview

This document provides a complete reference for all error codes, warnings, and informational messages generated by the GreenLang Schema Compiler & Validator (GL-FOUND-X-002).

---

## Error Code Format

All GreenLang Schema error codes follow this format:

```
GLSCHEMA-{Severity}{Category}{Number}
```

| Component | Description |
|-----------|-------------|
| `GLSCHEMA` | GreenLang Schema module prefix |
| `Severity` | E=Error, W=Warning, I=Info |
| `Category` | Category code (1-9) |
| `Number` | Specific error number (00-99) |

**Example:** `GLSCHEMA-E101` = Error, Type Validation category, error #01

---

## Severity Levels

| Level | Code | Description |
|-------|------|-------------|
| Error | `E` | Validation failure - payload is invalid |
| Warning | `W` | Potential issue - validation passes but review recommended |
| Info | `I` | Informational - no action required |

---

## Category Index

| Category | Code | Description |
|----------|------|-------------|
| Type Validation | 1xx | Type mismatches and basic validation |
| Required Fields | 2xx | Missing required fields |
| Constraints | 3xx | Range, pattern, enum violations |
| Unit Validation | 4xx | Unit consistency issues |
| Structural | 5xx | Schema structure issues |
| Coercion | 6xx | Type coercion related |
| API | 7xx | REST API specific errors |
| System | 8xx | System and configuration errors |
| Custom Rules | 9xx | Custom validation rule errors |

---

## Type Validation Errors (E1xx)

### GLSCHEMA-E100: Type Mismatch

**Severity:** Error

**Description:** The value's type does not match the expected type defined in the schema.

**Example:**
```json
{
  "code": "GLSCHEMA-E100",
  "message": "Type mismatch: expected 'number', got 'string'",
  "path": "emissions.0.quantity",
  "expected": "number",
  "actual": "string",
  "value": "1000"
}
```

**Resolution:**
- Ensure the value is the correct type
- Enable type coercion if string-to-number conversion is acceptable
- Check for quotes around numeric values in JSON/YAML

**Auto-fix available:** Yes (when coercion is possible)

---

### GLSCHEMA-E101: Invalid Enum Value

**Severity:** Error

**Description:** The value is not one of the allowed enum values.

**Example:**
```json
{
  "code": "GLSCHEMA-E101",
  "message": "Invalid enum value: 4 is not one of [1, 2, 3]",
  "path": "emissions.0.scope",
  "expected": [1, 2, 3],
  "actual": 4
}
```

**Resolution:**
- Use one of the allowed values
- Check for typos in string enum values
- Review schema for current allowed values

**Auto-fix available:** Yes (suggests closest match)

---

### GLSCHEMA-E102: Invalid Boolean

**Severity:** Error

**Description:** The value cannot be interpreted as a boolean.

**Example:**
```json
{
  "code": "GLSCHEMA-E102",
  "message": "Invalid boolean value: 'maybe' is not a valid boolean",
  "path": "config.enabled",
  "value": "maybe"
}
```

**Resolution:**
- Use `true`, `false`, or string equivalents like "yes"/"no", "1"/"0"

**Auto-fix available:** Yes (when value is "true", "false", "yes", "no", "1", "0")

---

### GLSCHEMA-E103: Invalid Array

**Severity:** Error

**Description:** The value is not an array when an array is expected.

**Example:**
```json
{
  "code": "GLSCHEMA-E103",
  "message": "Expected array, got object",
  "path": "emissions",
  "actual": "object"
}
```

**Resolution:**
- Wrap single objects in an array: `[{...}]`
- Verify data structure matches schema

**Auto-fix available:** Yes (wraps single value in array)

---

### GLSCHEMA-E104: Invalid Object

**Severity:** Error

**Description:** The value is not an object when an object is expected.

**Example:**
```json
{
  "code": "GLSCHEMA-E104",
  "message": "Expected object, got array",
  "path": "config",
  "actual": "array"
}
```

**Resolution:**
- Ensure value is a key-value object, not an array
- Check for incorrect nesting

**Auto-fix available:** No

---

### GLSCHEMA-E105: Null Value Not Allowed

**Severity:** Error

**Description:** A null value was provided for a field that doesn't allow null.

**Example:**
```json
{
  "code": "GLSCHEMA-E105",
  "message": "Null value not allowed for field",
  "path": "organization_id",
  "value": null
}
```

**Resolution:**
- Provide a valid value
- Update schema to allow null: `{"type": ["string", "null"]}`

**Auto-fix available:** No

---

## Required Field Errors (E2xx)

### GLSCHEMA-E200: Missing Required Field

**Severity:** Error

**Description:** A required field is missing from the payload.

**Example:**
```json
{
  "code": "GLSCHEMA-E200",
  "message": "Required field 'fuel_type' is missing",
  "path": "emissions.0.fuel_type"
}
```

**Resolution:**
- Add the missing field with an appropriate value
- Check if field was misspelled

**Auto-fix available:** Yes (suggests default value)

---

### GLSCHEMA-E201: Missing Required Array Item

**Severity:** Error

**Description:** A required array has no items when minimum items are required.

**Example:**
```json
{
  "code": "GLSCHEMA-E201",
  "message": "Array 'emissions' requires at least 1 item",
  "path": "emissions",
  "minItems": 1,
  "actualItems": 0
}
```

**Resolution:**
- Add at least one item to the array

**Auto-fix available:** No

---

### GLSCHEMA-E202: Missing Conditional Dependency

**Severity:** Error

**Description:** A field that is conditionally required is missing.

**Example:**
```json
{
  "code": "GLSCHEMA-E202",
  "message": "Field 'unit' is required when 'quantity' is present",
  "path": "emissions.0.unit",
  "dependency": "quantity"
}
```

**Resolution:**
- Add the dependent field
- Remove the triggering field if appropriate

**Auto-fix available:** No

---

## Constraint Errors (E3xx)

### GLSCHEMA-E300: Value Below Minimum

**Severity:** Error

**Description:** A numeric value is below the minimum allowed.

**Example:**
```json
{
  "code": "GLSCHEMA-E300",
  "message": "Value -5 is less than minimum 0",
  "path": "emissions.0.quantity",
  "minimum": 0,
  "actual": -5
}
```

**Resolution:**
- Use a value greater than or equal to the minimum
- Check for sign errors

**Auto-fix available:** Yes (clamps to minimum)

---

### GLSCHEMA-E301: Value Above Maximum

**Severity:** Error

**Description:** A numeric value is above the maximum allowed.

**Example:**
```json
{
  "code": "GLSCHEMA-E301",
  "message": "Value 150 is greater than maximum 100",
  "path": "config.percentage",
  "maximum": 100,
  "actual": 150
}
```

**Resolution:**
- Use a value less than or equal to the maximum
- Check for unit conversion issues

**Auto-fix available:** Yes (clamps to maximum)

---

### GLSCHEMA-E302: Pattern Mismatch

**Severity:** Error

**Description:** A string value does not match the required pattern.

**Example:**
```json
{
  "code": "GLSCHEMA-E302",
  "message": "Value 'invalid' does not match pattern '^[A-Z]{2}-[0-9]{4}$'",
  "path": "project_code",
  "pattern": "^[A-Z]{2}-[0-9]{4}$",
  "value": "invalid"
}
```

**Resolution:**
- Format the value to match the required pattern
- Review pattern documentation for expected format

**Auto-fix available:** No

---

### GLSCHEMA-E303: String Too Short

**Severity:** Error

**Description:** A string is shorter than the minimum length.

**Example:**
```json
{
  "code": "GLSCHEMA-E303",
  "message": "String length 2 is less than minimum 3",
  "path": "country_code",
  "minLength": 3,
  "actualLength": 2
}
```

**Resolution:**
- Provide a longer string
- Check for truncated data

**Auto-fix available:** No

---

### GLSCHEMA-E304: String Too Long

**Severity:** Error

**Description:** A string is longer than the maximum length.

**Example:**
```json
{
  "code": "GLSCHEMA-E304",
  "message": "String length 500 exceeds maximum 255",
  "path": "description",
  "maxLength": 255,
  "actualLength": 500
}
```

**Resolution:**
- Truncate or summarize the string
- Check if correct field is being used

**Auto-fix available:** Yes (truncates to max length)

---

### GLSCHEMA-E305: Array Too Few Items

**Severity:** Error

**Description:** An array has fewer items than required.

**Example:**
```json
{
  "code": "GLSCHEMA-E305",
  "message": "Array has 1 item, minimum is 2",
  "path": "approvers",
  "minItems": 2,
  "actualItems": 1
}
```

**Resolution:**
- Add more items to the array

**Auto-fix available:** No

---

### GLSCHEMA-E306: Array Too Many Items

**Severity:** Error

**Description:** An array has more items than allowed.

**Example:**
```json
{
  "code": "GLSCHEMA-E306",
  "message": "Array has 15 items, maximum is 10",
  "path": "tags",
  "maxItems": 10,
  "actualItems": 15
}
```

**Resolution:**
- Remove excess items
- Consider if data should be split

**Auto-fix available:** No

---

### GLSCHEMA-E307: Duplicate Array Items

**Severity:** Error

**Description:** Array contains duplicate items when unique items are required.

**Example:**
```json
{
  "code": "GLSCHEMA-E307",
  "message": "Array contains duplicate items at indices 2 and 5",
  "path": "category_ids",
  "duplicateIndices": [2, 5]
}
```

**Resolution:**
- Remove duplicate values

**Auto-fix available:** Yes (removes duplicates)

---

### GLSCHEMA-E308: Invalid Format

**Severity:** Error

**Description:** A string does not match the required format.

**Example:**
```json
{
  "code": "GLSCHEMA-E308",
  "message": "Value 'not-a-date' is not a valid date",
  "path": "reporting_period.start_date",
  "format": "date",
  "value": "not-a-date"
}
```

**Supported formats:** `date`, `date-time`, `email`, `uri`, `uuid`, `ipv4`, `ipv6`

**Resolution:**
- Format the value according to the required format
- For dates, use ISO 8601 format (YYYY-MM-DD)

**Auto-fix available:** Partial (for common format errors)

---

## Unit Validation Errors (E4xx)

### GLSCHEMA-E400: Unknown Unit

**Severity:** Warning (typically)

**Description:** The unit symbol is not recognized.

**Example:**
```json
{
  "code": "GLSCHEMA-E400",
  "message": "Unknown unit 'xyz'",
  "path": "emissions.0.unit",
  "value": "xyz"
}
```

**Resolution:**
- Use a recognized unit symbol
- Check for typos

**Recognized units:** kgCO2e, tCO2e, kWh, MWh, L, m3, kg, etc.

**Auto-fix available:** Yes (suggests closest match)

---

### GLSCHEMA-E401: Unit Family Mismatch

**Severity:** Error

**Description:** The unit does not match the expected unit family.

**Example:**
```json
{
  "code": "GLSCHEMA-E401",
  "message": "Expected unit family 'mass_co2e', got 'energy' (kWh)",
  "path": "emissions.0.unit",
  "expectedFamily": "mass_co2e",
  "actualFamily": "energy"
}
```

**Resolution:**
- Use a unit from the correct family
- Verify the data type (emissions vs. energy)

**Auto-fix available:** No

---

### GLSCHEMA-E402: Inconsistent Units

**Severity:** Warning

**Description:** Multiple fields have units from different families.

**Example:**
```json
{
  "code": "GLSCHEMA-E402",
  "message": "Mixed unit families detected: mass_co2e and energy",
  "path": "data.units",
  "families": {
    "mass_co2e": ["emissions.co2.unit"],
    "energy": ["consumption.electricity.unit"]
  }
}
```

**Resolution:**
- Review if mixed units are intentional
- Ensure related fields use compatible units

**Auto-fix available:** No

---

## Structural Errors (E5xx)

### GLSCHEMA-E500: Additional Property Not Allowed

**Severity:** Error (in strict mode) / Warning (in standard mode)

**Description:** The payload contains a property not defined in the schema.

**Example:**
```json
{
  "code": "GLSCHEMA-E500",
  "message": "Additional property 'extra_field' is not allowed",
  "path": "extra_field"
}
```

**Resolution:**
- Remove the additional property
- Update schema to include the property
- Use permissive validation mode

**Auto-fix available:** Yes (removes property)

---

### GLSCHEMA-E501: Schema Not Found

**Severity:** Error

**Description:** The referenced schema could not be found in the registry.

**Example:**
```json
{
  "code": "GLSCHEMA-E501",
  "message": "Schema not found: my-schema@1.0.0",
  "schemaId": "my-schema",
  "version": "1.0.0"
}
```

**Resolution:**
- Verify schema ID and version
- Register the schema in the registry

**Auto-fix available:** No

---

### GLSCHEMA-E502: Schema Version Not Found

**Severity:** Error

**Description:** The specific version of the schema was not found.

**Example:**
```json
{
  "code": "GLSCHEMA-E502",
  "message": "Version 2.0.0 not found for schema 'my-schema'",
  "schemaId": "my-schema",
  "requestedVersion": "2.0.0",
  "availableVersions": ["1.0.0", "1.1.0"]
}
```

**Resolution:**
- Use an available version
- Register the new version

**Auto-fix available:** No

---

### GLSCHEMA-E503: Invalid Schema

**Severity:** Error

**Description:** The schema itself is invalid or malformed.

**Example:**
```json
{
  "code": "GLSCHEMA-E503",
  "message": "Invalid schema: 'type' must be a string or array",
  "schemaPath": "properties.name.type"
}
```

**Resolution:**
- Fix the schema definition
- Validate schema against JSON Schema Draft-07

**Auto-fix available:** No

---

## Coercion Errors (E6xx)

### GLSCHEMA-E600: Coercion Failed

**Severity:** Error

**Description:** Automatic type coercion was attempted but failed.

**Example:**
```json
{
  "code": "GLSCHEMA-E600",
  "message": "Cannot coerce 'not-a-number' to integer",
  "path": "count",
  "targetType": "integer",
  "value": "not-a-number"
}
```

**Resolution:**
- Provide a valid value for the target type
- Check source data for corruption

**Auto-fix available:** No

---

### GLSCHEMA-E601: Lossy Coercion

**Severity:** Warning

**Description:** Type coercion would result in data loss.

**Example:**
```json
{
  "code": "GLSCHEMA-E601",
  "message": "Coercing 3.14159 to integer would lose precision",
  "path": "count",
  "originalValue": 3.14159,
  "coercedValue": 3
}
```

**Resolution:**
- Verify data loss is acceptable
- Enable lossy coercion if intended

**Auto-fix available:** Yes (with lossy flag)

---

## API Errors (E7xx)

### GLSCHEMA-E700: Invalid Request

**Severity:** Error

**Description:** The API request is malformed or missing required fields.

**Example:**
```json
{
  "code": "GLSCHEMA-E700",
  "message": "Missing required field 'payload'",
  "field": "payload"
}
```

**Resolution:**
- Review API documentation
- Include all required fields

**Auto-fix available:** No

---

### GLSCHEMA-E701: Payload Too Large

**Severity:** Error

**Description:** The request payload exceeds the maximum allowed size.

**Example:**
```json
{
  "code": "GLSCHEMA-E701",
  "message": "Payload size 15MB exceeds maximum 10MB",
  "maxSize": "10MB",
  "actualSize": "15MB"
}
```

**Resolution:**
- Reduce payload size
- Split into multiple requests

**Auto-fix available:** No

---

### GLSCHEMA-E702: Batch Too Large

**Severity:** Error

**Description:** The batch request contains too many items.

**Example:**
```json
{
  "code": "GLSCHEMA-E702",
  "message": "Batch size 1500 exceeds maximum 1000",
  "maxItems": 1000,
  "actualItems": 1500
}
```

**Resolution:**
- Split into multiple batch requests
- Each batch should have 1000 items or fewer

**Auto-fix available:** No

---

### GLSCHEMA-E703: Rate Limit Exceeded

**Severity:** Error

**Description:** Too many requests have been made in the time window.

**Example:**
```json
{
  "code": "GLSCHEMA-E703",
  "message": "Rate limit exceeded. Try again in 42 seconds",
  "retryAfter": 42
}
```

**Resolution:**
- Wait for the retry period
- Implement exponential backoff
- Request rate limit increase if needed

**Auto-fix available:** No

---

### GLSCHEMA-E704: Unauthorized

**Severity:** Error

**Description:** Authentication is required or the provided credentials are invalid.

**Example:**
```json
{
  "code": "GLSCHEMA-E704",
  "message": "Invalid API key",
  "hint": "Provide a valid API key in X-API-Key header"
}
```

**Resolution:**
- Provide valid API key or token
- Check credential expiration

**Auto-fix available:** No

---

## System Errors (E8xx)

### GLSCHEMA-E800: Internal Error

**Severity:** Error

**Description:** An unexpected internal error occurred.

**Example:**
```json
{
  "code": "GLSCHEMA-E800",
  "message": "An internal error occurred during validation",
  "traceId": "abc123-def456"
}
```

**Resolution:**
- Retry the request
- Contact support with trace ID if persistent

**Auto-fix available:** No

---

### GLSCHEMA-E801: Timeout

**Severity:** Error

**Description:** The validation operation timed out.

**Example:**
```json
{
  "code": "GLSCHEMA-E801",
  "message": "Validation timed out after 30 seconds",
  "timeout": 30
}
```

**Resolution:**
- Reduce payload size
- Split into smaller batches

**Auto-fix available:** No

---

### GLSCHEMA-E802: Registry Unavailable

**Severity:** Error

**Description:** The schema registry is temporarily unavailable.

**Example:**
```json
{
  "code": "GLSCHEMA-E802",
  "message": "Schema registry is unavailable",
  "hint": "Use inline schema or retry later"
}
```

**Resolution:**
- Retry after brief delay
- Use inline schema as fallback

**Auto-fix available:** No

---

## Warnings (W3xx)

### GLSCHEMA-W300: Recommended Field Missing

**Severity:** Warning

**Description:** A recommended (but not required) field is missing.

**Example:**
```json
{
  "code": "GLSCHEMA-W300",
  "message": "Recommended field 'organization_id' is missing",
  "path": "organization_id"
}
```

**Resolution:**
- Add the field if available
- Ignore if field is intentionally omitted

**Auto-fix available:** Yes (suggests default)

---

### GLSCHEMA-W301: Deprecated Field

**Severity:** Warning

**Description:** A deprecated field is being used.

**Example:**
```json
{
  "code": "GLSCHEMA-W301",
  "message": "Field 'old_field' is deprecated, use 'new_field' instead",
  "path": "old_field",
  "replacement": "new_field"
}
```

**Resolution:**
- Update to use the new field name

**Auto-fix available:** Yes (renames field)

---

### GLSCHEMA-W302: Deprecated Schema Version

**Severity:** Warning

**Description:** The schema version being used is deprecated.

**Example:**
```json
{
  "code": "GLSCHEMA-W302",
  "message": "Schema version 1.0.0 is deprecated, upgrade to 1.3.0",
  "currentVersion": "1.0.0",
  "recommendedVersion": "1.3.0"
}
```

**Resolution:**
- Upgrade to recommended version
- Review migration guide for changes

**Auto-fix available:** No

---

### GLSCHEMA-W303: Possible Typo

**Severity:** Warning

**Description:** A field name may contain a typo.

**Example:**
```json
{
  "code": "GLSCHEMA-W303",
  "message": "Did you mean 'fuel_type' instead of 'fuel_typo'?",
  "path": "emissions.0.fuel_typo",
  "suggestion": "fuel_type"
}
```

**Resolution:**
- Correct the field name
- Add to schema if new field is intentional

**Auto-fix available:** Yes (renames to suggestion)

---

## Info Messages (I0xx)

### GLSCHEMA-I001: Coercion Applied

**Severity:** Info

**Description:** Automatic type coercion was successfully applied.

**Example:**
```json
{
  "code": "GLSCHEMA-I001",
  "message": "Coerced string '42' to integer 42",
  "path": "count",
  "originalType": "string",
  "resultType": "integer"
}
```

---

### GLSCHEMA-I002: Default Applied

**Severity:** Info

**Description:** A default value was applied for a missing optional field.

**Example:**
```json
{
  "code": "GLSCHEMA-I002",
  "message": "Applied default value 'kgCO2e' for field 'unit'",
  "path": "emissions.0.unit",
  "defaultValue": "kgCO2e"
}
```

---

### GLSCHEMA-I003: Normalized

**Severity:** Info

**Description:** A value was normalized to canonical form.

**Example:**
```json
{
  "code": "GLSCHEMA-I003",
  "message": "Normalized date '2026-1-5' to '2026-01-05'",
  "path": "date",
  "original": "2026-1-5",
  "normalized": "2026-01-05"
}
```

---

## Error Handling Best Practices

### Programmatic Error Handling

```python
from greenlang.agents.foundation import SchemaCompilerAgent

agent = SchemaCompilerAgent()
result = agent.run({"payload": data, "schema_id": "my-schema"})

if not result.data["is_valid"]:
    for error in result.data["validation_result"]["errors"]:
        code = error.get("code", "UNKNOWN")

        if code.startswith("GLSCHEMA-E1"):
            # Type errors - check for coercion fix
            print(f"Type error at {error['field']}")

        elif code.startswith("GLSCHEMA-E2"):
            # Required field errors
            print(f"Missing required: {error['field']}")

        elif code.startswith("GLSCHEMA-E3"):
            # Constraint errors
            print(f"Constraint violation: {error['message']}")

        elif code.startswith("GLSCHEMA-E4"):
            # Unit errors
            print(f"Unit issue: {error['message']}")

        elif code.startswith("GLSCHEMA-E5"):
            # Schema/structural errors
            print(f"Schema error: {error['message']}")
```

### Logging Error Codes

```python
import logging

logger = logging.getLogger(__name__)

for error in result.data["validation_result"]["errors"]:
    logger.error(
        "Validation error",
        extra={
            "error_code": error.get("code"),
            "field": error.get("field"),
            "message": error.get("message"),
            "severity": error.get("severity")
        }
    )
```

---

## See Also

- [CLI Reference](cli.md)
- [API Reference](api.md)
- [SDK Guide](sdk.md)
- [Migration Guide](migration.md)
