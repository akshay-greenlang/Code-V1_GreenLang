[pytest]
# GL-007 FurnacePerformanceMonitor Test Configuration
# Version: 1.0.0
# Date: 2025-11-21

# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Minimum Python version
minversion = 3.11

# Test paths
testpaths = tests

# Options
addopts =
    # Verbose output
    -v
    --tb=short

    # Coverage reporting
    --cov=src
    --cov-report=html:tests/coverage_html
    --cov-report=term-missing
    --cov-report=xml:tests/coverage.xml
    --cov-fail-under=85

    # Performance
    --benchmark-only
    --benchmark-autosave
    --benchmark-save-data

    # Parallel execution
    -n auto

    # Warnings
    -W error::UserWarning
    -W error::DeprecationWarning

    # Markers
    --strict-markers

    # Output
    --color=yes
    --code-highlight=yes

    # Failure handling
    --maxfail=5
    --ff

# Custom markers
markers =
    unit: Unit tests for individual functions and methods
    integration: Integration tests for component interactions
    e2e: End-to-end workflow tests
    performance: Performance and benchmark tests
    compliance: Regulatory compliance validation tests
    accuracy: Calculation accuracy tests (compare to known values)
    safety: Safety and error handling tests
    slow: Tests that take >1 second to run
    requires_dcs: Tests requiring DCS connection
    requires_cems: Tests requiring CEMS connection
    requires_cmms: Tests requiring CMMS connection
    determinism: Tests validating deterministic behavior
    asme_ptc: Tests validating ASME PTC 4.1 compliance
    iso_50001: Tests validating ISO 50001 compliance
    epa_cems: Tests validating EPA CEMS compliance

# Console output settings
console_output_style = progress

# Log settings
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

log_file = tests/logs/pytest.log
log_file_level = DEBUG
log_file_format = %(asctime)s [%(levelname)8s] [%(filename)s:%(lineno)d] %(message)s
log_file_date_format = %Y-%m-%d %H:%M:%S

# Timeout for tests (prevent hanging)
timeout = 300
timeout_method = thread

# Ignore patterns
norecursedirs =
    .git
    .tox
    dist
    build
    *.egg
    __pycache__
    .pytest_cache
    .coverage
    htmlcov
    node_modules

# Coverage settings
[coverage:run]
source = src
omit =
    */tests/*
    */test_*.py
    */__pycache__/*
    */site-packages/*
    */dist-packages/*

[coverage:report]
precision = 2
show_missing = true
skip_covered = false
exclude_lines =
    pragma: no cover
    def __repr__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    if TYPE_CHECKING:
    @abstract

[coverage:html]
directory = tests/coverage_html

[coverage:xml]
output = tests/coverage.xml
