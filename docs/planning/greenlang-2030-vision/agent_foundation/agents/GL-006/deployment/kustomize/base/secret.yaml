# GL-006 HeatRecoveryMaximizer Secrets
# NOTE: This is a template. In production, use Sealed Secrets, External Secrets, or Vault
apiVersion: v1
kind: Secret
metadata:
  name: gl-006-heatreclaim-secrets
  namespace: greenlang
  labels:
    app: gl-006-heatreclaim
    agent-id: GL-006
    codename: HEATRECLAIM
type: Opaque
stringData:
  # Database connection string
  # Format: postgresql://user:password@host:port/database
  database-url: "postgresql://greenlang:changeme@postgresql:5432/gl006_heatreclaim"

  # Redis connection string
  # Format: redis://[:password@]host:port/database
  redis-url: "redis://redis:6379/0"

  # SCADA endpoint (optional)
  scada-endpoint: "opc.tcp://scada-server:4840"

  # Historian endpoint (optional)
  historian-endpoint: "opc.tcp://historian:4840"

  # API authentication key
  api-key: "changeme-api-key"

  # JWT secret for token signing
  jwt-secret: "changeme-jwt-secret-min-32-chars"

---
# ServiceAccount for the application
apiVersion: v1
kind: ServiceAccount
metadata:
  name: gl-006-heatreclaim-sa
  namespace: greenlang
  labels:
    app: gl-006-heatreclaim
    agent-id: GL-006

---
# Role for necessary permissions
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: gl-006-heatreclaim-role
  namespace: greenlang
rules:
  - apiGroups: [""]
    resources: ["configmaps"]
    verbs: ["get", "list", "watch"]
  - apiGroups: [""]
    resources: ["secrets"]
    resourceNames: ["gl-006-heatreclaim-secrets"]
    verbs: ["get"]

---
# RoleBinding to attach role to service account
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: gl-006-heatreclaim-rolebinding
  namespace: greenlang
subjects:
  - kind: ServiceAccount
    name: gl-006-heatreclaim-sa
    namespace: greenlang
roleRef:
  kind: Role
  name: gl-006-heatreclaim-role
  apiGroup: rbac.authorization.k8s.io
