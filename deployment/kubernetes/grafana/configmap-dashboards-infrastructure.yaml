# ============================================================================
# GreenLang Grafana - Infrastructure Dashboard ConfigMap
# ============================================================================
# ConfigMap for infrastructure Grafana dashboards. The grafana_dashboard: "1"
# label enables automatic sidecar detection and loading by the Grafana
# k8s-sidecar container.
#
# Dashboards:
#   - kubernetes-cluster.json
#   - infrastructure-overview.json
#   - kong-gateway.json
#   - cicd-pipeline.json
#   - feature-flags.json
#   - agent-factory-v1.json
#
# Created: 2026-02-07
# Team: Monitoring & Observability
# PRD: OBS-002 - Grafana Dashboards
# ============================================================================

apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards-infrastructure
  namespace: monitoring
  labels:
    app.kubernetes.io/name: grafana
    app.kubernetes.io/component: dashboards
    app.kubernetes.io/part-of: greenlang
    grafana_dashboard: "1"
  annotations:
    grafana_folder: "01-Infrastructure"
    description: "Infrastructure monitoring dashboards (K8s, Kong, CI/CD, Feature Flags, Agent Factory)"
data:
  kubernetes-cluster.json: |-
    {{- .Files.Get "dashboards/kubernetes-cluster.json" | nindent 4 }}
  infrastructure-overview.json: |-
    {{- .Files.Get "dashboards/infrastructure-overview.json" | nindent 4 }}
  kong-gateway.json: |-
    {{- .Files.Get "dashboards/kong-gateway.json" | nindent 4 }}
  cicd-pipeline.json: |-
    {{- .Files.Get "dashboards/cicd-pipeline.json" | nindent 4 }}
  feature-flags.json: |-
    {{- .Files.Get "dashboards/feature-flags.json" | nindent 4 }}
  agent-factory-v1.json: |-
    {{- .Files.Get "dashboards/agent-factory-v1.json" | nindent 4 }}
