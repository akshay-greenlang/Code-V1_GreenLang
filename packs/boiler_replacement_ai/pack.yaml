# AgentSpec v2 Compliant Pack for BoilerReplacementAgentAI
# This pack defines the schema, inputs, outputs, and configuration for the AI-powered
# industrial boiler replacement analysis agent.

schema_version: "2.0.0"
id: "industrial/boiler_replacement_ai_v1"
name: "Boiler Replacement Agent (AI-Powered)"
version: "1.0.0"
summary: "AI-powered industrial boiler replacement analysis with ASME PTC 4.1 calculations, solar thermal integration, heat pump COP analysis, and IRA 2022 incentives"

tags:
  - "industrial"
  - "boiler"
  - "replacement"
  - "efficiency"
  - "solar-thermal"
  - "heat-pump"
  - "IRA-2022"
  - "ai-agent"
  - "citations"

owners:
  - "greenlang-team"

license: "MIT"

# ==============================================================================
# Compute Section - Core Functionality
# ==============================================================================
compute:
  entrypoint: "python://greenlang.agents.boiler_replacement_agent_ai:execute"
  deterministic: true
  timeout_s: 120
  memory_limit_mb: 1024

  # Input Schema
  inputs:
    boiler_type:
      dtype: "string"
      unit: "1"
      description: "Type of existing boiler"
      required: true
      enum: ["firetube", "watertube", "condensing", "electric_resistance", "electrode"]

    fuel_type:
      dtype: "string"
      unit: "1"
      description: "Current fuel type"
      required: true
      enum: ["natural_gas", "fuel_oil", "propane", "coal", "biomass", "electricity"]

    rated_capacity_kw:
      dtype: "float64"
      unit: "kW"
      description: "Rated thermal capacity of boiler"
      required: true
      ge: 10.0
      le: 100000.0

    age_years:
      dtype: "int32"
      unit: "years"
      description: "Age of existing boiler"
      required: true
      ge: 0
      le: 100

    stack_temperature_c:
      dtype: "float64"
      unit: "°C"
      description: "Stack/flue gas temperature"
      required: true
      ge: 50.0
      le: 500.0

    average_load_factor:
      dtype: "float64"
      unit: "1"
      description: "Average capacity utilization (0-1)"
      required: true
      ge: 0.0
      le: 1.0

    annual_operating_hours:
      dtype: "float64"
      unit: "hours"
      description: "Hours of operation per year"
      required: true
      ge: 0.0
      le: 8760.0

    latitude:
      dtype: "float64"
      unit: "degrees"
      description: "Site latitude for solar resource calculation"
      required: true
      ge: -90.0
      le: 90.0

    ambient_temperature_c:
      dtype: "float64"
      unit: "°C"
      description: "Ambient temperature for heat loss calculations"
      required: false
      default: 20.0

    excess_air_percent:
      dtype: "float64"
      unit: "%"
      description: "Excess air percentage in combustion"
      required: false
      default: 15.0
      ge: 0.0
      le: 100.0

    fuel_cost_per_mmbtu:
      dtype: "float64"
      unit: "USD/MMBtu"
      description: "Fuel cost per million BTU"
      required: false

    electricity_cost_per_kwh:
      dtype: "float64"
      unit: "USD/kWh"
      description: "Electricity cost per kWh"
      required: false

    discount_rate:
      dtype: "float64"
      unit: "1"
      description: "Financial discount rate for NPV"
      required: false
      default: 0.08
      ge: 0.0
      le: 1.0

    analysis_period_years:
      dtype: "int32"
      unit: "years"
      description: "Financial analysis period"
      required: false
      default: 20
      ge: 1
      le: 50

  # Output Schema
  outputs:
    current_efficiency:
      dtype: "float64"
      unit: "1"
      description: "Current boiler efficiency (0-1)"

    current_annual_fuel_consumption_mmbtu:
      dtype: "float64"
      unit: "MMBtu/year"
      description: "Current annual fuel consumption"

    current_annual_cost_usd:
      dtype: "float64"
      unit: "USD/year"
      description: "Current annual fuel cost"

    current_annual_emissions_kg_co2e:
      dtype: "float64"
      unit: "kgCO2e/year"
      description: "Current annual GHG emissions"

    recommended_technology:
      dtype: "string"
      unit: "1"
      description: "Recommended replacement technology"

    replacement_efficiency:
      dtype: "float64"
      unit: "1"
      description: "Efficiency of recommended system"

    solar_fraction:
      dtype: "float64"
      unit: "1"
      description: "Solar thermal contribution fraction"
      required: false

    heat_pump_cop:
      dtype: "float64"
      unit: "1"
      description: "Heat pump coefficient of performance"
      required: false

    simple_payback_years:
      dtype: "float64"
      unit: "years"
      description: "Simple payback period"

    npv_usd:
      dtype: "float64"
      unit: "USD"
      description: "Net present value over analysis period"

    irr_percent:
      dtype: "float64"
      unit: "%"
      description: "Internal rate of return"

    federal_itc_usd:
      dtype: "float64"
      unit: "USD"
      description: "Federal ITC incentive (30% IRA 2022)"

    annual_emissions_reduction_kg_co2e:
      dtype: "float64"
      unit: "kgCO2e/year"
      description: "Annual GHG emissions reduction"

    emissions_reduction_percent:
      dtype: "float64"
      unit: "%"
      description: "Percentage emissions reduction"

    retrofit_complexity:
      dtype: "string"
      unit: "1"
      description: "Retrofit complexity assessment"
      enum: ["low", "medium", "high"]

    estimated_retrofit_cost_usd:
      dtype: "float64"
      unit: "USD"
      description: "Estimated retrofit cost"

    ai_explanation:
      dtype: "string"
      unit: "1"
      description: "AI-generated analysis and recommendations"

    technology_comparison:
      dtype: "list"
      description: "Comparison of replacement options"

    citations:
      dtype: "list"
      description: "Citation tracking for calculations"
      required: false

# ==============================================================================
# AI Section - LLM Configuration
# ==============================================================================
ai:
  system_prompt: |
    You are an expert in industrial boiler systems, solar thermal integration, and heat pump technology.

    Your role:
    1. Analyze current boiler performance using ASME PTC 4.1 methods (via tools)
    2. Evaluate replacement technologies (condensing boilers, solar thermal, heat pumps, hybrids)
    3. Calculate financial metrics with IRA 2022 incentives
    4. Assess retrofit requirements and integration challenges
    5. Provide clear recommendations with implementation roadmap

    Guidelines:
    - Always use provided tools for calculations (zero hallucinated numbers)
    - Consider efficiency degradation, stack losses, radiation losses
    - Evaluate solar thermal potential based on latitude and load profile
    - Calculate heat pump COP using Carnot efficiency method
    - Include IRA 2022 30% ITC for solar thermal and heat pump systems
    - Assess retrofit complexity (piping, controls, space requirements)
    - Rank technologies by NPV, payback, and emissions reduction

    Remember: All calculations must use tools. Focus on clear, actionable guidance.

  budget:
    max_usd_per_run: 1.00
    warn_at_usd: 0.60

  rag_collections:
    - "asme_ptc_4_standards"
    - "solar_thermal_design"
    - "heat_pump_cop_data"
    - "ira_2022_incentives"

  tools:
    - name: "calculate_current_efficiency"
      description: "Calculate current boiler efficiency with degradation (ASME PTC 4.1)"
      deterministic: true

    - name: "calculate_stack_loss"
      description: "Calculate stack loss based on flue gas temperature"
      deterministic: true

    - name: "calculate_radiation_loss"
      description: "Calculate radiation and convection losses"
      deterministic: true

    - name: "calculate_solar_fraction"
      description: "Calculate solar thermal contribution based on latitude and load"
      deterministic: true

    - name: "calculate_heat_pump_cop"
      description: "Calculate heat pump COP using Carnot method"
      deterministic: true

    - name: "calculate_hybrid_performance"
      description: "Optimize hybrid system performance (solar + conventional)"
      deterministic: true

    - name: "calculate_financial_metrics"
      description: "Calculate NPV, IRR, payback with IRA incentives"
      deterministic: true

    - name: "assess_retrofit_requirements"
      description: "Assess integration requirements and complexity"
      deterministic: true

# ==============================================================================
# Realtime Section - Execution Configuration
# ==============================================================================
realtime:
  replay_mode:
    enabled: true
    seed: 42
    temperature: 0.0
    deterministic: true

# ==============================================================================
# Provenance Section - Auditability
# ==============================================================================
provenance:
  ef_pinning: "sha256"
  gwp_set: "AR6"

  audit_fields:
    - "current_efficiency"
    - "replacement_efficiency"
    - "simple_payback_years"
    - "federal_itc_usd"
    - "emissions_reduction_percent"

  citation_required: true
  determinism_required: true

  standards:
    - name: "ASME PTC 4.1"
      description: "Steam Generating Units Performance Test Codes"
      version: "2013"

    - name: "IRA 2022"
      description: "Inflation Reduction Act Investment Tax Credits"
      version: "2022"

# ==============================================================================
# Metadata
# ==============================================================================
metadata:
  created: "2025-10-26"
  updated: "2025-10-26"
  status: "production"
  compliance:
    - "AgentSpec_v2"
    - "ASME_PTC_4_1"
    - "IRA_2022"

  documentation:
    url: "https://docs.greenlang.com/agents/boiler_replacement_ai"
    examples: "examples/boiler_replacement/"

  performance:
    avg_latency_ms: 5000
    max_latency_ms: 10000
    throughput_per_sec: 2

  dependencies:
    - "greenlang.intelligence.ChatSession"
    - "greenlang.agents.citations"
