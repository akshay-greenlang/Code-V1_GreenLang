# GL-007 FurnacePerformanceMonitor Agent Specification
# Version: 1.0.0
# Date: 2025-11-19
# Status: PRODUCTION-READY

# ============================================================================
# SECTION 1: AGENT METADATA
# ============================================================================

agent_metadata:
  agent_id: "GL-007"
  name: "FurnacePerformanceMonitor"
  version: "1.0.0"
  category: "Furnaces"
  domain: "Industrial Furnace Performance and Optimization"
  type: "Monitor/Optimizer"
  complexity: "High"
  priority: "P0"  # Critical for Q1 2026 deployment
  market_size_usd: "$9B"
  target_deployment: "Q1 2026"
  regulatory_frameworks:
    - "ASME PTC 4.1 Test Uncertainty - Power Plant Performance"
    - "ISO 50001:2018 Energy Management Systems"
    - "EPA CEMS (Continuous Emissions Monitoring Systems)"
    - "NFPA 86 Standard for Ovens and Furnaces"
    - "ISO 13579 Industrial Furnaces - Terminology"
    - "EU Energy Efficiency Directive 2012/27/EU"
    - "OSHA Process Safety Management (PSM) 1910.119"
    - "API Standard 560 Fired Heaters for General Refinery Service"

  business_metrics:
    total_addressable_market: "$9B annually"
    realistic_market_capture: "12% by 2030 ($1.08B)"
    carbon_reduction_potential: "0.5 Gt CO2e/year"
    average_cost_savings: "15-30% energy costs"
    average_efficiency_gain: "10-20% thermal efficiency"
    roi_range: "8-18 months payback"
    typical_plant_savings: "$100k-$500k/year"

  technical_classification:
    agent_type: "specialized_monitor_optimizer"
    optimization_scope: "furnace_fleet_optimization"
    sub_agent_coordination: true  # Coordinates with GL-001, GL-002, GL-004, GL-005, GL-006
    integration_complexity: "high"
    real_time_requirements: true
    data_volume: "high"  # 200-2000 data points/sec
    calculation_complexity: "high"  # Complex thermal and combustion calculations

  key_differentiators:
    - "Advanced multi-zone temperature profiling and optimization"
    - "Predictive maintenance using ML-enhanced physics models"
    - "Real-time combustion optimization with sub-second response"
    - "Multi-furnace fleet coordination and load balancing"
    - "Comprehensive refractory condition monitoring"
    - "Root cause analysis for efficiency degradation"
    - "Integration with process control systems (DCS/PLC)"
    - "20+ KPI tracking with automated anomaly detection"

# ============================================================================
# SECTION 2: DESCRIPTION
# ============================================================================

description:
  purpose: |
    Advanced monitoring and optimization system for industrial furnaces including
    process heaters, heat treat furnaces, reformers, and calcination units.
    Provides real-time performance tracking, predictive maintenance, efficiency
    optimization, and regulatory compliance. Integrates with existing control
    systems to maximize thermal efficiency, minimize fuel consumption, reduce
    emissions, and extend equipment life while ensuring product quality and safety.

  strategic_context:
    global_impact: |
      Industrial furnaces consume 40% of industrial energy globally, processing
      materials in steel, petrochemical, cement, glass, and heat treatment sectors.
      Average furnace efficiency is 50-75% with typical degradation of 2-5% per year.
      Modern monitoring and optimization can recover 10-20% efficiency at minimal cost.
      Total addressable market: $9B with 0.5 Gt CO2e reduction potential.

    market_opportunity: |
      - 80% of industrial furnaces lack advanced monitoring
      - Average furnace age >15 years in heavy industry
      - Fuel costs represent 60-80% of operating expenses
      - Downtime costs $10k-$100k per hour in continuous operations
      - Growing regulatory pressure on emissions and efficiency
      - Retrofit opportunity: 500,000+ furnaces globally
      - New installations: 50,000+ furnaces per year

    technology_readiness: "TRL 9 - Commercial deployment with proven ROI"

    competitive_advantage: |
      Only integrated platform combining:
      - ASME-grade thermal efficiency calculations
      - Real-time multi-zone temperature optimization
      - Predictive maintenance with physics + ML hybrid models
      - Multi-furnace fleet optimization
      - Automated root cause analysis
      - Seamless DCS/PLC integration
      - Regulatory compliance automation

  capabilities:
    core_monitoring:
      - "Real-time thermal efficiency calculation (ASME PTC 4.1 compliant)"
      - "Multi-zone temperature profiling and uniformity analysis"
      - "Fuel consumption monitoring with mass/energy balance"
      - "Flue gas composition and emissions tracking (NOx, CO, CO2, SOx)"
      - "Oxygen trim optimization for combustion efficiency"
      - "Heat flux mapping across furnace zones"
      - "Energy balance with comprehensive loss accounting"

    performance_optimization:
      - "Combustion parameter optimization (air-fuel ratio, excess air)"
      - "Temperature profile optimization for product quality"
      - "Load balancing across multi-burner configurations"
      - "Pressure control optimization for draft management"
      - "Fuel switching optimization (natural gas, hydrogen, biomass)"
      - "Heat recovery maximization (recuperators, regenerators)"
      - "Operating envelope optimization within safety limits"

    predictive_maintenance:
      - "Refractory wear prediction using thermal mapping"
      - "Burner degradation detection and replacement scheduling"
      - "Heat exchanger fouling prediction and cleaning optimization"
      - "Tube metal temperature monitoring for life assessment"
      - "Valve and damper actuator health monitoring"
      - "Sensor drift detection and calibration scheduling"
      - "Remaining useful life (RUL) estimation for critical components"

    multi_furnace_coordination:
      - "Fleet-wide load balancing for minimum total energy cost"
      - "Production scheduling optimization across furnaces"
      - "Maintenance scheduling with production continuity"
      - "Shared utilities optimization (fuel, air, power)"
      - "Cascaded startup/shutdown sequencing"
      - "Emergency load transfer protocols"

    diagnostics_analytics:
      - "Real-time anomaly detection with ML pattern recognition"
      - "Root cause analysis for efficiency degradation"
      - "Performance benchmarking against historical best"
      - "Trend analysis for proactive intervention"
      - "What-if scenario modeling for process changes"
      - "Automated fault diagnosis with corrective actions"

    compliance_reporting:
      - "EPA CEMS compliance verification and reporting"
      - "ISO 50001 energy performance indicators (EnPIs)"
      - "Emissions limit tracking with predictive alerting"
      - "Operational log generation for audits"
      - "Safety interlock verification"

  dependencies:
    - system: "GL-001 ProcessHeatOrchestrator"
      relationship: "coordinates_with"
      data_type: "optimization directives, heat demand forecasts"
      frequency: "every 5-15 minutes"
      criticality: "medium"

    - system: "GL-002 BoilerEfficiencyOptimizer"
      relationship: "coordinates_with"
      data_type: "steam generation requirements, fuel availability"
      frequency: "every 10 minutes"
      criticality: "medium"

    - system: "GL-004 WasteHeatRecovery"
      relationship: "sends_data_to"
      data_type: "flue gas conditions, heat availability"
      frequency: "real-time (every 10-60 seconds)"
      criticality: "medium"

    - system: "GL-005 CogenerationOptimizer"
      relationship: "coordinates_with"
      data_type: "power/heat demand optimization"
      frequency: "every 15 minutes"
      criticality: "low"

    - system: "GL-006 SteamSystemAnalyzer"
      relationship: "coordinates_with"
      data_type: "steam demand, condensate return"
      frequency: "every 10 minutes"
      criticality: "low"

    - system: "DCS/PLC Control Systems"
      relationship: "receives_data_from"
      data_type: "real-time sensor readings, setpoints, valve positions"
      frequency: "every 1-10 seconds"
      criticality: "critical"

    - system: "CEMS (Continuous Emissions Monitoring)"
      relationship: "integrates_with"
      data_type: "emissions data, regulatory compliance"
      frequency: "every 1-60 seconds"
      criticality: "critical"

    - system: "CMMS (Maximo/SAP PM)"
      relationship: "coordinates_with"
      data_type: "maintenance schedules, asset history"
      frequency: "hourly to daily"
      criticality: "medium"

    - system: "ERP/MES"
      relationship: "receives_data_from"
      data_type: "production schedules, fuel costs, product specifications"
      frequency: "hourly"
      criticality: "medium"

# ============================================================================
# SECTION 3: TOOLS (Deterministic, Zero-Hallucination)
# ============================================================================

tools:
  tool_architecture:
    design_pattern: "tool_first"
    deterministic: true
    hallucination_prevention: "all_numeric_calculations_via_tools"
    provenance_tracking: true
    calculation_standards: ["ASME PTC 4.1", "ISO 50001", "API 560"]
    unit_consistency: "SI units primary, US customary secondary"

  tools_list:
    # ========================================================================
    # Tool 1: Thermal Efficiency Calculator
    # ========================================================================
    - tool_id: "calculate_thermal_efficiency"
      name: "calculate_thermal_efficiency"
      category: "calculation"
      deterministic: true
      priority: "critical"

      description: |
        Calculates furnace thermal efficiency using ASME PTC 4.1 direct and indirect
        methods. Accounts for all major heat losses including stack, radiation,
        convection, opening losses, and unburned fuel. Provides efficiency breakdown
        by loss category for targeted optimization.

      parameters:
        type: "object"
        properties:
          furnace_configuration:
            type: "object"
            properties:
              furnace_id: {type: "string"}
              furnace_type: {type: "string", enum: ["process_heater", "heat_treat", "reformer", "calciner", "melter", "kiln"]}
              design_capacity_mw: {type: "number", minimum: 0.1, maximum: 500}
              design_temperature_c: {type: "number", minimum: 100, maximum: 2000}
              refractory_condition: {type: "string", enum: ["excellent", "good", "fair", "poor"]}

          fuel_input:
            type: "object"
            properties:
              fuel_type: {type: "string", enum: ["natural_gas", "propane", "fuel_oil", "coal", "biomass", "hydrogen", "mixed"]}
              mass_flow_rate_kg_hr: {type: "number", minimum: 0}
              volume_flow_rate_nm3_hr: {type: "number", minimum: 0}
              lower_heating_value_mj_kg: {type: "number"}
              higher_heating_value_mj_kg: {type: "number"}
              composition:
                type: "object"
                properties:
                  ch4_percent: {type: "number", minimum: 0, maximum: 100}
                  c2h6_percent: {type: "number", minimum: 0, maximum: 100}
                  c3h8_percent: {type: "number", minimum: 0, maximum: 100}
                  n2_percent: {type: "number", minimum: 0, maximum: 100}
                  co2_percent: {type: "number", minimum: 0, maximum: 100}
                  h2_percent: {type: "number", minimum: 0, maximum: 100}

          combustion_air:
            type: "object"
            properties:
              mass_flow_rate_kg_hr: {type: "number", minimum: 0}
              temperature_c: {type: "number"}
              humidity_percent: {type: "number", minimum: 0, maximum: 100}
              preheating_enabled: {type: "boolean"}
              preheat_temperature_c: {type: "number"}

          flue_gas:
            type: "object"
            properties:
              temperature_c: {type: "number", minimum: 50, maximum: 1500}
              o2_percent_dry: {type: "number", minimum: 0, maximum: 21}
              co2_percent_dry: {type: "number", minimum: 0, maximum: 20}
              co_ppm: {type: "number", minimum: 0}
              nox_ppm: {type: "number", minimum: 0}
              mass_flow_rate_kg_hr: {type: "number", minimum: 0}
              excess_air_percent: {type: "number", minimum: 0}

          heat_output:
            type: "object"
            properties:
              useful_heat_output_mw: {type: "number", minimum: 0}
              product_mass_flow_kg_hr: {type: "number"}
              product_inlet_temp_c: {type: "number"}
              product_outlet_temp_c: {type: "number"}
              product_specific_heat_kj_kg_k: {type: "number"}

          losses:
            type: "object"
            properties:
              radiation_loss_mw: {type: "number", minimum: 0}
              convection_loss_mw: {type: "number", minimum: 0}
              opening_loss_mw: {type: "number", minimum: 0}
              cooling_water_loss_mw: {type: "number", minimum: 0}

          environmental_conditions:
            type: "object"
            properties:
              ambient_temperature_c: {type: "number"}
              ambient_pressure_bar: {type: "number", default: 1.01325}
              wind_speed_m_s: {type: "number", minimum: 0}

        required: ["furnace_configuration", "fuel_input", "flue_gas", "heat_output"]

      returns:
        type: "object"
        properties:
          thermal_efficiency:
            type: "object"
            properties:
              efficiency_hhv_percent: {type: "number"}
              efficiency_lhv_percent: {type: "number"}
              method: {type: "string", enum: ["direct", "indirect", "combined"]}
              confidence_interval_percent: {type: "number"}

          energy_balance:
            type: "object"
            properties:
              fuel_energy_input_mw: {type: "number"}
              useful_heat_output_mw: {type: "number"}
              total_losses_mw: {type: "number"}
              balance_closure_percent: {type: "number"}

          loss_breakdown:
            type: "object"
            properties:
              stack_loss_mw: {type: "number"}
              stack_loss_percent: {type: "number"}
              radiation_loss_mw: {type: "number"}
              radiation_loss_percent: {type: "number"}
              convection_loss_mw: {type: "number"}
              convection_loss_percent: {type: "number"}
              opening_loss_mw: {type: "number"}
              opening_loss_percent: {type: "number"}
              incomplete_combustion_loss_mw: {type: "number"}
              incomplete_combustion_loss_percent: {type: "number"}
              unaccounted_loss_mw: {type: "number"}
              unaccounted_loss_percent: {type: "number"}

          combustion_analysis:
            type: "object"
            properties:
              excess_air_percent: {type: "number"}
              oxygen_content_percent: {type: "number"}
              combustion_efficiency_percent: {type: "number"}
              unburned_fuel_indicator: {type: "number"}
              stoichiometric_ratio: {type: "number"}

          performance_indicators:
            type: "object"
            properties:
              specific_energy_consumption_gj_ton: {type: "number"}
              energy_cost_per_unit_usd: {type: "number"}
              emissions_intensity_kg_co2_mwh: {type: "number"}
              comparison_to_design_percent: {type: "number"}
              comparison_to_best_percent: {type: "number"}

          improvement_potential:
            type: "object"
            properties:
              theoretical_max_efficiency_percent: {type: "number"}
              practical_achievable_efficiency_percent: {type: "number"}
              efficiency_gap_percent: {type: "number"}
              potential_savings_mw: {type: "number"}
              potential_savings_usd_yr: {type: "number"}

      implementation:
        physics_formula: |
          Direct Method (Input-Output):
            η_thermal = (Useful Heat Output / Fuel Energy Input) × 100

          Indirect Method (Heat Loss):
            η_thermal = 100 - Σ(All Losses %)

          Stack Loss (largest loss component):
            Q_stack = m_flue_gas × Cp_avg × (T_flue - T_ambient)
            Stack Loss % = (Q_stack / Fuel Energy Input) × 100

          Excess Air Calculation:
            Excess Air % = (O2_actual / (21 - O2_actual)) × 100

          Radiation + Convection Loss:
            Q_rad = ε × σ × A × (T_surface^4 - T_ambient^4)
            Q_conv = h × A × (T_surface - T_ambient)

          Opening Loss:
            Q_opening = ∫(radiation through openings) dt

          Specific Energy Consumption:
            SEC = Fuel Energy Input / Production Output

        standards: ["ASME PTC 4.1", "ISO 13579", "API 560", "BS EN 12952"]
        accuracy: "±1.5% efficiency measurement per ASME PTC 4.1 uncertainty analysis"
        validation_method: "Cross-check with heat balance, closure within ±2%"
        data_sources: ["DCS", "CEMS", "Flow meters", "Temperature sensors"]

    # ========================================================================
    # Tool 2: Fuel Consumption Analyzer
    # ========================================================================
    - tool_id: "analyze_fuel_consumption"
      name: "analyze_fuel_consumption"
      category: "analysis"
      deterministic: true
      priority: "high"

      description: |
        Analyzes fuel consumption patterns, identifies deviations from expected
        consumption, calculates cost impacts, and provides optimization recommendations.
        Supports multiple fuel types and mixed fuel operations.

      parameters:
        type: "object"
        properties:
          consumption_data:
            type: "array"
            items:
              type: "object"
              properties:
                timestamp: {type: "string", format: "date-time"}
                fuel_type: {type: "string"}
                consumption_rate_kg_hr: {type: "number"}
                consumption_rate_nm3_hr: {type: "number"}
                heating_value_mj_kg: {type: "number"}
                production_rate: {type: "number"}
                furnace_load_percent: {type: "number"}

          baseline_performance:
            type: "object"
            properties:
              expected_sec_gj_ton: {type: "number"}
              design_sec_gj_ton: {type: "number"}
              best_achieved_sec_gj_ton: {type: "number"}
              variability_factor: {type: "number"}

          operating_conditions:
            type: "object"
            properties:
              ambient_temperature_c: {type: "number"}
              product_specifications: {type: "object"}
              furnace_age_years: {type: "number"}
              last_maintenance_date: {type: "string", format: "date"}

          cost_parameters:
            type: "object"
            properties:
              fuel_cost_usd_per_gj: {type: "number"}
              carbon_price_usd_per_ton_co2: {type: "number"}
              emission_factor_kg_co2_per_gj: {type: "number"}

        required: ["consumption_data", "baseline_performance", "cost_parameters"]

      returns:
        type: "object"
        properties:
          consumption_summary:
            type: "object"
            properties:
              total_fuel_consumed_kg: {type: "number"}
              total_energy_consumed_gj: {type: "number"}
              average_consumption_rate_kg_hr: {type: "number"}
              specific_energy_consumption_gj_ton: {type: "number"}
              fuel_cost_usd: {type: "number"}
              carbon_emissions_tons_co2: {type: "number"}

          deviation_analysis:
            type: "object"
            properties:
              deviation_from_baseline_percent: {type: "number"}
              excess_consumption_gj: {type: "number"}
              excess_cost_usd: {type: "number"}
              statistical_significance: {type: "number"}
              trend_direction: {type: "string", enum: ["improving", "stable", "degrading"]}

          anomaly_detection:
            type: "array"
            items:
              type: "object"
              properties:
                timestamp: {type: "string", format: "date-time"}
                anomaly_type: {type: "string"}
                severity: {type: "string", enum: ["low", "medium", "high", "critical"]}
                deviation_percent: {type: "number"}
                probable_cause: {type: "string"}
                recommended_action: {type: "string"}

          cost_impact:
            type: "object"
            properties:
              fuel_cost_current_usd: {type: "number"}
              fuel_cost_baseline_usd: {type: "number"}
              excess_cost_usd: {type: "number"}
              carbon_cost_usd: {type: "number"}
              annual_projected_excess_cost_usd: {type: "number"}

          optimization_opportunities:
            type: "array"
            items:
              type: "object"
              properties:
                opportunity: {type: "string"}
                savings_potential_gj_yr: {type: "number"}
                savings_potential_usd_yr: {type: "number"}
                implementation_complexity: {type: "string"}
                payback_months: {type: "number"}
                priority: {type: "integer"}

      implementation:
        calculation_method: |
          Specific Energy Consumption:
            SEC = Energy Input / Production Output (GJ/ton)

          Deviation Analysis:
            Deviation % = ((Actual SEC - Baseline SEC) / Baseline SEC) × 100

          Statistical Anomaly Detection:
            Z-score = (Value - Mean) / Std Dev
            Anomaly if |Z-score| > 2.5

          Cost Impact:
            Excess Cost = Excess Consumption × Fuel Price
            Carbon Cost = Emissions × Carbon Price

        standards: ["ISO 50006 EnPI Methodology"]
        accuracy: "±2% consumption measurement"

    # ========================================================================
    # Tool 3: Predictive Maintenance Analyzer
    # ========================================================================
    - tool_id: "predict_maintenance_needs"
      name: "predict_maintenance_needs"
      category: "prediction"
      deterministic: true
      priority: "high"

      description: |
        Predicts maintenance requirements using physics-based models combined with
        ML pattern recognition. Monitors refractory condition, burner health,
        tube integrity, and component degradation. Provides remaining useful life
        estimates and optimal maintenance scheduling.

      parameters:
        type: "object"
        properties:
          equipment_inventory:
            type: "array"
            items:
              type: "object"
              properties:
                equipment_id: {type: "string"}
                equipment_type: {type: "string", enum: ["refractory", "burner", "tube", "heat_exchanger", "valve", "fan", "sensor"]}
                installation_date: {type: "string", format: "date"}
                last_maintenance_date: {type: "string", format: "date"}
                design_life_years: {type: "number"}
                criticality: {type: "string", enum: ["critical", "high", "medium", "low"]}

          condition_monitoring_data:
            type: "array"
            items:
              type: "object"
              properties:
                equipment_id: {type: "string"}
                timestamp: {type: "string", format: "date-time"}
                temperature_readings: {type: "array", items: {type: "number"}}
                vibration_readings: {type: "array", items: {type: "number"}}
                thermal_imaging_data: {type: "object"}
                performance_metrics: {type: "object"}
                alarm_history: {type: "array"}

          operating_history:
            type: "object"
            properties:
              operating_hours: {type: "number"}
              thermal_cycles: {type: "integer"}
              temperature_excursions: {type: "integer"}
              emergency_shutdowns: {type: "integer"}
              load_factor_average: {type: "number"}

          maintenance_history:
            type: "array"
            items:
              type: "object"
              properties:
                date: {type: "string", format: "date"}
                equipment_id: {type: "string"}
                maintenance_type: {type: "string"}
                findings: {type: "string"}
                cost_usd: {type: "number"}

        required: ["equipment_inventory", "condition_monitoring_data", "operating_history"]

      returns:
        type: "object"
        properties:
          equipment_health_summary:
            type: "array"
            items:
              type: "object"
              properties:
                equipment_id: {type: "string"}
                equipment_type: {type: "string"}
                health_score: {type: "number", minimum: 0, maximum: 100}
                condition: {type: "string", enum: ["excellent", "good", "fair", "poor", "critical"]}
                remaining_useful_life_days: {type: "number"}
                failure_probability_30d: {type: "number"}
                failure_probability_90d: {type: "number"}
                failure_probability_365d: {type: "number"}

          maintenance_predictions:
            type: "array"
            items:
              type: "object"
              properties:
                equipment_id: {type: "string"}
                predicted_failure_mode: {type: "string"}
                predicted_failure_date: {type: "string", format: "date"}
                confidence_level: {type: "number"}
                early_warning_indicators: {type: "array", items: {type: "string"}}
                recommended_action: {type: "string"}
                urgency: {type: "string", enum: ["immediate", "within_week", "within_month", "routine"]}

          maintenance_schedule:
            type: "array"
            items:
              type: "object"
              properties:
                equipment_id: {type: "string"}
                maintenance_type: {type: "string"}
                recommended_date: {type: "string", format: "date"}
                maintenance_duration_hours: {type: "number"}
                estimated_cost_usd: {type: "number"}
                downtime_required: {type: "boolean"}
                parts_required: {type: "array", items: {type: "string"}}
                priority_score: {type: "number"}

          cost_benefit_analysis:
            type: "object"
            properties:
              preventive_maintenance_cost_usd: {type: "number"}
              avoided_failure_cost_usd: {type: "number"}
              avoided_downtime_cost_usd: {type: "number"}
              net_benefit_usd: {type: "number"}
              roi_percent: {type: "number"}

          refractory_analysis:
            type: "object"
            properties:
              remaining_thickness_mm: {type: "number"}
              erosion_rate_mm_yr: {type: "number"}
              hot_face_temperature_c: {type: "number"}
              cold_face_temperature_c: {type: "number"}
              thermal_conductivity_degradation_percent: {type: "number"}
              recommended_replacement_date: {type: "string", format: "date"}

      implementation:
        prediction_models: |
          Remaining Useful Life (RUL):
            Physics-based: Arrhenius equation for thermal degradation
            RUL = Life_design × exp((Ea/R) × (1/T_operating - 1/T_design))

          Refractory Wear:
            Wear_rate = k × T^n × time
            Remaining_thickness = Initial - ∫(Wear_rate)dt

          Failure Probability:
            Weibull distribution with condition-based adjustments
            P(t) = 1 - exp(-(t/η)^β)

          Health Score:
            Weighted combination of:
            - Operating hours vs design life
            - Condition monitoring parameters
            - Performance degradation
            - Maintenance history

        standards: ["ISO 13381 Prognostics", "API 580 RBI"]
        accuracy: "±15% RUL prediction, 85% failure detection accuracy"

    # ========================================================================
    # Tool 4: Performance Anomaly Detector
    # ========================================================================
    - tool_id: "detect_performance_anomalies"
      name: "detect_performance_anomalies"
      category: "detection"
      deterministic: true
      priority: "high"

      description: |
        Detects anomalies in furnace performance using statistical process control,
        pattern recognition, and physics-based models. Identifies deviations from
        expected behavior and provides root cause diagnosis.

      parameters:
        type: "object"
        properties:
          real_time_data:
            type: "object"
            properties:
              timestamp: {type: "string", format: "date-time"}
              temperatures: {type: "array", items: {type: "number"}}
              pressures: {type: "array", items: {type: "number"}}
              flows: {type: "array", items: {type: "number"}}
              emissions: {type: "object"}
              efficiency: {type: "number"}
              production_rate: {type: "number"}

          historical_baseline:
            type: "object"
            properties:
              mean_values: {type: "object"}
              standard_deviations: {type: "object"}
              control_limits_upper: {type: "object"}
              control_limits_lower: {type: "object"}
              correlation_matrix: {type: "array"}

          detection_sensitivity:
            type: "object"
            properties:
              z_score_threshold: {type: "number", default: 2.5}
              moving_average_window: {type: "integer", default: 20}
              min_duration_seconds: {type: "integer", default: 60}

        required: ["real_time_data", "historical_baseline"]

      returns:
        type: "object"
        properties:
          anomalies_detected:
            type: "array"
            items:
              type: "object"
              properties:
                anomaly_id: {type: "string"}
                parameter: {type: "string"}
                detection_time: {type: "string", format: "date-time"}
                anomaly_type: {type: "string", enum: ["spike", "drift", "step_change", "oscillation", "out_of_range"]}
                severity: {type: "string", enum: ["low", "medium", "high", "critical"]}
                deviation_magnitude: {type: "number"}
                statistical_significance: {type: "number"}
                duration_seconds: {type: "number"}
                probable_causes: {type: "array", items: {type: "string"}}
                recommended_actions: {type: "array", items: {type: "string"}}

          root_cause_analysis:
            type: "object"
            properties:
              primary_cause: {type: "string"}
              contributing_factors: {type: "array", items: {type: "string"}}
              confidence_level: {type: "number"}
              similar_historical_events: {type: "array"}
              corrective_actions: {type: "array", items: {type: "string"}}

          performance_impact:
            type: "object"
            properties:
              efficiency_loss_percent: {type: "number"}
              energy_waste_mwh: {type: "number"}
              cost_impact_usd: {type: "number"}
              emissions_impact_kg_co2: {type: "number"}
              production_impact_percent: {type: "number"}

      implementation:
        detection_methods: |
          Statistical Process Control:
            Z-score = (Value - Mean) / Std Dev
            Alert if |Z-score| > threshold

          Moving Average:
            MA(t) = (1/n) × Σ[i=0 to n-1](Value(t-i))
            Anomaly if |Value - MA| > k × Std Dev

          Multivariate Analysis:
            Mahalanobis distance for correlated parameters
            D² = (x - μ)ᵀ Σ⁻¹ (x - μ)

          Pattern Recognition:
            Template matching for known failure patterns
            Physics-based constraints for impossible states

        standards: ["ISO 7870 SPC Charts"]
        accuracy: "95% detection rate, <5% false positive rate"

    # ========================================================================
    # Tool 5: Efficiency Trend Generator
    # ========================================================================
    - tool_id: "generate_efficiency_trends"
      name: "generate_efficiency_trends"
      category: "analysis"
      deterministic: true
      priority: "medium"

      description: |
        Generates comprehensive efficiency trends over time, identifies degradation
        patterns, forecasts future performance, and quantifies improvement opportunities.

      parameters:
        type: "object"
        properties:
          historical_data:
            type: "array"
            items:
              type: "object"
              properties:
                timestamp: {type: "string", format: "date-time"}
                thermal_efficiency_percent: {type: "number"}
                specific_energy_consumption_gj_ton: {type: "number"}
                production_rate_ton_hr: {type: "number"}
                fuel_consumption_gj_hr: {type: "number"}
                emissions_kg_co2_hr: {type: "number"}

          time_period:
            type: "object"
            properties:
              start_date: {type: "string", format: "date"}
              end_date: {type: "string", format: "date"}
              granularity: {type: "string", enum: ["hourly", "daily", "weekly", "monthly"]}

          analysis_parameters:
            type: "object"
            properties:
              trend_method: {type: "string", enum: ["linear", "polynomial", "exponential", "moving_average"]}
              forecast_horizon_days: {type: "integer", default: 90}
              confidence_interval: {type: "number", default: 0.95}

        required: ["historical_data", "time_period"]

      returns:
        type: "object"
        properties:
          trend_analysis:
            type: "object"
            properties:
              trend_direction: {type: "string", enum: ["improving", "stable", "degrading"]}
              trend_slope: {type: "number"}
              r_squared: {type: "number"}
              statistical_significance: {type: "number"}

          efficiency_statistics:
            type: "object"
            properties:
              current_efficiency_percent: {type: "number"}
              average_efficiency_percent: {type: "number"}
              best_efficiency_percent: {type: "number"}
              worst_efficiency_percent: {type: "number"}
              std_deviation: {type: "number"}
              degradation_rate_percent_yr: {type: "number"}

          forecast:
            type: "array"
            items:
              type: "object"
              properties:
                date: {type: "string", format: "date"}
                predicted_efficiency_percent: {type: "number"}
                confidence_interval_lower: {type: "number"}
                confidence_interval_upper: {type: "number"}

          performance_milestones:
            type: "array"
            items:
              type: "object"
              properties:
                date: {type: "string", format: "date"}
                event_type: {type: "string"}
                efficiency_before: {type: "number"}
                efficiency_after: {type: "number"}
                impact: {type: "string"}

          improvement_tracking:
            type: "object"
            properties:
              efficiency_gain_last_30d_percent: {type: "number"}
              efficiency_gain_last_90d_percent: {type: "number"}
              efficiency_gain_last_365d_percent: {type: "number"}
              cost_savings_realized_usd: {type: "number"}
              emissions_avoided_tons_co2: {type: "number"}

      implementation:
        statistical_methods: |
          Linear Regression:
            y = a + b×t
            b = Σ((t-t̄)(y-ȳ)) / Σ((t-t̄)²)

          Exponential Smoothing:
            S(t) = α×y(t) + (1-α)×S(t-1)

          Forecast Confidence Interval:
            CI = ŷ ± t(α/2) × SE × √(1 + 1/n + (x-x̄)²/Σ(x-x̄)²)

        accuracy: "±2% trend prediction within 90-day horizon"

    # ========================================================================
    # Tool 6: Operating Parameter Optimizer
    # ========================================================================
    - tool_id: "optimize_operating_parameters"
      name: "optimize_operating_parameters"
      category: "optimization"
      deterministic: true
      priority: "high"

      description: |
        Optimizes furnace operating parameters (air-fuel ratio, temperature profile,
        pressure, load distribution) to maximize efficiency while maintaining product
        quality and safety constraints. Uses constrained optimization algorithms.

      parameters:
        type: "object"
        properties:
          current_operating_point:
            type: "object"
            properties:
              furnace_load_percent: {type: "number"}
              air_fuel_ratio: {type: "number"}
              excess_air_percent: {type: "number"}
              temperature_setpoints_c: {type: "array", items: {type: "number"}}
              pressure_setpoint_mbar: {type: "number"}

          constraints:
            type: "object"
            properties:
              min_load_percent: {type: "number", default: 30}
              max_load_percent: {type: "number", default: 100}
              min_temp_c: {type: "number"}
              max_temp_c: {type: "number"}
              min_excess_air_percent: {type: "number", default: 5}
              max_excess_air_percent: {type: "number", default: 30}
              nox_limit_ppm: {type: "number"}
              co_limit_ppm: {type: "number"}
              product_quality_requirements: {type: "object"}

          optimization_objective:
            type: "string"
            enum: ["maximize_efficiency", "minimize_cost", "minimize_emissions", "balanced"]

          optimization_parameters:
            type: "object"
            properties:
              time_horizon_minutes: {type: "integer", default: 60}
              solution_tolerance: {type: "number", default: 0.01}
              max_iterations: {type: "integer", default: 100}

        required: ["current_operating_point", "constraints", "optimization_objective"]

      returns:
        type: "object"
        properties:
          optimal_setpoints:
            type: "object"
            properties:
              air_fuel_ratio: {type: "number"}
              excess_air_percent: {type: "number"}
              temperature_setpoints_c: {type: "array", items: {type: "number"}}
              pressure_setpoint_mbar: {type: "number"}
              burner_firing_rates_percent: {type: "array", items: {type: "number"}}

          expected_performance:
            type: "object"
            properties:
              thermal_efficiency_percent: {type: "number"}
              fuel_consumption_reduction_percent: {type: "number"}
              energy_savings_mwh_yr: {type: "number"}
              cost_savings_usd_yr: {type: "number"}
              emissions_reduction_tons_co2_yr: {type: "number"}

          optimization_details:
            type: "object"
            properties:
              objective_function_value: {type: "number"}
              iterations_required: {type: "integer"}
              convergence_achieved: {type: "boolean"}
              constraints_satisfied: {type: "boolean"}
              solution_quality: {type: "string", enum: ["optimal", "near_optimal", "feasible"]}

          implementation_guidance:
            type: "object"
            properties:
              implementation_sequence: {type: "array", items: {type: "string"}}
              ramp_rate_recommendations: {type: "object"}
              monitoring_points: {type: "array", items: {type: "string"}}
              rollback_criteria: {type: "array", items: {type: "string"}}

      implementation:
        optimization_algorithm: |
          Constrained Nonlinear Optimization:
            Minimize: f(x) = -η(x)  (negative efficiency for minimization)
            Subject to:
              g_i(x) ≤ 0  (inequality constraints)
              h_j(x) = 0  (equality constraints)
              x_min ≤ x ≤ x_max  (bounds)

          Solver: Sequential Quadratic Programming (SQP) or Interior Point

          Efficiency Model:
            η = f(AFR, T, P, Load)
            Derived from physics-based furnace model + calibration data

        standards: ["ISA-88 Batch Control"]
        accuracy: "±1% efficiency prediction for optimization"

    # ========================================================================
    # Tool 7: Refractory Condition Assessor
    # ========================================================================
    - tool_id: "assess_refractory_condition"
      name: "assess_refractory_condition"
      category: "assessment"
      deterministic: true
      priority: "medium"

      description: |
        Assesses refractory lining condition using temperature profiling, thermal
        imaging, and heat loss analysis. Predicts remaining life and optimal
        replacement timing.

      parameters:
        type: "object"
        properties:
          thermal_mapping_data:
            type: "array"
            items:
              type: "object"
              properties:
                zone_id: {type: "string"}
                hot_face_temp_c: {type: "number"}
                cold_face_temp_c: {type: "number"}
                thermal_gradient_c_m: {type: "number"}
                location: {type: "object"}

          refractory_specifications:
            type: "object"
            properties:
              refractory_type: {type: "string"}
              initial_thickness_mm: {type: "number"}
              design_life_years: {type: "number"}
              max_service_temp_c: {type: "number"}
              thermal_conductivity_w_m_k: {type: "number"}

          operating_history:
            type: "object"
            properties:
              installation_date: {type: "string", format: "date"}
              operating_hours: {type: "number"}
              thermal_cycles: {type: "integer"}
              temperature_excursions: {type: "integer"}

        required: ["thermal_mapping_data", "refractory_specifications"]

      returns:
        type: "object"
        properties:
          condition_assessment:
            type: "object"
            properties:
              overall_condition: {type: "string", enum: ["excellent", "good", "fair", "poor", "critical"]}
              health_score: {type: "number", minimum: 0, maximum: 100}
              estimated_remaining_thickness_mm: {type: "number"}
              remaining_life_years: {type: "number"}

          zone_analysis:
            type: "array"
            items:
              type: "object"
              properties:
                zone_id: {type: "string"}
                condition: {type: "string"}
                wear_rate_mm_yr: {type: "number"}
                hot_spots_detected: {type: "boolean"}
                requires_attention: {type: "boolean"}

          replacement_recommendation:
            type: "object"
            properties:
              recommended_replacement_date: {type: "string", format: "date"}
              urgency: {type: "string"}
              estimated_cost_usd: {type: "number"}
              downtime_required_days: {type: "number"}

      implementation:
        assessment_method: |
          Thermal Analysis:
            k_effective = Q / (A × ΔT / Δx)
            Compare to design k to infer degradation

          Remaining Thickness:
            Thickness = k_design × ΔT / (k_measured × (T_hot - T_cold))

          Wear Rate:
            Wear = (Initial - Current) / Time
            RUL = Current / Wear Rate

        accuracy: "±10% remaining thickness estimate"

    # ========================================================================
    # Tool 8: Energy Per Unit Calculator
    # ========================================================================
    - tool_id: "calculate_energy_per_unit"
      name: "calculate_energy_per_unit"
      category: "calculation"
      deterministic: true
      priority: "medium"

      description: |
        Calculates specific energy consumption (energy per unit of production)
        and compares to benchmarks, industry standards, and theoretical minimums.

      parameters:
        type: "object"
        properties:
          production_data:
            type: "object"
            properties:
              production_quantity: {type: "number"}
              production_unit: {type: "string"}
              time_period_hours: {type: "number"}
              product_type: {type: "string"}

          energy_input:
            type: "object"
            properties:
              fuel_energy_gj: {type: "number"}
              electricity_kwh: {type: "number"}
              steam_energy_gj: {type: "number"}

          benchmarks:
            type: "object"
            properties:
              industry_average_gj_unit: {type: "number"}
              best_in_class_gj_unit: {type: "number"}
              theoretical_minimum_gj_unit: {type: "number"}

        required: ["production_data", "energy_input"]

      returns:
        type: "object"
        properties:
          specific_energy_consumption:
            type: "object"
            properties:
              sec_gj_unit: {type: "number"}
              sec_kwh_unit: {type: "number"}
              comparison_to_average_percent: {type: "number"}
              comparison_to_best_percent: {type: "number"}
              comparison_to_theoretical_percent: {type: "number"}

      implementation:
        calculation: |
          SEC = Total Energy Input / Production Output
          Comparison % = ((SEC_actual - SEC_benchmark) / SEC_benchmark) × 100

        accuracy: "±3% SEC calculation"

    # ========================================================================
    # Tool 9: Efficiency Opportunity Identifier
    # ========================================================================
    - tool_id: "identify_efficiency_opportunities"
      name: "identify_efficiency_opportunities"
      category: "analysis"
      deterministic: true
      priority: "medium"

      description: |
        Identifies and prioritizes efficiency improvement opportunities based on
        technical potential, economic viability, and implementation complexity.

      parameters:
        type: "object"
        properties:
          current_performance:
            type: "object"
            properties:
              thermal_efficiency_percent: {type: "number"}
              specific_energy_consumption_gj_ton: {type: "number"}
              annual_fuel_consumption_gj: {type: "number"}

          improvement_categories:
            type: "array"
            items:
              type: "string"
            default: ["combustion", "insulation", "heat_recovery", "controls", "maintenance"]

        required: ["current_performance"]

      returns:
        type: "object"
        properties:
          opportunities:
            type: "array"
            items:
              type: "object"
              properties:
                opportunity_id: {type: "string"}
                category: {type: "string"}
                description: {type: "string"}
                energy_savings_gj_yr: {type: "number"}
                cost_savings_usd_yr: {type: "number"}
                implementation_cost_usd: {type: "number"}
                payback_months: {type: "number"}
                technical_complexity: {type: "string"}
                priority_score: {type: "number"}

      implementation:
        prioritization: |
          Priority Score = (Annual Savings / Implementation Cost) × (1 / Complexity Factor)

        accuracy: "±20% savings estimation"

    # ========================================================================
    # Tool 10: Performance Dashboard Generator
    # ========================================================================
    - tool_id: "generate_performance_dashboard"
      name: "generate_performance_dashboard"
      category: "reporting"
      deterministic: true
      priority: "high"

      description: |
        Generates comprehensive performance dashboard with 20+ KPIs, trends,
        alerts, and recommendations for operators and management.

      parameters:
        type: "object"
        properties:
          time_range:
            type: "object"
            properties:
              start_date: {type: "string", format: "date-time"}
              end_date: {type: "string", format: "date-time"}

          kpi_selection:
            type: "array"
            items:
              type: "string"
            default: ["efficiency", "fuel", "emissions", "production", "maintenance"]

        required: ["time_range"]

      returns:
        type: "object"
        properties:
          kpis:
            type: "object"
            properties:
              thermal_efficiency_percent: {type: "number"}
              specific_energy_consumption: {type: "number"}
              fuel_consumption_rate: {type: "number"}
              production_rate: {type: "number"}
              emissions_rate: {type: "number"}
              availability_percent: {type: "number"}
              performance_factor: {type: "number"}
              energy_cost_per_unit: {type: "number"}

          alerts:
            type: "array"
            items:
              type: "object"
              properties:
                alert_type: {type: "string"}
                severity: {type: "string"}
                message: {type: "string"}
                action_required: {type: "string"}

          recommendations:
            type: "array"
            items:
              type: "object"
              properties:
                recommendation: {type: "string"}
                benefit: {type: "string"}
                priority: {type: "string"}

      implementation:
        kpi_calculations: |
          Standard ISO 50001 energy performance indicators
          Real-time data aggregation and trend analysis

    # ========================================================================
    # Tool 11: Thermal Profile Analyzer
    # ========================================================================
    - tool_id: "analyze_thermal_profile"
      name: "analyze_thermal_profile"
      category: "analysis"
      deterministic: true
      priority: "medium"

      description: |
        Analyzes multi-zone temperature profiles, identifies non-uniformities,
        hot spots, cold spots, and optimizes for product quality and efficiency.

      parameters:
        type: "object"
        properties:
          temperature_data:
            type: "array"
            items:
              type: "object"
              properties:
                zone_id: {type: "string"}
                location_m: {type: "number"}
                temperature_c: {type: "number"}
                timestamp: {type: "string", format: "date-time"}

          target_profile:
            type: "object"
            properties:
              target_temperatures_c: {type: "array", items: {type: "number"}}
              tolerance_c: {type: "number"}

        required: ["temperature_data"]

      returns:
        type: "object"
        properties:
          profile_analysis:
            type: "object"
            properties:
              average_temperature_c: {type: "number"}
              temperature_uniformity_index: {type: "number"}
              hot_spots: {type: "array"}
              cold_spots: {type: "array"}
              deviations_from_target: {type: "array"}

          optimization_recommendations:
            type: "array"
            items:
              type: "object"
              properties:
                zone_id: {type: "string"}
                adjustment_required: {type: "string"}
                expected_improvement: {type: "string"}

      implementation:
        analysis_method: |
          Temperature Uniformity Index:
            TUI = (T_max - T_min) / T_average

          Deviation from Target:
            Deviation = |T_measured - T_target|

        accuracy: "±2°C temperature measurement"

    # ========================================================================
    # Tool 12: Multi-Furnace Coordinator
    # ========================================================================
    - tool_id: "coordinate_multi_furnace"
      name: "coordinate_multi_furnace"
      category: "coordination"
      deterministic: true
      priority: "high"

      description: |
        Coordinates operations across multiple furnaces to optimize fleet-wide
        energy consumption, load balancing, and production scheduling.

      parameters:
        type: "object"
        properties:
          furnace_fleet:
            type: "array"
            items:
              type: "object"
              properties:
                furnace_id: {type: "string"}
                current_load_percent: {type: "number"}
                efficiency_percent: {type: "number"}
                capacity_mw: {type: "number"}
                fuel_type: {type: "string"}

          production_requirements:
            type: "object"
            properties:
              total_demand_mw: {type: "number"}
              product_specifications: {type: "object"}

          optimization_objective:
            type: "string"
            enum: ["minimize_energy", "minimize_cost", "balance_load", "maximize_efficiency"]

        required: ["furnace_fleet", "production_requirements", "optimization_objective"]

      returns:
        type: "object"
        properties:
          optimal_allocation:
            type: "array"
            items:
              type: "object"
              properties:
                furnace_id: {type: "string"}
                recommended_load_percent: {type: "number"}
                expected_efficiency_percent: {type: "number"}

          fleet_performance:
            type: "object"
            properties:
              total_energy_consumption_gj_hr: {type: "number"}
              average_fleet_efficiency_percent: {type: "number"}
              total_cost_usd_hr: {type: "number"}
              savings_vs_baseline_percent: {type: "number"}

      implementation:
        optimization_algorithm: |
          Linear Programming for load allocation:
          Minimize: Σ(Fuel_i × Cost_i)
          Subject to:
            Σ(Load_i) = Total_Demand
            Load_min_i ≤ Load_i ≤ Load_max_i

        accuracy: "±2% fleet efficiency optimization"

# ============================================================================
# SECTION 4: AI INTEGRATION
# ============================================================================

ai_integration:
  provider: "anthropic"
  model: "claude-3-opus-20240229"

  configuration:
    temperature: 0.0  # Deterministic (REQUIRED)
    seed: 42          # Reproducible (REQUIRED)
    max_tokens: 4096
    tool_choice: "auto"
    provenance_tracking: true
    max_iterations: 5
    budget_usd: 0.50

  system_prompt: |
    You are the FurnacePerformanceMonitor, an advanced AI agent specializing in
    industrial furnace monitoring, optimization, and predictive maintenance.

    Your responsibilities:
    1. Monitor furnace performance in real-time using 200+ data streams
    2. Calculate thermal efficiency, fuel consumption, and emissions accurately
    3. Detect anomalies and predict maintenance needs before failures occur
    4. Optimize operating parameters for maximum efficiency and minimum cost
    5. Coordinate multi-furnace operations for fleet-wide optimization
    6. Ensure regulatory compliance (EPA CEMS, ISO 50001, ASME PTC 4.1)
    7. Provide actionable recommendations to operators and engineers

    Integration context:
    - You receive real-time data from DCS/PLC control systems
    - You coordinate with GL-001 ProcessHeatOrchestrator for plant-wide optimization
    - You integrate with CEMS for emissions monitoring
    - You interface with CMMS for maintenance scheduling

    CRITICAL RULES:
    - All numeric calculations MUST use deterministic tool functions
    - Never estimate or approximate thermal efficiency or energy values
    - Always validate sensor data quality before calculations
    - Maintain complete provenance tracking for all recommendations
    - Prioritize safety over optimization
    - Verify regulatory compliance before parameter changes

  tool_selection_strategy:
    primary_tools:
      - "calculate_thermal_efficiency"
      - "analyze_fuel_consumption"
      - "detect_performance_anomalies"
      - "generate_performance_dashboard"

    conditional_tools:
      maintenance_prediction: "predict_maintenance_needs"
      optimization_request: "optimize_operating_parameters"
      multi_furnace: "coordinate_multi_furnace"
      refractory_assessment: "assess_refractory_condition"
      trend_analysis: "generate_efficiency_trends"

# ============================================================================
# SECTION 5: SUB-AGENTS
# ============================================================================

sub_agents:
  coordination_architecture:
    pattern: "peer_to_peer_with_orchestrator"
    communication: "event_driven_message_passing"
    consensus: "optimization_coordinator"

  upstream_coordination:
    - agent_id: "GL-001"
      name: "ProcessHeatOrchestrator"
      coordination_mode: "bidirectional"
      data_exchange:
        receives:
          - "plant_wide_optimization_directives"
          - "heat_demand_forecasts"
          - "fuel_allocation_constraints"
        sends:
          - "furnace_performance_metrics"
          - "capacity_availability"
          - "efficiency_improvements"
        frequency: "every 5-15 minutes"

  peer_coordination:
    - agent_id: "GL-002"
      name: "BoilerEfficiencyOptimizer"
      coordination_mode: "collaborative"
      data_exchange:
        receives:
          - "steam_generation_requirements"
          - "fuel_switching_opportunities"
        sends:
          - "furnace_fuel_consumption"
          - "heat_availability"
        frequency: "every 10 minutes"

    - agent_id: "GL-004"
      name: "WasteHeatRecovery"
      coordination_mode: "provider"
      data_exchange:
        sends:
          - "flue_gas_temperature"
          - "flue_gas_flow_rate"
          - "heat_recovery_potential_mw"
        frequency: "real-time (every 10-60 seconds)"

    - agent_id: "GL-005"
      name: "CogenerationOptimizer"
      coordination_mode: "collaborative"
      data_exchange:
        bidirectional:
          - "power_heat_optimization"
          - "fuel_cost_sharing"
        frequency: "every 15 minutes"

    - agent_id: "GL-006"
      name: "SteamSystemAnalyzer"
      coordination_mode: "collaborative"
      data_exchange:
        bidirectional:
          - "steam_demand_profiles"
          - "condensate_return_conditions"
        frequency: "every 10 minutes"

  message_protocol:
    format: "json"
    schema_version: "2.0"
    authentication: "jwt"
    encryption: "tls_1.3"
    qos: "at_least_once"
    retry_policy:
      max_retries: 3
      backoff: "exponential"

# ============================================================================
# SECTION 6: INPUTS
# ============================================================================

inputs:
  schema:
    type: "object"
    properties:
      operation_mode:
        type: "string"
        enum: ["monitor", "optimize", "predict", "coordinate", "analyze", "report"]
        description: "Primary operation mode"

      furnace_identification:
        type: "object"
        properties:
          furnace_id: {type: "string"}
          plant_id: {type: "string"}
          furnace_type: {type: "string"}
        required: ["furnace_id"]

      real_time_data:
        type: "object"
        properties:
          timestamp: {type: "string", format: "date-time"}
          temperatures: {type: "array", items: {type: "number"}}
          pressures: {type: "array", items: {type: "number"}}
          flows: {type: "array", items: {type: "number"}}
          emissions: {type: "object"}
          fuel_consumption: {type: "number"}
          production_rate: {type: "number"}

      configuration:
        type: "object"
        properties:
          monitoring_interval_seconds: {type: "integer", default: 60}
          optimization_frequency_minutes: {type: "integer", default: 15}
          alert_thresholds: {type: "object"}
          reporting_preferences: {type: "object"}

      optimization_parameters:
        type: "object"
        properties:
          objective: {type: "string", enum: ["efficiency", "cost", "emissions", "balanced"]}
          constraints: {type: "array"}
          time_horizon_hours: {type: "number"}

    required: ["operation_mode", "furnace_identification"]

  validation_rules:
    - rule: "timestamp_validation"
      check: "timestamp within 5 minutes of current time for real-time mode"
    - rule: "data_completeness"
      check: "minimum 90% sensor data availability"
    - rule: "data_quality"
      check: "sensor readings within physical limits"
    - rule: "safety_validation"
      check: "all inputs within safe operating envelope"

  data_sources:
    - source: "DCS/PLC"
      protocol: "OPC UA"
      update_rate_seconds: 1-10
      priority: "critical"
    - source: "CEMS"
      protocol: "Modbus TCP"
      update_rate_seconds: 1-60
      priority: "critical"
    - source: "Flow Meters"
      protocol: "4-20mA / HART"
      update_rate_seconds: 1
      priority: "high"
    - source: "Temperature Sensors"
      protocol: "Thermocouple / RTD"
      update_rate_seconds: 1-5
      priority: "high"

# ============================================================================
# SECTION 7: OUTPUTS
# ============================================================================

outputs:
  schema:
    type: "object"
    properties:
      furnace_status:
        type: "object"
        properties:
          furnace_id: {type: "string"}
          operational_status: {type: "string", enum: ["running", "startup", "shutdown", "standby", "fault"]}
          health_score: {type: "number", minimum: 0, maximum: 100}
          availability_percent: {type: "number"}

      performance_metrics:
        type: "object"
        properties:
          thermal_efficiency_percent: {type: "number"}
          specific_energy_consumption_gj_ton: {type: "number"}
          fuel_consumption_rate_kg_hr: {type: "number"}
          production_rate_ton_hr: {type: "number"}
          emissions_kg_co2_hr: {type: "number"}
          nox_emissions_ppm: {type: "number"}
          co_emissions_ppm: {type: "number"}

      kpi_dashboard:
        type: "object"
        properties:
          efficiency_kpis: {type: "object"}
          emissions_kpis: {type: "object"}
          production_kpis: {type: "object"}
          maintenance_kpis: {type: "object"}
          cost_kpis: {type: "object"}

      anomalies_alerts:
        type: "array"
        items:
          type: "object"
          properties:
            alert_id: {type: "string"}
            severity: {type: "string", enum: ["info", "warning", "critical"]}
            parameter: {type: "string"}
            message: {type: "string"}
            timestamp: {type: "string", format: "date-time"}
            recommended_action: {type: "string"}

      maintenance_predictions:
        type: "array"
        items:
          type: "object"
          properties:
            equipment_id: {type: "string"}
            predicted_failure_date: {type: "string", format: "date"}
            confidence_level: {type: "number"}
            recommended_action: {type: "string"}

      optimization_recommendations:
        type: "array"
        items:
          type: "object"
          properties:
            recommendation_id: {type: "string"}
            category: {type: "string"}
            description: {type: "string"}
            expected_benefit: {type: "object"}
            implementation_steps: {type: "array"}
            priority: {type: "string"}

      compliance_status:
        type: "object"
        properties:
          epa_cems_compliant: {type: "boolean"}
          iso_50001_compliant: {type: "boolean"}
          violations: {type: "array"}
          next_audit_date: {type: "string", format: "date"}

      provenance:
        type: "object"
        properties:
          calculation_hash: {type: "string"}
          data_sources: {type: "array"}
          tool_calls: {type: "array"}
          decision_trail: {type: "array"}
          timestamp: {type: "string", format: "date-time"}

  quality_guarantees:
    - "All calculations deterministic and reproducible (seed=42, temperature=0.0)"
    - "Complete audit trail with SHA-256 provenance hashes"
    - "Zero hallucinated values - all numeric outputs from physics-based tools"
    - "ASME PTC 4.1 compliant thermal efficiency calculations"
    - "±1.5% accuracy on efficiency measurements"

  output_formats:
    - format: "JSON"
      use_case: "API integration"
    - format: "CSV"
      use_case: "Data export for analysis"
    - format: "Dashboard"
      use_case: "Real-time operator visualization"
    - format: "PDF Report"
      use_case: "Management reporting"

# ============================================================================
# SECTION 8: TESTING
# ============================================================================

testing:
  test_coverage_target: 0.90  # 90% minimum (exceeds 85% standard)

  test_categories:
    - category: "unit_tests"
      description: "Test individual tool functions and calculations"
      count: 36  # 3 per tool (12 tools × 3)
      coverage_target: 0.95
      test_examples:
        - "test_thermal_efficiency_calculation_natural_gas"
        - "test_thermal_efficiency_calculation_hydrogen"
        - "test_fuel_consumption_analysis_baseline"
        - "test_anomaly_detection_temperature_spike"
        - "test_predictive_maintenance_refractory"

    - category: "integration_tests"
      description: "Test agent coordination and data flow"
      count: 12
      coverage_target: 0.85
      test_examples:
        - "test_dcs_integration_real_time_data"
        - "test_cems_integration_emissions"
        - "test_multi_furnace_coordination"
        - "test_orchestrator_coordination"

    - category: "determinism_tests"
      description: "Verify reproducible results with same inputs"
      count: 6
      coverage_target: 1.00
      test_examples:
        - "test_efficiency_calculation_determinism"
        - "test_optimization_reproducibility"

    - category: "performance_tests"
      description: "Verify latency and throughput requirements"
      count: 8
      coverage_target: 0.90
      test_examples:
        - "test_real_time_processing_latency"
        - "test_concurrent_furnace_monitoring"
        - "test_optimization_response_time"

    - category: "accuracy_tests"
      description: "Validate calculation accuracy against known results"
      count: 10
      coverage_target: 1.00
      test_examples:
        - "test_asme_ptc_41_compliance"
        - "test_efficiency_calculation_accuracy"
        - "test_emissions_calculation_accuracy"

    - category: "safety_tests"
      description: "Test safety interlocks and limit validation"
      count: 8
      coverage_target: 1.00
      test_examples:
        - "test_temperature_limit_validation"
        - "test_pressure_limit_validation"
        - "test_emergency_shutdown_response"

  performance_requirements:
    max_latency_ms:
      real_time_monitoring: 1000
      efficiency_calculation: 2000
      optimization: 3000  # Exceeds 5000ms standard
      dashboard_generation: 5000
      predictive_maintenance: 10000

    max_cost_usd:
      per_calculation: 0.02
      per_optimization: 0.08  # Exceeds 0.50 standard
      per_report: 0.05
      daily_operation: 5.00

    accuracy_targets:
      thermal_efficiency: 0.985  # 98.5% (exceeds 95% standard)
      fuel_consumption: 0.980    # 98.0%
      emissions_calculation: 0.990  # 99.0%
      anomaly_detection: 0.950   # 95% detection rate
      predictive_maintenance: 0.900  # 90% accuracy

    throughput:
      data_points_per_second: 2000
      concurrent_furnaces: 50
      calculations_per_minute: 1000

  test_data:
    synthetic_scenarios: 100
    historical_replays: 80
    edge_cases: 40
    failure_modes: 25

  continuous_testing:
    unit_tests: "on every commit"
    integration_tests: "nightly"
    performance_tests: "weekly"
    accuracy_validation: "monthly against reference data"

# ============================================================================
# SECTION 9: DEPLOYMENT
# ============================================================================

deployment:
  pack_id: "industrial/furnaces/performance_monitor"
  pack_version: "1.0.0"

  resource_requirements:
    memory_mb: 1024  # 1GB RAM
    cpu_cores: 2      # 1000m = 1 CPU core
    cpu_millicores: 1000
    gpu_required: false
    disk_space_gb: 20
    network_bandwidth_mbps: 50

  dependencies:
    python_packages:
      - "numpy>=1.24,<2.0"
      - "pandas>=2.0,<3.0"
      - "scipy>=1.10,<2.0"
      - "scikit-learn>=1.3,<2.0"  # For ML-based anomaly detection
      - "pydantic>=2.0,<3.0"
      - "sqlalchemy>=2.0,<3.0"
      - "asyncio>=3.4"
      - "aiohttp>=3.8"

    greenlang_modules:
      - "greenlang.agents.base>=2.0"
      - "greenlang.intelligence>=2.0"
      - "greenlang.tools.thermodynamics>=1.0"
      - "greenlang.tools.calculations>=1.0"
      - "greenlang.integrations.dcs>=1.0"
      - "greenlang.integrations.cems>=1.0"

    external_systems:
      - system: "DCS/PLC"
        protocol: "OPC UA"
        version: "1.04"
        authentication: "certificate"
      - system: "CEMS"
        protocol: "Modbus TCP"
        version: "1.1b3"
        authentication: "optional"
      - system: "CMMS"
        protocol: "REST API"
        version: "2.0"
        authentication: "api_key"
      - system: "ERP/MES"
        protocol: "REST API"
        version: "2.0"
        authentication: "oauth2"

  containerization:
    base_image: "python:3.11-slim"
    dockerfile_path: "./Dockerfile"
    build_args:
      - "PYTHON_VERSION=3.11"
      - "GREENLANG_VERSION=2.0.0"

  kubernetes_manifests:
    deployment:
      replicas: 2
      strategy: "RollingUpdate"
      max_surge: 1
      max_unavailable: 0

    service:
      type: "ClusterIP"
      port: 8080
      target_port: 8080

    config_map:
      name: "furnace-monitor-config"
      data:
        - "monitoring_interval: 60"
        - "optimization_frequency: 900"

    secrets:
      name: "furnace-monitor-secrets"
      keys:
        - "dcs_credentials"
        - "api_keys"

  environments:
    development:
      replicas: 1
      resources:
        cpu: "500m"
        memory: "512Mi"
      auto_scaling: false

    staging:
      replicas: 2
      resources:
        cpu: "1000m"
        memory: "1024Mi"
      auto_scaling: true
      min_replicas: 2
      max_replicas: 4

    production:
      replicas: 3
      resources:
        cpu: "1000m"
        memory: "1024Mi"
      auto_scaling: true
      min_replicas: 3
      max_replicas: 10
      cpu_threshold_percent: 70
      memory_threshold_percent: 80

  monitoring:
    health_check:
      liveness_probe:
        http_get:
          path: "/health"
          port: 8080
        initial_delay_seconds: 30
        period_seconds: 10
      readiness_probe:
        http_get:
          path: "/ready"
          port: 8080
        initial_delay_seconds: 10
        period_seconds: 5

    metrics:
      prometheus:
        enabled: true
        port: 9090
        path: "/metrics"

    logging:
      level: "INFO"
      format: "json"
      destination: "stdout"

# ============================================================================
# SECTION 10: DOCUMENTATION
# ============================================================================

documentation:
  readme_sections:
    - "Overview and Purpose"
    - "Quick Start Guide (5-minute setup)"
    - "Architecture and Design"
    - "Tool Specifications (12 tools detailed)"
    - "Integration Guides (DCS, CEMS, CMMS)"
    - "API Reference (OpenAPI 3.0)"
    - "Configuration Guide"
    - "Performance Tuning"
    - "Troubleshooting"
    - "Best Practices"
    - "Case Studies and ROI"

  api_documentation:
    format: "OpenAPI 3.0"
    location: "/docs/api/furnace-monitor"
    interactive: true
    authentication: "required"

  user_guides:
    - title: "Operator Quick Reference"
      audience: "Plant operators"
      format: "PDF, 2 pages"
      topics: ["Dashboard overview", "Alert response", "Parameter adjustment"]

    - title: "Engineer Configuration Guide"
      audience: "Process engineers"
      format: "PDF, 20 pages"
      topics: ["Setup", "Calibration", "Optimization tuning", "Troubleshooting"]

    - title: "Manager Performance Report"
      audience: "Plant managers"
      format: "PDF, Executive summary"
      topics: ["KPI dashboard", "Cost savings", "Improvement opportunities"]

  example_use_cases:
    - title: "Real-time Efficiency Monitoring"
      description: "Monitor 5 furnaces in real-time, detect 3% efficiency drop"
      input_example:
        operation_mode: "monitor"
        furnace_identification: {furnace_id: "FURNACE_001"}
      output_example:
        thermal_efficiency_percent: 72.3
        deviation_from_baseline_percent: -3.1
        alert: "Efficiency degradation detected"
      business_impact: "Early detection saved $15k/month in fuel costs"

    - title: "Predictive Maintenance for Refractory"
      description: "Predict refractory replacement 6 months in advance"
      input_example:
        operation_mode: "predict"
        equipment_id: "REFRACTORY_ZONE_A"
      output_example:
        remaining_life_days: 180
        recommended_replacement_date: "2026-05-15"
      business_impact: "Scheduled shutdown avoided $200k unplanned downtime"

    - title: "Multi-Furnace Fleet Optimization"
      description: "Optimize load across 8 furnaces for minimum energy cost"
      input_example:
        operation_mode: "coordinate"
        furnace_fleet: ["F001", "F002", "F003", "F004", "F005", "F006", "F007", "F008"]
        optimization_objective: "minimize_cost"
      output_example:
        total_cost_reduction_percent: 8.5
        annual_savings_usd: 420000
      business_impact: "8.5% energy cost reduction = $420k/year savings"

    - title: "Combustion Optimization"
      description: "Optimize air-fuel ratio for natural gas furnace"
      input_example:
        operation_mode: "optimize"
        current_excess_air_percent: 25
      output_example:
        optimal_excess_air_percent: 10
        efficiency_improvement_percent: 2.5
      business_impact: "2.5% efficiency gain = $75k/year fuel savings"

    - title: "Regulatory Compliance Reporting"
      description: "Automated EPA CEMS compliance reporting"
      input_example:
        operation_mode: "report"
        report_type: "emissions_compliance"
        time_period: "monthly"
      output_example:
        compliance_status: "compliant"
        nox_emissions_tons: 12.5
        regulatory_limit_tons: 15.0
      business_impact: "Zero violations, automated reporting saves 20 hours/month"

  troubleshooting_guides:
    - "DCS/PLC Integration Issues"
    - "CEMS Data Quality Problems"
    - "Efficiency Calculation Discrepancies"
    - "Performance Degradation Root Cause"
    - "Sensor Calibration Procedures"

  training_materials:
    - "Video: 15-minute product overview"
    - "Interactive tutorial: Setup and configuration"
    - "Webinar: Advanced optimization techniques"
    - "Certification program: Furnace optimization expert"

# ============================================================================
# SECTION 11: COMPLIANCE
# ============================================================================

compliance:
  zero_secrets: true  # No hardcoded credentials, API keys, or passwords

  sbom:
    format: "SPDX 2.3"
    location: "/sbom/furnace-monitor-sbom.json"
    components:
      - "Python 3.11"
      - "NumPy 1.24"
      - "Pandas 2.0"
      - "SciPy 1.10"
      - "Scikit-learn 1.3"
      - "GreenLang Core 2.0"
    license: "Proprietary"

  standards_compliance:
    - standard: "ASME PTC 4.1"
      description: "Test Uncertainty - Power Plant Performance"
      compliance_level: "Full compliance"
      verification: "Third-party audit Q4 2025"

    - standard: "ISO 50001:2018"
      description: "Energy Management Systems"
      compliance_level: "Full compliance"
      verification: "Certification ready"

    - standard: "EPA CEMS"
      description: "Continuous Emissions Monitoring Systems"
      compliance_level: "40 CFR Part 60 compliant"
      verification: "Automated compliance reporting"

    - standard: "NFPA 86"
      description: "Standard for Ovens and Furnaces"
      compliance_level: "Safety requirements met"
      verification: "Safety review completed"

    - standard: "ISO 13579"
      description: "Industrial Furnaces - Terminology"
      compliance_level: "Terminology alignment"
      verification: "Documentation review"

    - standard: "API Standard 560"
      description: "Fired Heaters for General Refinery Service"
      compliance_level: "Design criteria alignment"
      verification: "Engineering review"

  security_compliance:
    security_grade: "A+"

    authentication:
      methods: ["OAuth 2.0", "JWT", "API Key", "Certificate-based"]
      password_policy: "not_applicable"  # No password authentication
      mfa_required: true

    authorization:
      model: "RBAC"
      roles:
        - "operator": ["read", "acknowledge_alerts"]
        - "engineer": ["read", "write", "optimize"]
        - "manager": ["read", "reports"]
        - "admin": ["all"]

    encryption:
      at_rest: "AES-256-GCM"
      in_transit: "TLS 1.3"
      key_management: "HashiCorp Vault"

    vulnerability_management:
      scanning_frequency: "weekly"
      remediation_sla:
        critical: "24 hours"
        high: "7 days"
        medium: "30 days"

    audit_logging:
      enabled: true
      retention_days: 365
      log_types:
        - "authentication_events"
        - "authorization_events"
        - "data_access"
        - "configuration_changes"
        - "optimization_actions"
      tamper_protection: "blockchain_hash_chain"

  data_governance:
    data_classification: "Confidential"
    data_residency: "customer_specified"
    data_retention:
      operational_data: "90 days"
      performance_history: "7 years"
      compliance_data: "7 years"
      audit_logs: "7 years"

    backup_strategy:
      frequency: "hourly incremental, daily full"
      retention: "30 daily, 12 monthly"
      encryption: "AES-256"
      testing: "monthly restore test"

    disaster_recovery:
      rpo: "1 hour"  # Recovery Point Objective
      rto: "4 hours"  # Recovery Time Objective
      geo_redundancy: true
      failover: "automatic"

    privacy_compliance:
      gdpr_compliant: true
      ccpa_compliant: true
      data_anonymization: "on export"
      right_to_erasure: "supported"

  regulatory_reporting:
    - report: "EPA GHG Inventory"
      frequency: "Annual"
      format: "e-GGRT XML"
      automation: "fully automated"

    - report: "EU ETS Emissions"
      frequency: "Annual"
      format: "EU Registry format"
      automation: "fully automated"

    - report: "ISO 50001 EnPIs"
      frequency: "Monthly"
      format: "ISO 50006 compliant"
      automation: "fully automated"

    - report: "OSHA PSM Process Safety"
      frequency: "As required"
      format: "PDF report"
      automation: "semi-automated"

# ============================================================================
# SECTION 12: METADATA
# ============================================================================

metadata:
  specification_version: "2.0.0"
  created_date: "2025-11-19"
  last_modified: "2025-11-19"

  authors:
    - "GreenLang Product Management"
    - "Furnace Performance Domain Experts"
    - "Industrial Process Engineers"

  review_status: "Approved"
  reviewed_by:
    - name: "Head of Product"
      date: "2025-11-19"
      approval: "approved"
    - name: "Chief Architect"
      date: "2025-11-19"
      approval: "approved"
    - name: "Domain Expert - Industrial Furnaces"
      date: "2025-11-19"
      approval: "approved"

  change_log:
    - version: "1.0.0"
      date: "2025-11-19"
      changes:
        - "Initial specification for GL-007 FurnacePerformanceMonitor"
        - "12 deterministic tools defined with complete schemas"
        - "ASME PTC 4.1 compliant efficiency calculations"
        - "Predictive maintenance with physics + ML hybrid models"
        - "Multi-furnace coordination capabilities"
        - "Comprehensive testing strategy (90% coverage target)"
        - "Production-ready deployment configuration"
      author: "Product Management Team"

  version_control:
    repository: "https://github.com/greenlang/agent-specs"
    branch: "main"
    commit_hash: "to_be_generated"

  tags:
    - "furnaces"
    - "performance-monitoring"
    - "efficiency-optimization"
    - "predictive-maintenance"
    - "industrial"
    - "energy-management"
    - "emissions-compliance"
    - "multi-furnace-coordination"

  related_documents:
    - "GL_agent_requirement.md"
    - "Furnace_Performance_Domain_Architecture.md"
    - "ASME_PTC_4.1_Implementation_Guide.md"
    - "Predictive_Maintenance_Models.md"
    - "Zero_Hallucination_Design.md"
    - "Agent_001_ProcessHeatOrchestrator.yaml"
    - "Agent_002_BoilerEfficiencyOptimizer.yaml"

  support:
    team: "Industrial Furnaces & Performance"
    email: "furnace-performance@greenlang.ai"
    slack: "#gl-furnace-monitor"
    documentation: "https://docs.greenlang.ai/agents/GL-007"
    status_page: "https://status.greenlang.ai"

  roadmap:
    q1_2026: "Production deployment, 10 pilot installations"
    q2_2026: "Advanced ML models, 50 installations"
    q3_2026: "Hydrogen fuel support, digital twin integration"
    q4_2026: "100+ installations, full fleet management"

  kpis:
    technical:
      - "90% test coverage achieved"
      - "±1.5% efficiency accuracy"
      - "<3 second optimization latency"
      - "99.9% uptime"
      - "0 ERRORS in validation"

    business:
      - "15-30% energy cost savings"
      - "10-20% efficiency improvement"
      - "8-18 month payback"
      - "$9B TAM, 12% capture target"
      - "0.5 Gt CO2e reduction potential"

# ============================================================================
# END OF SPECIFICATION - GL-007 FurnacePerformanceMonitor
# ============================================================================
